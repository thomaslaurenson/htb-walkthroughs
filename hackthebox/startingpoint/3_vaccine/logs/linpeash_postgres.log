

                     ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄▄
      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄
  ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄
  ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
  ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
  ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
  ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
  ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
  ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
  ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
  ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
  ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
  ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
  ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
   ▄▄▄▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄
        ▄▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄ 
             ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
    linpeas v3.2.6 by carlospolop
                                                                                                                    
ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission.                                                                    
                                                                                                                    
Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEGEND:                                                                                                            
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting linpeas. Caching Writable Folders...

════════════════════════════════════╣ Basic information ╠════════════════════════════════════
OS: Linux version 5.3.0-29-generic (buildd@lcy01-amd64-024) (gcc version 9.2.1 20191008 (Ubuntu 9.2.1-9ubuntu2)) #31-Ubuntu SMP Fri Jan 17 17:27:26 UTC 2020
User & Groups: uid=111(postgres) gid=117(postgres) groups=117(postgres),116(ssl-cert)
Hostname: vaccine
Writable folder: /dev/shm
[+] /usr/bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /usr/bin/nc is available for network discover & port scanning (linpeas can discover hosts and scan ports, learn more with -h)                                                                                                       
                                                                                                                    

Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE
                                                                                                                    
════════════════════════════════════╣ System Information ╠════════════════════════════════════
╔══════════╣ Operative system                                                                                       
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits                                       
Linux version 5.3.0-29-generic (buildd@lcy01-amd64-024) (gcc version 9.2.1 20191008 (Ubuntu 9.2.1-9ubuntu2)) #31-Ubuntu SMP Fri Jan 17 17:27:26 UTC 2020
Distributor ID: Ubuntu
Description:    Ubuntu 19.10
Release:        19.10
Codename:       eoan

╔══════════╣ Sudo version
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                          
Sudo version 1.8.27                                                                                                 

╔══════════╣ USBCreator
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation                                                                                                              
                                                                                                                    
╔══════════╣ PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses                                  
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin                  
New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin

╔══════════╣ Date
Fri 09 Jul 2021 11:30:54 PM UTC                                                                                     

╔══════════╣ System stats
Filesystem      Size  Used Avail Use% Mounted on                                                                    
udev            939M     0  939M   0% /dev
tmpfs           196M  1.2M  195M   1% /run
/dev/sda2        20G  6.3G   13G  34% /
tmpfs           980M  8.0K  980M   1% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           980M     0  980M   0% /sys/fs/cgroup
/dev/loop0       90M   90M     0 100% /snap/core/7917
/dev/loop1       39M   39M     0 100% /snap/postgresql10/47
/dev/loop2       55M   55M     0 100% /snap/lxd/12211
tmpfs           196M     0  196M   0% /run/user/111
              total        used        free      shared  buff/cache   available
Mem:        2005948      270632     1230936       15376      504380     1526388
Swap:       4194300           0     4194300

╔══════════╣ CPU info
Architecture:                    x86_64                                                                             
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   43 bits physical, 48 bits virtual
CPU(s):                          4
On-line CPU(s) list:             0-3
Thread(s) per core:              1
Core(s) per socket:              1
Socket(s):                       4
NUMA node(s):                    1
Vendor ID:                       AuthenticAMD
CPU family:                      23
Model:                           1
Model name:                      AMD EPYC 7401P 24-Core Processor
Stepping:                        2
CPU MHz:                         2000.000
BogoMIPS:                        4000.00
Hypervisor vendor:               VMware
Virtualization type:             full
L1d cache:                       128 KiB
L1i cache:                       256 KiB
L2 cache:                        2 MiB
L3 cache:                        256 MiB
NUMA node0 CPU(s):               0-3
Vulnerability Itlb multihit:     Not affected
Vulnerability L1tf:              Not affected
Vulnerability Mds:               Not affected
Vulnerability Meltdown:          Not affected
Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp
Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:        Mitigation; Full AMD retpoline, IBPB conditional, STIBP disabled, RSB filling
Vulnerability Tsx async abort:   Not affected
Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx
                                  fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good n
                                 opl tsc_reliable nonstop_tsc cpuid extd_apicid pni pclmulqdq ssse3 fma cx16 sse4_1 
                                 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm extapic cr8
                                 _legacy abm sse4a misalignsse 3dnowprefetch osvw ssbd ibpb vmmcall fsgsbase bmi1 av
                                 x2 smep bmi2 rdseed adx smap clflushopt sha_ni xsaveopt xsavec xsaves clzero arat o
                                 verflow_recov succor

╔══════════╣ Environment
╚ Any private information inside environment variables?                                                             
SHELL=/bin/bash                                                                                                     
HISTSIZE=0
PWD=/var/lib/postgresql
LOGNAME=postgres
XDG_SESSION_TYPE=tty
HOME=/var/lib/postgresql
LANG=en_US.UTF-8
HISTFILE=/dev/null
SSH_CONNECTION=10.10.14.29 54000 10.10.10.46 22
XDG_SESSION_CLASS=user
TERM=xterm-256color
USER=postgres
SHLVL=2
XDG_SESSION_ID=34
XDG_RUNTIME_DIR=/run/user/111
SSH_CLIENT=10.10.14.29 54000 22
XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
HISTFILESIZE=0
DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/111/bus
SSH_TTY=/dev/pts/0
_=/usr/bin/env

╔══════════╣ Searching Signature verification failed in dmseg
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed                   
                                                                                                                    
╔══════════╣ Linux Protections
═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.                       
apparmor module is loaded.
═╣ grsecurity present? ............ ═╣ PaX bins present? .............. ═╣ Execshield enabled? ............ ═╣ SELinux enabled? ............... ═╣ Is ASLR enabled? ............... Yes                                                 
═╣ Printer? ....................... ═╣ Is this a virtual machine? ..... Yes (vmware)

════════════════════════════════════╣ Containers ╠════════════════════════════════════
╔══════════╣ Container related tools present                                                                        
/snap/bin/lxc                                                                                                       
╔══════════╣ Container details
═╣ Is this a container? ........... No                                                                              
═╣ Any running containers? ........ No                                                                              
                                                                                                                    
════════════════════════════════════╣ Devices ╠════════════════════════════════════
╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)                                                                 
disk                                                                                                                
sda
sda1
sda2

╔══════════╣ Unmounted file-system?
╚ Check if you can mount umounted devices                                                                           
UUID=5659d3e2-398b-4d2e-b81f-2c3d49d61062 / ext4 defaults 0 0                                                       
/swap.img       none    swap    sw      0       0


════════════════════════════════════╣ Available Software ╠════════════════════════════════════
╔══════════╣ Useful software                                                                                        
/snap/bin/lxc                                                                                                       
/usr/bin/nc
/usr/bin/netcat
/usr/bin/wget
/usr/bin/curl
/usr/bin/ping
/usr/bin/base64
/usr/bin/python3
/usr/bin/python3.7
/usr/bin/perl
/usr/bin/php
/usr/bin/sudo

╔══════════╣ Installed Compiler
                                                                                                                    

════════════════════════════════════╣ Processes, Cron, Services, Timers & Sockets ╠════════════════════════════════════                                                                                                                 
╔══════════╣ Cleaned processes                                                                                      
╚ Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                                                                                                  
root          1  0.0  0.5 166920 10724 ?        Ss   22:54   0:02 /sbin/init auto automatic-ubiquity noprompt       
root        460  0.0  0.8  51216 17124 ?        S<s  22:54   0:00 /lib/systemd/systemd-journald
root        488  0.0  0.2  20408  4872 ?        Ss   22:54   0:00 /lib/systemd/systemd-udevd
root        644  0.0  0.8 279960 17628 ?        SLsl 22:54   0:00 /sbin/multipathd -d -s
systemd+    677  0.0  0.3  89952  6284 ?        Ssl  22:54   0:01 /lib/systemd/systemd-timesyncd
  └─(Caps) 0x0000000002000000=cap_sys_time
root        678  0.0  0.5  43604 10064 ?        Ss   22:54   0:00 /usr/bin/VGAuthService
root        729  0.0  0.5 122220 11120 ?        Ssl  22:54   0:01 /usr/bin/vmtoolsd
systemd+    780  0.0  0.3  17860  7564 ?        Ss   22:54   0:00 /lib/systemd/systemd-networkd
  └─(Caps) 0x0000000000003c00=cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw
systemd+    841  0.0  0.4  20668  8476 ?        Ss   22:54   0:01 /lib/systemd/systemd-resolved
root        855  0.0  0.1  81920  3872 ?        Ssl  22:55   0:00 /usr/sbin/irqbalance --foreground
root        874  0.0  0.8  28252 17820 ?        Ss   22:55   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
root        893  0.0  0.1   6756  2988 ?        Ss   22:55   0:00 /usr/sbin/cron -f
message+    915  0.0  0.2   7484  4680 ?        Ss   22:55   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
  └─(Caps) 0x0000000020000000=cap_audit_write
root        918  0.0  0.4 239200  9132 ?        Ssl  22:55   0:00 /usr/lib/accountsservice/accounts-daemon[0m
syslog      919  0.0  0.2 224360  5188 ?        Ssl  22:55   0:00 /usr/sbin/rsyslogd -n -iNONE
root        921  0.0  0.3  16356  7380 ?        Ss   22:55   0:01 /lib/systemd/systemd-logind
root        923  0.1  1.3 1140952 26560 ?       Ssl  22:55   0:02 /usr/lib/snapd/snapd
daemon[0m      926  0.0  0.1   3736  2276 ?        Ss   22:55   0:00 /usr/sbin/atd -f
root        928  0.0  0.1   6784  3008 ?        Ss   22:55   0:00 /usr/sbin/vsftpd /etc/vsftpd.conf
root        929  0.0  0.3  12028  6944 ?        Ss   22:55   0:00 /usr/sbin/sshd -D
postgres   2010  0.0  0.2  13216  5656 ?        S    23:22   0:00      _ sshd: postgres@pts/0
postgres   2018  0.0  0.2   8268  5268 pts/0    Ss   23:22   0:00          _ -bash
postgres   2241  0.7  0.2   7964  4692 pts/0    S+   23:30   0:00              _ bash linpeas.sh
postgres   3296  0.0  0.1   7964  2760 pts/0    S+   23:30   0:00                  _ bash linpeas.sh
postgres   3299  0.0  0.1   9000  3392 pts/0    R+   23:30   0:00                  |   _ ps fauxwww
postgres   3300  0.0  0.0   7964  1488 pts/0    S+   23:30   0:00                  _ bash linpeas.sh
root        981  0.0  0.4 236340  8912 ?        Ssl  22:55   0:00 /usr/lib/policykit-1/polkitd --no-debug
root       1006  0.0  0.0   5820  1788 tty1     Ss+  22:55   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux
root       1059  0.0  1.0 107712 20872 ?        Ssl  22:55   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
postgres   1909  0.0  0.4  18156  9240 ?        Ss   23:22   0:00 /lib/systemd/systemd --user
postgres   1915  0.0  0.1 168276  2992 ?        S    23:22   0:00  _ (sd-pam)
root       2200  0.0  1.0 203980 22044 ?        Ss   23:30   0:00 /usr/sbin/apache2 -k start
www-data   2204  0.0  0.4 204316  9824 ?        S    23:30   0:00  _ /usr/sbin/apache2 -k start
www-data   2205  0.0  0.4 204316  9824 ?        S    23:30   0:00  _ /usr/sbin/apache2 -k start
www-data   2206  0.0  0.4 204316  9824 ?        S    23:30   0:00  _ /usr/sbin/apache2 -k start
www-data   2207  0.0  0.4 204316  9824 ?        S    23:30   0:00  _ /usr/sbin/apache2 -k start
www-data   2208  0.0  0.4 204316  9824 ?        S    23:30   0:00  _ /usr/sbin/apache2 -k start
postgres   2215  0.0  1.4 213828 28896 ?        S    23:30   0:00 /usr/lib/postgresql/11/bin/postgres -D /var/lib/postgresql/11/main -c config_file=/etc/postgresql/11/main/postgresql.conf                                             
postgres   2217  0.0  0.2 213828  4268 ?        Ss   23:30   0:00  _ postgres: 11/main: checkpointer
postgres   2218  0.0  0.3 213972  6092 ?        Ss   23:30   0:00  _ postgres: 11/main: background writer
postgres   2219  0.0  0.5 213828 10100 ?        Ss   23:30   0:00  _ postgres: 11/main: walwriter
postgres   2220  0.0  0.3 214400  6844 ?        Ss   23:30   0:00  _ postgres: 11/main: autovacuum launcher
postgres   2221  0.0  0.2  68884  5424 ?        Ss   23:30   0:00  _ postgres: 11/main: stats collector
postgres   2222  0.0  0.3 214256  6864 ?        Ss   23:30   0:00  _ postgres: 11/main: logical replication launcher

╔══════════╣ Binary processes permissions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                             
1.5M -rwxr-xr-x 1 root root 1.5M Oct 11  2019 /lib/systemd/systemd                                                  
144K -rwxr-xr-x 1 root root 143K Oct 11  2019 /lib/systemd/systemd-journald
244K -rwxr-xr-x 1 root root 243K Oct 11  2019 /lib/systemd/systemd-logind
1.8M -rwxr-xr-x 1 root root 1.8M Oct 11  2019 /lib/systemd/systemd-networkd
392K -rwxr-xr-x 1 root root 391K Oct 11  2019 /lib/systemd/systemd-resolved
 56K -rwxr-xr-x 1 root root  55K Oct 11  2019 /lib/systemd/systemd-timesyncd
664K -rwxr-xr-x 1 root root 663K Oct 11  2019 /lib/systemd/systemd-udevd
 68K -rwxr-xr-x 1 root root  68K Aug 21  2019 /sbin/agetty
   0 lrwxrwxrwx 1 root root   20 Oct 11  2019 /sbin/init -> /lib/systemd/systemd
120K -rwxr-xr-x 1 root root 119K Oct  9  2019 /sbin/multipathd
236K -rwxr-xr-x 1 root root 236K Jun 11  2019 /usr/bin/dbus-daemon[0m
   0 lrwxrwxrwx 1 root root    9 Oct  2  2019 /usr/bin/python3 -> python3.7
132K -rwxr-xr-x 1 root root 131K Oct  9  2019 /usr/bin/VGAuthService
 56K -rwxr-xr-x 1 root root  55K Oct  9  2019 /usr/bin/vmtoolsd
200K -rwxr-xr-x 1 root root 199K Sep 15  2019 /usr/lib/accountsservice/accounts-daemon[0m
120K -rwxr-xr-x 1 root root 119K Aug 16  2019 /usr/lib/policykit-1/polkitd
7.5M -rwxr-xr-x 1 root root 7.5M Aug  7  2019 /usr/lib/postgresql/11/bin/postgres
 21M -rwxr-xr-x 1 root root  23M Aug 30  2019 /usr/lib/snapd/snapd
692K -rwxr-xr-x 1 root root 689K Aug 14  2019 /usr/sbin/apache2
 32K -rwxr-xr-x 1 root root  31K Nov 12  2018 /usr/sbin/atd
 56K -rwxr-xr-x 1 root root  55K Jul 19  2019 /usr/sbin/cron
 68K -rwxr-xr-x 1 root root  67K Aug 16  2019 /usr/sbin/irqbalance
700K -rwxr-xr-x 1 root root 698K Sep  5  2019 /usr/sbin/rsyslogd
824K -rwxr-xr-x 1 root root 824K Sep 12  2019 /usr/sbin/sshd
172K -rwxr-xr-x 1 root root 169K Mar  6  2019 /usr/sbin/vsftpd

╔══════════╣ Files opened by processes belonging to other users
╚ This is usually empty because of the lack of privileges to read other user processes information                  
COMMAND    PID  TID TASKCMD               USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME           

╔══════════╣ Processes with credentials in memory (root req)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory                       
vsftpd process found (dump creds from memory as root)                                                               
apache2 process found (dump creds from memory as root)
sshd: process found (dump creds from memory as root)

╔══════════╣ Cron jobs
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs                                   
/usr/bin/crontab                                                                                                    
-rw-r--r-- 1 root root    1042 Jul 19  2019 /etc/crontab

/etc/cron.d:
total 28
drwxr-xr-x  2 root root 4096 Feb  3  2020 .
drwxr-xr-x 97 root root 4096 Jul  2  2020 ..
-rw-r--r--  1 root root  201 Sep 30  2019 e2scrub_all
-rw-r--r--  1 root root  712 Dec 17  2018 php
-rw-r--r--  1 root root  102 Jul 19  2019 .placeholder
-rw-r--r--  1 root root  190 Oct 17  2019 popularity-contest
-rw-r--r--  1 root root  396 Aug 18  2019 sysstat

/etc/cron.daily:
total 60
drwxr-xr-x  2 root root 4096 Feb  3  2020 .
drwxr-xr-x 97 root root 4096 Jul  2  2020 ..
-rwxr-xr-x  1 root root  539 Aug 14  2019 apache2
-rwxr-xr-x  1 root root  376 May 16  2019 apport
-rwxr-xr-x  1 root root 1478 Sep 19  2019 apt-compat
-rwxr-xr-x  1 root root  355 Dec 29  2017 bsdmainutils
-rwxr-xr-x  1 root root 1187 Sep  5  2019 dpkg
-rwxr-xr-x  1 root root  377 Jan 21  2019 logrotate
-rwxr-xr-x  1 root root 1123 Aug 27  2019 man-db
-rwxr-xr-x  1 root root  249 Jul 27  2018 passwd
-rw-r--r--  1 root root  102 Jul 19  2019 .placeholder
-rwxr-xr-x  1 root root 4574 Aug 13  2018 popularity-contest
-rwxr-xr-x  1 root root  441 Aug 18  2019 sysstat
-rwxr-xr-x  1 root root  214 Aug 10  2018 update-notifier-common

/etc/cron.hourly:
total 12
drwxr-xr-x  2 root root 4096 Oct 17  2019 .
drwxr-xr-x 97 root root 4096 Jul  2  2020 ..
-rw-r--r--  1 root root  102 Jul 19  2019 .placeholder

/etc/cron.monthly:
total 12
drwxr-xr-x  2 root root 4096 Oct 17  2019 .
drwxr-xr-x 97 root root 4096 Jul  2  2020 ..
-rw-r--r--  1 root root  102 Jul 19  2019 .placeholder

/etc/cron.weekly:
total 20
drwxr-xr-x  2 root root 4096 Oct 17  2019 .
drwxr-xr-x 97 root root 4096 Jul  2  2020 ..
-rwxr-xr-x  1 root root  813 Aug 27  2019 man-db
-rw-r--r--  1 root root  102 Jul 19  2019 .placeholder
-rwxr-xr-x  1 root root  211 Aug 10  2018 update-notifier-common

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin


╔══════════╣ Services
╚ Search for outdated versions                                                                                      
 [ - ]  apache-htcacheclean                                                                                         
 [ + ]  apache2
 [ + ]  apparmor
 [ + ]  apport
 [ + ]  atd
 [ - ]  console-setup.sh
 [ + ]  cron
 [ - ]  cryptdisks
 [ - ]  cryptdisks-early
 [ + ]  dbus
 [ + ]  grub-common
 [ - ]  hwclock.sh
 [ + ]  irqbalance
 [ - ]  iscsid
 [ - ]  keyboard-setup.sh
 [ + ]  kmod
 [ - ]  lvm2
 [ - ]  lvm2-lvmpolld
 [ + ]  multipath-tools
 [ + ]  networking
 [ - ]  open-iscsi
 [ + ]  open-vm-tools
 [ - ]  plymouth
 [ - ]  plymouth-log
 [ + ]  postgresql
 [ + ]  procps
 [ - ]  rsync
 [ + ]  rsyslog
 [ - ]  screen-cleanup
 [ + ]  ssh
 [ + ]  sysstat
 [ + ]  udev
 [ + ]  ufw
 [ + ]  unattended-upgrades
 [ - ]  uuidd
 [ + ]  vsftpd

╔══════════╣ Systemd PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths                           
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin                                         

╔══════════╣ Analyzing .service files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#services                                              
/etc/systemd/system/multi-user.target.wants/atd.service is executing some relative path                             
You can't write on systemd PATH

╔══════════╣ System timers
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                
NEXT                         LEFT          LAST                         PASSED               UNIT                         ACTIVATES
Fri 2021-07-09 23:39:00 UTC  8min left     Fri 2021-07-09 23:09:01 UTC  21min ago            phpsessionclean.timer        phpsessionclean.service
Fri 2021-07-09 23:41:20 UTC  10min left    Mon 2020-06-29 09:57:26 UTC  1 years 0 months ago apt-daily-upgrade.timer      apt-daily-upgrade.service
Sat 2021-07-10 00:00:00 UTC  29min left    Fri 2021-07-09 22:55:01 UTC  35min ago            logrotate.timer              logrotate.service
Sat 2021-07-10 00:00:00 UTC  29min left    Fri 2021-07-09 22:55:01 UTC  35min ago            man-db.timer                 man-db.service
Sat 2021-07-10 03:36:56 UTC  4h 5min left  Mon 2020-02-03 10:40:23 UTC  1 years 5 months ago apt-daily.timer              apt-daily.service
Sat 2021-07-10 04:21:55 UTC  4h 50min left Tue 2020-02-25 13:45:00 UTC  1 years 4 months ago motd-news.timer              motd-news.service
Sat 2021-07-10 23:10:01 UTC  23h left      Fri 2021-07-09 23:10:01 UTC  20min ago            systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service                                                                                
Sun 2021-07-11 03:10:36 UTC  1 day 3h left Fri 2021-07-09 22:55:29 UTC  35min ago            e2scrub_all.timer            e2scrub_all.service
Mon 2021-07-12 00:00:00 UTC  2 days left   Fri 2021-07-09 22:55:01 UTC  35min ago            fstrim.timer                 fstrim.service
n/a                          n/a           n/a                          n/a                  snapd.snap-repair.timer      snapd.snap-repair.service

╔══════════╣ Analyzing .timer files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                
                                                                                                                    
╔══════════╣ Analyzing .socket files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                               
                                                                                                                    
╔══════════╣ HTTP sockets
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                               
Socket /run/user/111/snapd-session-agent.socket owned by postgres uses HTTP. Response to /index:                    
{"type":"error","result":{"message":"method \"GET\" not allowed"}}
Socket /run/snapd.socket owned by root uses HTTP. Response to /index:
{"type":"sync","status-code":200,"status":"OK","result":["TBD"]}
Socket /run/snapd-snap.socket owned by root uses HTTP. Response to /index:
{"type":"error","status-code":401,"status":"Unauthorized","result":{"message":"access denied","kind":"login-required"}}

╔══════════╣ D-Bus config files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                 
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf (        <policy group="power">)

╔══════════╣ D-Bus Service Objects list
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                 
NAME                                 PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION
:1.0                                 780 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -
:1.102                              1909 systemd         postgres         :1.102        user@111.service          -          -
:1.17                                981 polkitd         root             :1.17         polkit.service            -          -
:1.23                                921 systemd-logind  root             :1.23         systemd-logind.service    -          -
:1.24                               1059 unattended-upgr root             :1.24         unattended-upgrades.serv… -          -
:1.260                              6770 busctl          postgres         :1.260        session-34.scope          34         -
:1.3                                 677 systemd-timesyn systemd-timesync :1.3          systemd-timesyncd.service -          -
:1.4                                 841 systemd-resolve systemd-resolve  :1.4          systemd-resolved.service  -          -
:1.6                                 918 accounts-daemon root             :1.6          accounts-daemon.service   -          -
:1.7                                   1 systemd         root             :1.7          init.scope                -          -
:1.9                                 874 networkd-dispat root             :1.9          networkd-dispatcher.serv… -          -
com.ubuntu.LanguageSelector            - -               -                (activatable) -                         -
com.ubuntu.SoftwareProperties          - -               -                (activatable) -                         -
org.freedesktop.Accounts             918 accounts-daemon root             :1.6          accounts-daemon.service   -          -
org.freedesktop.DBus                   1 systemd         root             -             init.scope                -          -
org.freedesktop.PackageKit             - -               -                (activatable) -                         -
org.freedesktop.PolicyKit1           981 polkitd         root             :1.17         polkit.service            -          -
org.freedesktop.bolt                   - -               -                (activatable) -                         -
org.freedesktop.fwupd                  - -               -                (activatable) -                         -
org.freedesktop.hostname1              - -               -                (activatable) -                         -
org.freedesktop.locale1                - -               -                (activatable) -                         -
org.freedesktop.login1               921 systemd-logind  root             :1.23         systemd-logind.service    -          -
org.freedesktop.network1             780 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -
org.freedesktop.resolve1             841 systemd-resolve systemd-resolve  :1.4          systemd-resolved.service  -          -
org.freedesktop.systemd1               1 systemd         root             :1.7          init.scope                -          -
org.freedesktop.thermald               - -               -                (activatable) -                         -
org.freedesktop.timedate1              - -               -                (activatable) -                         -
org.freedesktop.timesync1            677 systemd-timesyn systemd-timesync :1.3          systemd-timesyncd.service -          -


════════════════════════════════════╣ Network Information ╠════════════════════════════════════
╔══════════╣ Hostname, hosts and DNS                                                                                
vaccine                                                                                                             
127.0.0.1 localhost
127.0.1.1 vaccine

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

nameserver 127.0.0.53
options edns0

╔══════════╣ Content of /etc/inetd.conf & /etc/xinetd.conf
                                                                                                                    
╔══════════╣ Interfaces
# symbolic names for networks, see networks(5) for more information                                                 
link-local 169.254.0.0
ens160: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.46  netmask 255.255.255.0  broadcast 10.10.10.255
        inet6 dead:beef::250:56ff:feb9:42e6  prefixlen 64  scopeid 0x0<global>
        inet6 fe80::250:56ff:feb9:42e6  prefixlen 64  scopeid 0x20<link>
        ether 00:50:56:b9:42:e6  txqueuelen 1000  (Ethernet)
        RX packets 1242  bytes 575234 (575.2 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 933  bytes 213731 (213.7 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 7649  bytes 913782 (913.7 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 7649  bytes 913782 (913.7 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


╔══════════╣ Networks and neighbours
Kernel IP routing table                                                                                             
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         _gateway        0.0.0.0         UG    0      0        0 ens160
10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 ens160
Address                  HWtype  HWaddress           Flags Mask            Iface
_gateway                 ether   00:50:56:b9:33:9d   C                     ens160

╔══════════╣ Iptables rules
                                                                                                                    
╔══════════╣ Active Ports
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports                                            
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:5432          0.0.0.0:*               LISTEN      2215/postgres       
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::21                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   

╔══════════╣ Can I sniff with tcpdump?
No                                                                                                                  
                                                                                                                    

════════════════════════════════════╣ Users Information ╠════════════════════════════════════
╔══════════╣ My user                                                                                                
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#users                                                 
uid=111(postgres) gid=117(postgres) groups=117(postgres),116(ssl-cert)                                              

╔══════════╣ Do I have PGP keys?
/usr/bin/gpg                                                                                                        

╔══════════╣ Clipboard or highlighted text?
                                                                                                                    
╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
Matching Defaults entries for postgres on vaccine:                                                                  
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User postgres may run the following commands on vaccine:
    (ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf

╔══════════╣ Checking sudo tokens
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens                                   
/proc/sys/kernel/yama/ptrace_scope is not enabled (1)                                                               
gdb wasn't found in PATH

╔══════════╣ Checking doas.conf
                                                                                                                    
╔══════════╣ Checking Pkexec policy
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2               
                                                                                                                    
[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

╔══════════╣ Superusers
root:x:0:0:root:/root:/bin/bash                                                                                     

╔══════════╣ Users with console
ftpuser:x:1002:1002:,,,:/home/ftpuser:/bin/sh                                                                       
postgres:x:111:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
root:x:0:0:root:/root:/bin/bash
simon:x:1000:1000:simon:/home/simon:/bin/bash

╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)                                                                              
uid=1000(simon) gid=1000(simon) groups=1000(simon),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lxd)
uid=1002(ftpuser) gid=1002(ftpuser) groups=1002(ftpuser)
uid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync)
uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network)
uid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve)
uid=103(messagebus) gid=106(messagebus) groups=106(messagebus)
uid=104(syslog) gid=110(syslog) groups=110(syslog),4(adm)
uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=106(uuidd) gid=111(uuidd) groups=111(uuidd)
uid=107(tcpdump) gid=112(tcpdump) groups=112(tcpdump)
uid=108(landscape) gid=114(landscape) groups=114(landscape)
uid=109(pollinate) gid=1(daemon[0m) groups=1(daemon[0m)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=110(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=111(postgres) gid=117(postgres) groups=117(postgres),116(ssl-cert)
uid=112(ftp) gid=118(ftp) groups=118(ftp)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=5(games) gid=60(games) groups=60(games)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=6(man) gid=12(man) groups=12(man)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=998(lxd) gid=100(users) groups=100(users)
uid=999(systemd-coredump) gid=999(systemd-coredump) groups=999(systemd-coredump)
uid=9(news) gid=9(news) groups=9(news)

╔══════════╣ Login now
 23:31:15 up 36 min,  1 user,  load average: 0.46, 0.11, 0.04                                                       
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
postgres pts/0    10.10.14.29      23:22   35.00s  0.32s  0.00s bash linpeas.sh

╔══════════╣ Last logons
simon    tty1         Tue Feb  4 11:49:07 2020 - down                      (00:29)     0.0.0.0                      
reboot   system boot  Tue Feb  4 11:40:38 2020 - Tue Feb  4 12:18:32 2020  (00:37)     0.0.0.0
simon    tty1         Mon Feb  3 11:50:57 2020 - down                      (05:24)     0.0.0.0
reboot   system boot  Mon Feb  3 11:50:40 2020 - Mon Feb  3 17:15:05 2020  (05:24)     0.0.0.0
simon    pts/0        Mon Feb  3 11:35:53 2020 - Mon Feb  3 11:50:30 2020  (00:14)     192.168.0.108
simon    pts/0        Mon Feb  3 10:45:14 2020 - Mon Feb  3 11:35:38 2020  (00:50)     192.168.0.108
simon    tty1         Mon Feb  3 10:42:02 2020 - down                      (01:08)     0.0.0.0
reboot   system boot  Mon Feb  3 10:40:15 2020 - Mon Feb  3 11:50:31 2020  (01:10)     0.0.0.0

wtmp begins Mon Feb  3 10:40:15 2020

╔══════════╣ Last time logon each user
Username         Port     From             Latest                                                                   
root             tty1                      Tue Mar 30 09:17:12 +0000 2021
simon            tty1                      Tue Feb  4 13:17:57 +0000 2020
postgres         pts/0    10.10.14.29      Fri Jul  9 23:22:43 +0000 2021
ftpuser          pts/1    10.10.14.2       Thu Jul  2 09:10:23 +0000 2020

╔══════════╣ Password policy
PASS_MAX_DAYS   99999                                                                                               
PASS_MIN_DAYS   0
PASS_WARN_AGE   7
ENCRYPT_METHOD SHA512

╔══════════╣ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)                                                                                              
                                                                                                                    
╔══════════╣ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!
                                                                                                                    


════════════════════════════════════╣ Software Information ╠════════════════════════════════════
╔══════════╣ MySQL version                                                                                          
                                                                                                                    
═╣ MySQL connection using default root/root ........... No
═╣ MySQL connection using root/toor ................... No                                                          
═╣ MySQL connection using root/NOPASS ................. No                                                          
╔══════════╣ Searching mysql credentials and exec                                                                   
                                                                                                                    
╔══════════╣ Analizing PostgreSQL Files (limit 70)
Version: psql (PostgreSQL) 11.5 (Ubuntu 11.5-1)                                                                     

-rw-r----- 1 postgres postgres 4659 Jul  9 23:30 /etc/postgresql/11/main/pg_hba.conf
local   all             postgres                                ident
local   all             all                                     peer
host    all             all             127.0.0.1/32            md5
host    all             all             ::1/128                 md5
local   replication     all                                     peer
host    replication     all             127.0.0.1/32            md5
host    replication     all             ::1/128                 md5

-rw-r--r-- 1 postgres postgres 24065 Jun 29  2020 /etc/postgresql/11/main/postgresql.conf
ssl = on
ssl_cert_file = '/etc/ssl/certs/ssl-cert-snakeoil.pem'
ssl_key_file = '/etc/ssl/private/ssl-cert-snakeoil.key'
max_wal_size = 1GB
min_wal_size = 80MB
log_timezone = 'Etc/UTC'
stats_temp_directory = '/var/run/postgresql/11-main.pg_stat_tmp'
datestyle = 'iso, mdy'
timezone = 'Etc/UTC'
default_text_search_config = 'pg_catalog.english'
-rw-r--r-- 1 root root 172 Jan 24  2019 /usr/lib/tmpfiles.d/postgresql.conf
d /run/postgresql 2775 postgres postgres - -
d /var/log/postgresql 1775 root postgres - -


═╣ PostgreSQL connection to template0 using postgres/NOPASS ........ No
═╣ PostgreSQL connection to template1 using postgres/NOPASS ........ Yes                                            
═╣ PostgreSQL connection to template0 using pgsql/NOPASS ........... No
═╣ PostgreSQL connection to template1 using pgsql/NOPASS ........... No                                             
                                                                                                                    
╔══════════╣ Analizing Mongo Files (limit 70)
Version:                                                                                                            

╔══════════╣ Analizing Apache Files (limit 70)
Version: Server version: Apache/2.4.41 (Ubuntu)                                                                     
Server built:   2019-08-14T14:36:32
══╣ PHP exec extensions
/etc/apache2/mods-enabled/php7.3.conf-<FilesMatch ".+\.ph(ar|p|tml)$">                                              
/etc/apache2/mods-enabled/php7.3.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-enabled/php7.3.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-enabled/php7.3.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-available/php7.3.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-available/php7.3.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php7.3.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php7.3.conf:    SetHandler application/x-httpd-php-source
drwxr-xr-x 2 root root 4096 Feb  3  2020 /etc/apache2/sites-enabled
sed: -e expression #1, char 0: no previous regular expression
sed: -e expression #1, char 0: no previous regular expression
        # The ServerName directive sets the request scheme, hostname and port that
        # redirection URLs. In the context of virtual hosts, the ServerName
        #ServerName www.example.com


-rw-r--r-- 1 root root 0 Feb  3  2020 /var/lib/apache2/site/enabled_by_admin/000-default

╔══════════╣ Analizing Tomcat Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing FastCGI Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Http conf Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Htpasswd Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing PHPCookies Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Wordpress Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Drupal Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Moodle Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Supervisord Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Cesi Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Mar 15  2019 /usr/share/doc/rsync/examples/rsyncd.conf                                  
[ftp]
        comment = public archive
        path = /var/www/pub
        use chroot = yes
        lock file = /var/lock/rsyncd
        read only = yes
        list = yes
        uid = nobody
        gid = nogroup
        strict modes = yes
        ignore errors = no
        ignore nonreadable = yes
        transfer logging = no
        timeout = 600
        refuse options = checksum dry-run
        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz


╔══════════╣ Analizing Hostapd Files (limit 70)
                                                                                                                    
╔══════════╣ Searching wifi conns file
                                                                                                                    
╔══════════╣ Analizing Anaconda-ks Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing VNC Files (limit 70)
                                                                                                                    




╔══════════╣ Analizing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'                                                                
drwxr-xr-x 2 root root 4096 Oct 17  2019 /etc/ldap


╔══════════╣ Analizing Open VPN Files (limit 70)
                                                                                                                    
╔══════════╣ Searching ssl/ssh files
╔══════════╣ Analizing SSH FILES Files (limit 70)                                                                   
                                                                                                                    
-rw------- 1 postgres postgres 2602 Jun 12  2020 /var/lib/postgresql/.ssh/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEA0a5cdsLhNwBeZvZB5tYxL80+03AaJwcnAyEzffSXcluql1xNztZr
JkMxml3K1zs8pOxUv9WALP9BIDh1aHITP8i273Uz5PC3RBzQuP8gAkdI6UxeNuwJ7FYyTQ
jGUjyxlsGbPX3noMsKzeOa4pK5LkOy72Wh7QphvfSVPmVtmEMotFVI8Jc1gPsgVvpP0sM9
IyuyTWfMuPhvreyO4DCerRZY95ClNgkffiudHiSFc72ps/8n4JFNqT3Y8efovm/SdWr9SG
z20+gKBUk/9Of5HGAUCG7/Z1Li9FdQn3rqikfXn5D4eZBX8/kfrfDi82A/oheQKM7oZrm9
fAiZAiJTbUrwNri7GPbjmw0/uqgFAuWOXo/MooksOIsAmU9PW2rEqUrNHHO7mSUDl1N45W
TOU8Sh94oLeD+7RVQiKVVjj+jzlXmcGjgij8QgpWNtd7gorHHe3+m2TMzsL65cctaH4pnm
d38FTKBmDLLh9SU4JIQQuzTLvBv0e6xLv5WU6uflAAAFiLcLrEC3C6xAAAAAB3NzaC1yc2
EAAAGBANGuXHbC4TcAXmb2QebWMS/NPtNwGicHJwMhM330l3JbqpdcTc7WayZDMZpdytc7
PKTsVL/VgCz/QSA4dWhyEz/Itu91M+Twt0Qc0Lj/IAJHSOlMXjbsCexWMk0IxlI8sZbBmz
1956DLCs3jmuKSuS5Dsu9loe0KYb30lT5lbZhDKLRVSPCXNYD7IFb6T9LDPSMrsk1nzLj4
b63sjuAwnq0WWPeQpTYJH34rnR4khXO9qbP/J+CRTak92PHn6L5v0nVq/Uhs9tPoCgVJP/
Tn+RxgFAhu/2dS4vRXUJ966opH15+Q+HmQV/P5H63w4vNgP6IXkCjO6Ga5vXwImQIiU21K
8Da4uxj245sNP7qoBQLljl6PzKKJLDiLAJlPT1tqxKlKzRxzu5klA5dTeOVkzlPEofeKC3
g/u0VUIilVY4/o85V5nBo4Io/EIKVjbXe4KKxx3t/ptkzM7C+uXHLWh+KZ5nd/BUygZgyy
4fUlOCSEELs0y7wb9HusS7+VlOrn5QAAAAMBAAEAAAGBALnYaB3fFsywJ/vsUnbt68Spjw
DKwHNNFJfiiogeDUmP08C6UEB+rZPJRKLEdO+Vkme/DFLHQgcf6rJLOEztpwAGv5W39Nn7
PQRC4gDGJ7G9SvN0+6CETztJHuZGW7kyEFlFmnnDKVTMAfSAwpwFXdqSqHslQoMdi4pYyR
r3vU6SX/aODMspyoNakcxlqfBtmbedmDihQsPDdwDZxb0ReuKBBzPN4ZDmPyKON4Eq75mp
RkvCYK7bOtFBfxLR8Okxo+R/wjeVx30VXmUyypjZXGZyzvLjO0PihTH0RKpa7TMczD54CZ
08gjPh7CYYIhbU97GV7tFivPWn22J2c6zQ7s0LbG0p7OHAolGzqRdi5BJx1IObPkUbbDJS
9V0DK60SCPMjqWTNRyYmb2pmmePSvohZClbTmdT+u2uXafuRGjT7vQIxo988/DJe8bMyar
QX5CDLOdIFaaQ6JeNZWcIedVvqw3b4pu9X+7mkhLxAX82rG6yZxvQyHZxoIhrK9zMNtQAA
AMEA55ZweCyUhPlvJETPWoO0N6VGoeHmCGYFyyG4LM9yrRCFLCkVup9cYRUcwP722wg/rL
Ll46DwHOIeyTtPfh9MNePfxiiOmK0paDPeFtMS2xDgzfnMBTmeQOefnXOsYgIdyVGkOWbq
7v7/odGoZBiJK8LXkyP/p4rtTHVLLcUECJzfgmHQ+dn9usAeH776ieUX1+O9ncnqT/+nj3
jDj/rX/jywi0hCpre626ghx5QOo/HZeWKgjF3a4EGvzGxxTchhAAAAwQD947wDgXlPNM5j
+DZ5NYhQnb1E0xGQjdOl4jibokcXjjxZ6pXrbhy7TQCuE+RqHs55zywOTyXf+IHJ5uJ6O1
Owe+ZkLLldaQUA4xQN7fRlcZR6NXlUDTaxZIR4/6/n7trs4rAnhfm42M8I8dFgCWzDgaMB
+s1KdzNJAlOER3T9gxHzwBP9ELtad6v7rvywSf9Zwv3MlXse1tGUukauWwWyFYv2UA5z4G
wwp3pWDQsygbyBcPKj/2aXL0GmvAOjaAcAAADBANNsjZdelWNlS1E01PyGCGG+Un2PgAiS
ZhzW3CmpYvmtZ+e6LEDLwq7nPShhs9oplWiMyemUz7ukTeREvZ3OyaBR2avgcZsg1eWDsL
Esek1du7fMGy8Y/XUjMtAX8sNvne1gaVKGiFNGKjsab/vxT9eClYo9kgt+MqS9opzX7WPu
7Dj1cDAVWXOqAJO9Ks3PLh6P7eP36lg2w/4/CHkvTmdJ9yr7nLclP5QS/gWghlTl2SkoIq
r1Y3QWupZhHES9swAAABBwb3N0Z3Jlc0B2YWNjaW5lAQ==
-----END OPENSSH PRIVATE KEY-----
-rw-r--r-- 1 postgres postgres 570 Jun 12  2020 /var/lib/postgresql/.ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDRrlx2wuE3AF5m9kHm1jEvzT7TcBonBycDITN99JdyW6qXXE3O1msmQzGaXcrXOzyk7FS/1YAs/0EgOHVochM/yLbvdTPk8LdEHNC4/yACR0jpTF427AnsVjJNCMZSPLGWwZs9feegywrN45rikrkuQ7LvZaHtCmG99JU+ZW2YQyi0VUjwlzWA+yBW+k/Swz0jK7JNZ8y4+G+t7I7gMJ6tFlj3kKU2CR9+K50eJIVzvamz/yfgkU2pPdjx5+i+b9J1av1IbPbT6AoFST/05/kcYBQIbv9nUuL0V1CfeuqKR9efkPh5kFfz+R+t8OLzYD+iF5Aozuhmub18CJkCIlNtSvA2uLsY9uObDT+6qAUC5Y5ej8yiiSw4iwCZT09basSpSs0cc7uZJQOXU3jlZM5TxKH3igt4P7tFVCIpVWOP6POVeZwaOCKPxCClY213uCiscd7f6bZMzOwvrlxy1ofimeZ3fwVMoGYMsuH1JTgkhBC7NMu8G/R7rEu/lZTq5+U= postgres@vaccine



-rw-r--r-- 1 postgres postgres 570 Jun 12  2020 /var/lib/postgresql/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDRrlx2wuE3AF5m9kHm1jEvzT7TcBonBycDITN99JdyW6qXXE3O1msmQzGaXcrXOzyk7FS/1YAs/0EgOHVochM/yLbvdTPk8LdEHNC4/yACR0jpTF427AnsVjJNCMZSPLGWwZs9feegywrN45rikrkuQ7LvZaHtCmG99JU+ZW2YQyi0VUjwlzWA+yBW+k/Swz0jK7JNZ8y4+G+t7I7gMJ6tFlj3kKU2CR9+K50eJIVzvamz/yfgkU2pPdjx5+i+b9J1av1IbPbT6AoFST/05/kcYBQIbv9nUuL0V1CfeuqKR9efkPh5kFfz+R+t8OLzYD+iF5Aozuhmub18CJkCIlNtSvA2uLsY9uObDT+6qAUC5Y5ej8yiiSw4iwCZT09basSpSs0cc7uZJQOXU3jlZM5TxKH3igt4P7tFVCIpVWOP6POVeZwaOCKPxCClY213uCiscd7f6bZMzOwvrlxy1ofimeZ3fwVMoGYMsuH1JTgkhBC7NMu8G/R7rEu/lZTq5+U= postgres@vaccine

PermitRootLogin yes
ChallengeResponseAuthentication no
UsePAM yes
PasswordAuthentication yes

══╣ Possible private SSH keys were found!
/var/lib/postgresql/.ssh/id_rsa

══╣ Some certificates were found (out limited):
/etc/pki/fwupd/LVFS-CA.pem                                                                                          
/etc/pki/fwupd-metadata/LVFS-CA.pem
/etc/pollinate/entropy.ubuntu.com.pem
/snap/core/7917/etc/ssl/certs/ACCVRAIZ1.pem
/snap/core/7917/etc/ssl/certs/AC_RAIZ_FNMT-RCM.pem
/snap/core/7917/etc/ssl/certs/Actalis_Authentication_Root_CA.pem
/snap/core/7917/etc/ssl/certs/AddTrust_External_Root.pem
/snap/core/7917/etc/ssl/certs/AffirmTrust_Commercial.pem
/snap/core/7917/etc/ssl/certs/AffirmTrust_Networking.pem
/snap/core/7917/etc/ssl/certs/AffirmTrust_Premium_ECC.pem
/snap/core/7917/etc/ssl/certs/AffirmTrust_Premium.pem
/snap/core/7917/etc/ssl/certs/Amazon_Root_CA_1.pem
/snap/core/7917/etc/ssl/certs/Amazon_Root_CA_2.pem
/snap/core/7917/etc/ssl/certs/Amazon_Root_CA_3.pem
/snap/core/7917/etc/ssl/certs/Amazon_Root_CA_4.pem
/snap/core/7917/etc/ssl/certs/Atos_TrustedRoot_2011.pem
/snap/core/7917/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem
/snap/core/7917/etc/ssl/certs/Baltimore_CyberTrust_Root.pem
/snap/core/7917/etc/ssl/certs/Buypass_Class_2_Root_CA.pem
/snap/core/7917/etc/ssl/certs/Buypass_Class_3_Root_CA.pem
2241PSTORAGE_CERTSBIN

══╣ Some home ssh config file was found
/usr/share/openssh/sshd_config                                                                                      
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server

══╣ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow                                                                                                    


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

╔══════════╣ Searching unexpected auth lines in /etc/pam.d/sshd
No                                                                                                                  
                                                                                                                    
╔══════════╣ NFS exports?
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe                
                                                                                                                    
╔══════════╣ Searching kerberos conf files and tickets
╚ https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt                                 
                                                                                                                    
╔══════════╣ Analizing Knockd Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Kibana Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Elasticsearch Files (limit 70)
The version is                                                                                                      

╔══════════╣ Searching logstash files
                                                                                                                    
╔══════════╣ Searching Vault-ssh files
                                                                                                                    
╔══════════╣ Searching AD cached hashes
                                                                                                                    
╔══════════╣ Searching screen sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                   
No Sockets found in /run/screen/S-postgres.                                                                         

╔══════════╣ Searching tmux sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                   
                                                                                                                    
╔══════════╣ Analizing CouchDB Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Redis Files (limit 70)
                                                                                                                    
╔══════════╣ Searching dovecot files
                                                                                                                    
╔══════════╣ Analizing Mosquitto Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Neo4j Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Cloud credentials Files (limit 70)
                                                                                                                    









╔══════════╣ Analizing Cloud-Init Files (limit 70)
-rw-r--r-- 1 root root 3612 Oct  9  2019 /etc/cloud/cloud.cfg                                                       
     lock_passwd: True
-rw-r--r-- 1 root root 3612 Aug 29  2019 /snap/core/7917/etc/cloud/cloud.cfg
     lock_passwd: True

╔══════════╣ Analizing CloudFlare Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Erlang Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing GMV Auth Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing IPSec Files (limit 70)
                                                                                                                    

╔══════════╣ Analizing IRSSI Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Keyring Files (limit 70)
drwxr-xr-x 2 root root 121 Oct  1  2019 /snap/core/7917/usr/share/keyrings                                          
drwxr-xr-x 2 root root 4096 Oct 17  2019 /usr/share/keyrings




╔══════════╣ Analizing Filezilla Files (limit 70)
                                                                                                                    

╔══════════╣ Analizing Backup Manager Files (limit 70)
                                                                                                                    

╔══════════╣ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd                                                                                      
passwd file: /etc/passwd
passwd file: /snap/core/7917/etc/pam.d/passwd
passwd file: /snap/core/7917/etc/passwd
passwd file: /snap/core/7917/usr/share/bash-completion/completions/passwd
passwd file: /snap/core/7917/var/lib/extrausers/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

╔══════════╣ Searching GitLab related files
                                                                                                                    

╔══════════╣ Analizing Github Files (limit 70)
                                                                                                                    



╔══════════╣ Analizing Svn Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing PGP-GPG Files (limit 70)
/usr/bin/gpg                                                                                                        

-rw-r--r-- 1 root root 2796 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg
-rw-r--r-- 1 root root 2794 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg
-rw-r--r-- 1 root root 1733 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg
-rw-r--r-- 1 root root 13395 Oct  1  2019 /snap/core/7917/etc/apt/trusted.gpg
-rw-r--r-- 1 root root 12335 May 19  2012 /snap/core/7917/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 0 May 19  2012 /snap/core/7917/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 19  2012 /snap/core/7917/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 3267 Jan 30  2019 /usr/share/gnupg/distsigkey.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 2255 Jun 26  2019 /usr/share/keyrings/ubuntu-cc-keyring.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 2264 Jun 26  2019 /usr/share/keyrings/ubuntu-esm-v2-keyring.gpg
-rw-r--r-- 1 root root 2275 Jun 26  2019 /usr/share/keyrings/ubuntu-fips-keyring.gpg
-rw-r--r-- 1 root root 2275 Jun 26  2019 /usr/share/keyrings/ubuntu-fips-updates-keyring.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 0 Apr 18  2019 /usr/share/keyrings/ubuntu-securitybenchmarks-keyring.gpg
-rw-r--r-- 1 root root 2867 Sep 26  2018 /usr/share/popularity-contest/debian-popcon.gpg

drwx------ 3 ftpuser ftpuser 4096 Jul  2  2020 /home/ftpuser/.gnupg
drwx------ 3 simon simon 4096 Feb  3  2020 /home/simon/.gnupg
drwx------ 4 postgres postgres 4096 Jul  9 23:31 /var/lib/postgresql/.gnupg

╔══════════╣ Analizing Cache Vi Files (limit 70)
                                                                                                                    
-rw------- 1 simon simon 872 Feb  3  2020 /home/simon/.viminfo

╔══════════╣ Checking if containerd(ctr) is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation                   
                                                                                                                    
╔══════════╣ Checking if runc is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation                             
                                                                                                                    
╔══════════╣ Searching docker files (limit 70)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket                                
                                                                                                                    
╔══════════╣ Analizing Firefox Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Chrome Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Autologin Files (limit 70)
                                                                                                                    

╔══════════╣ S/Key authentication
                                                                                                                    
╔══════════╣ YubiKey authentication
                                                                                                                    
╔══════════╣ Passwords inside pam.d
                                                                                                                    
╔══════════╣ Analizing SNMP Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Pypirc Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Ldaprc Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Env Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Msmtprc Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Keepass Files (limit 70)
                                                                                                                    



╔══════════╣ Analizing FTP Files (limit 70)
                                                                                                                    

-rw-r--r-- 1 root root 69 Jan 14  2020 /etc/php/7.3/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Jan 14  2020 /usr/share/php7.3-common/common/ftp.ini



╔══════════╣ Analizing Bind Files (limit 70)
-rw-r--r-- 1 root root 832 Aug 16  2019 /usr/share/bash-completion/completions/bind                                 
sed: -e expression #1, char 0: no previous regular expression



╔══════════╣ Analizing SeedDMS Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Ddclient Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Interesting logs Files (limit 70)
                                                                                                                    

╔══════════╣ Analizing Windows Files Files (limit 70)
                                                                                                                    
























-rw-r--r-- 1 root root 72294 Feb  3  2020 /etc/php/7.3/apache2/php.ini
-rw-r--r-- 1 root root 71906 Jan 14  2020 /etc/php/7.3/cli/php.ini





drwxr-xr-x 4 root root 4096 Oct 17  2019 /etc/security
drwxr-xr-x 4 root root 223 Oct  1  2019 /snap/core/7917/etc/security
drwxr-xr-x 2 root root 974 Oct  1  2019 /snap/core/7917/lib/x86_64-linux-gnu/security
drwxr-xr-x 2 root root 4096 Oct 17  2019 /usr/lib/x86_64-linux-gnu/security
drwxr-xr-x 2 root root 4096 Feb  3  2020 /usr/src/linux-headers-5.3.0-29-generic/include/config/ceph/fs/security
drwxr-xr-x 2 root root 4096 Feb  3  2020 /usr/src/linux-headers-5.3.0-29-generic/include/config/default/security
drwxr-xr-x 2 root root 4096 Feb  3  2020 /usr/src/linux-headers-5.3.0-29-generic/include/config/nfsd/v4/security
drwxr-xr-x 2 root root 4096 Feb  3  2020 /usr/src/linux-headers-5.3.0-29-generic/include/config/nfs/v4/security
drwxr-xr-x 8 root root 4096 Feb  3  2020 /usr/src/linux-headers-5.3.0-29-generic/include/config/security
lrwxrwxrwx 1 root root 34 Jan 17  2020 /usr/src/linux-headers-5.3.0-29-generic/security -> ../linux-headers-5.3.0-29/security
drwxr-xr-x 11 root root 4096 Feb  3  2020 /usr/src/linux-headers-5.3.0-29/security
drwxr-xr-x 2 root root 4096 Feb  3  2020 /usr/src/linux-headers-5.3.0-29/tools/testing/selftests/powerpc/security
-rw-r--r-- 1 root root 0 Feb  3  2020 /var/lib/apache2/conf/enabled_by_maint/security




















╔══════════╣ Analizing Other Interesting Files Files (limit 70)
-rw-r--r-- 1 root root 3771 May  5  2019 /etc/skel/.bashrc                                                          
-rw-r--r-- 1 ftpuser ftpuser 3771 Feb  3  2020 /home/ftpuser/.bashrc
-rw-r--r-- 1 simon simon 3771 May  5  2019 /home/simon/.bashrc
-rw-r--r-- 1 root root 3771 Aug 31  2015 /snap/core/7917/etc/skel/.bashrc





-rw-r--r-- 1 root root 807 May  5  2019 /etc/skel/.profile
-rw-r--r-- 1 ftpuser ftpuser 807 Feb  3  2020 /home/ftpuser/.profile
-rw-r--r-- 1 simon simon 807 May  5  2019 /home/simon/.profile
-rw-r--r-- 1 root root 655 Jul 12  2019 /snap/core/7917/etc/skel/.profile



-rw-r--r-- 1 simon simon 0 Feb  3  2020 /home/simon/.sudo_as_admin_successful


════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════
╔══════════╣ SUID - Check easy privesc, exploits and write perms                                                    
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
-rwsr-xr-x 1 root   root             44K May  7  2014 /snap/core/7917/bin/ping6                                     
-rwsr-xr-x 1 root   root             44K May  7  2014 /snap/core/7917/bin/ping
-rwsr-xr-- 1 root   dip             386K Jun 12  2018 /snap/core/7917/usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)                                                                                                                
-rwsr-sr-x 1 daemon daemon           55K Nov 12  2018 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)
-rwsr-xr-x 1 root   root            419K Mar  4  2019 /snap/core/7917/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root             35K Mar  5  2019 /usr/bin/fusermount
-rwsr-xr-x 1 root   root             53K Mar 25  2019 /snap/core/7917/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                     
-rwsr-xr-x 1 root   root             74K Mar 25  2019 /snap/core/7917/usr/bin/gpasswd
-rwsr-xr-x 1 root   root             40K Mar 25  2019 /snap/core/7917/usr/bin/chsh
-rwsr-xr-x 1 root   root             71K Mar 25  2019 /snap/core/7917/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root   root             39K Mar 25  2019 /snap/core/7917/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root   root             40K Mar 25  2019 /snap/core/7917/bin/su
-rwsr-xr-- 1 root   systemd-network  42K Jun 10  2019 /snap/core/7917/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root   root            134K Jun 10  2019 /snap/core/7917/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable                                                                                                       
-rwsr-xr-- 1 root   messagebus       50K Jun 11  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root   root             15K Jul  8  2019 /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-x 1 root   root             23K Aug 16  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root   root             31K Aug 16  2019 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)                                                                                                  
-rwsr-xr-x 1 root   root             39K Aug 21  2019 /usr/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root   root             67K Aug 21  2019 /usr/bin/su
-rwsr-xr-x 1 root   root             55K Aug 21  2019 /usr/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                               
-rwsr-xr-x 1 root   root             27K Aug 23  2019 /snap/core/7917/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root   root             40K Aug 23  2019 /snap/core/7917/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                    
-rwsr-xr-x 1 root   root             67K Aug 29  2019 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                                    
-rwsr-xr-x 1 root   root             44K Aug 29  2019 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root   root             87K Aug 29  2019 /usr/bin/gpasswd
-rwsr-xr-x 1 root   root             48K Aug 29  2019 /usr/bin/chsh
-rwsr-xr-x 1 root   root             83K Aug 29  2019 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-sr-x 1 root   root            115K Aug 30  2019 /usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                                                         
-rwsr-xr-x 1 root   root            443K Sep 12  2019 /usr/lib/openssh/ssh-keysign
-rwsr-sr-x 1 root   root            105K Oct  1  2019 /snap/core/7917/usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                                          
-rwsr-xr-x 1 root   root            158K Oct 15  2019 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable

╔══════════╣ SGID
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
linpeas.sh: line 2383: 6: command not found                                                                         
-rwxr-sr-x 3 root   mail              15K Dec  3  2012 /snap/core/7917/usr/bin/mail-unlock
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 3 root   mail              15K Dec  3  2012 /snap/core/7917/usr/bin/mail-touchlock
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 3 root   mail              15K Dec  3  2012 /snap/core/7917/usr/bin/mail-lock
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   mail              15K Dec  7  2013 /snap/core/7917/usr/bin/dotlockfile
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   utmp              10K Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   systemd-timesync  36K Apr  5  2016 /snap/core/7917/usr/bin/crontab
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            35K Apr  9  2018 /snap/core/7917/sbin/unix_chkpwd
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            35K Apr  9  2018 /snap/core/7917/sbin/pam_extrausers_chkpwd
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   tty               14K May  3  2018 /usr/bin/bsd-write
linpeas.sh: line 2383: 6: command not found
-rwsr-sr-x 1 daemon daemon            55K Nov 12  2018 /usr/bin/at
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            38K Feb 14  2019 /usr/sbin/unix_chkpwd
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            42K Feb 14  2019 /usr/sbin/pam_extrausers_chkpwd
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   crontab          351K Mar  4  2019 /snap/core/7917/usr/bin/ssh-agent
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            23K Mar 25  2019 /snap/core/7917/usr/bin/expiry
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            61K Mar 25  2019 /snap/core/7917/usr/bin/chage
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   crontab           47K Jul 19  2019 /usr/bin/crontab
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   tty               35K Aug 21  2019 /usr/bin/wall
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   tty               27K Aug 23  2019 /snap/core/7917/usr/bin/wall
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            31K Aug 29  2019 /usr/bin/expiry
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   shadow            75K Aug 29  2019 /usr/bin/chage
linpeas.sh: line 2383: 6: command not found
-rwsr-sr-x 1 root   root             115K Aug 30  2019 /usr/lib/snapd/snap-confine
linpeas.sh: line 2383: 6: command not found
-rwxr-sr-x 1 root   ssh              319K Sep 12  2019 /usr/bin/ssh-agent
linpeas.sh: line 2383: 6: command not found
-rwsr-sr-x 1 root   root             105K Oct  1  2019 /snap/core/7917/usr/lib/snapd/snap-confine

╔══════════╣ Checking misconfigurations of ld.so
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so                                                 
/etc/ld.so.conf                                                                                                     
include /etc/ld.so.conf.d/*.conf

/etc/ld.so.conf.d
  /etc/ld.so.conf.d/libc.conf
/usr/local/lib
  /etc/ld.so.conf.d/x86_64-linux-gnu.conf
/usr/local/lib/x86_64-linux-gnu
/lib/x86_64-linux-gnu
/usr/lib/x86_64-linux-gnu

╔══════════╣ Capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                          
Current capabilities:                                                                                               
Current: =
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Shell capabilities:
0x0000000000000000=
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Files with capabilities (limited to 50):
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/traceroute6.iputils = cap_net_raw+ep
/usr/bin/ping = cap_net_raw+ep

╔══════════╣ Users with capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                          
                                                                                                                    
╔══════════╣ Files with ACLs (limited to 50)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls                                                  
                                                                                                                    
╔══════════╣ .sh files in path
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path                               
/usr/bin/rescan-scsi-bus.sh                                                                                         
/usr/bin/gettext.sh

╔══════════╣ Unexpected in root
/swap.img                                                                                                           
/initrd.img
/initrd.img.old
/vmlinuz
/vmlinuz.old

╔══════════╣ Files (scripts) in /etc/profile.d/
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files                                        
total 44                                                                                                            
drwxr-xr-x  2 root root 4096 Oct 17  2019 .
drwxr-xr-x 97 root root 4096 Jul  2  2020 ..
-rw-r--r--  1 root root   96 Aug 27  2019 01-locale-fix.sh
-rw-r--r--  1 root root  825 Aug 30  2019 apps-bin-path.sh
-rw-r--r--  1 root root  672 Aug 16  2019 bash_completion.sh
-rw-r--r--  1 root root 1003 Aug 13  2019 cedilla-portuguese.sh
-rw-r--r--  1 root root 1107 Sep  5  2019 gawk.csh
-rw-r--r--  1 root root  757 Sep  5  2019 gawk.sh
-rw-r--r--  1 root root 1557 Jun 12  2019 Z97-byobu.sh
-rwxr-xr-x  1 root root  873 Oct  9  2019 Z99-cloudinit-warnings.sh
-rwxr-xr-x  1 root root 3417 Oct  9  2019 Z99-cloud-locale-test.sh

╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d                          
                                                                                                                    
═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ No                                                                        
═╣ Credentials in fstab/mtab? ........... No                                                                        
═╣ Can I read shadow files? ............. No                                                                        
═╣ Can I read opasswd file? ............. No                                                                        
═╣ Can I write in network-scripts? ...... No                                                                        
═╣ Can I read root folder? .............. No                                                                        
                                                                                                                    
╔══════════╣ Searching root files in home dirs (limit 30)
/home/                                                                                                              
/home/ftpuser/ftp/backup.zip
/home/simon/.bash_history
/root/
/var/lib/postgresql/.bash_history
/var/lib/postgresql/.psql_history

╔══════════╣ Searching folders owned by me containing others files on it (limit 100)
/sys/fs/cgroup/systemd/user.slice/user-111.slice/user@111.service                                                   
/sys/fs/cgroup/unified/user.slice/user-111.slice/user@111.service

╔══════════╣ Readable files belonging to root and readable by me but not world readable
                                                                                                                    
╔══════════╣ Modified interesting files in the last 5mins (limit 100)
/etc/postgresql/11/main/pg_hba.conf                                                                                 
/var/log/postgresql/postgresql-11-main.log
/var/log/journal/2827e08210f84695aaf4363a6377df78/system.journal
/var/log/auth.log
/var/log/kern.log
/var/log/syslog

╔══════════╣ Writable log files (logrotten) (limit 100)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation                                
logrotate 3.14.0                                                                                                    

    Default mail command:       /usr/bin/mail
    Default compress command:   /bin/gzip
    Default uncompress command: /bin/gunzip
    Default compress extension: .gz
    Default state file path:    /var/lib/logrotate/status
    ACL support:                yes
    SELinux support:            yes
Writable: /var/log/postgresql/postgresql-11-main.log.1
Writable: /var/log/postgresql/postgresql-11-main.log.4.gz                                                           
Writable: /var/log/postgresql/postgresql-11-main.log                                                                
                                                                                                                    
╔══════════╣ Files inside /var/lib/postgresql (limit 20)
total 484                                                                                                           
drwxr-xr-x  8 postgres postgres   4096 Jul  9 23:30 .
drwxr-xr-x 40 root     root       4096 Feb  3  2020 ..
drwxr-xr-x  3 postgres postgres   4096 Feb  3  2020 11
lrwxrwxrwx  1 root     root          9 Feb  4  2020 .bash_history -> /dev/null
drwx------  2 postgres postgres   4096 Jul  9 23:22 .cache
drwx------  4 postgres postgres   4096 Jul  9 23:31 .gnupg
-rw-rw-r--  1 postgres postgres 462687 Jul  9 23:17 linpeas.sh
drwxrwxr-x  3 postgres postgres   4096 Feb  3  2020 .local
lrwxrwxrwx  1 root     root          9 Feb  4  2020 .psql_history -> /dev/null
drwxr-xr-x  3 postgres postgres   4096 Jul  9 23:30 snap
drwx------  2 postgres postgres   4096 Jun 12  2020 .ssh

╔══════════╣ Files inside others home (limit 20)
/home/ftpuser/.profile                                                                                              
/home/ftpuser/.bashrc
/home/ftpuser/ftp/backup.zip
/home/ftpuser/.bash_logout
/home/simon/.profile
/home/simon/.viminfo
/home/simon/.bashrc
/home/simon/.bash_logout
/home/simon/.sudo_as_admin_successful

╔══════════╣ Searching installed mail applications
                                                                                                                    
╔══════════╣ Mails (limit 50)
                                                                                                                    
╔══════════╣ Backup folders
                                                                                                                    
╔══════════╣ Backup files (limited 100)
-rw-r--r-- 1 root root 2721 Oct 17  2019 /etc/apt/sources.list.curtin.old                                           
-rw-r--r-- 1 root root 5850 Feb  3  2020 /etc/vsftpd.conf.bak
-rw-r--r-- 1 root root 18286 Feb  3  2020 /var/lib/snapd/apparmor/profiles/snap.postgresql10.pgbasebackup
-rw-r--r-- 1 root root 6600 Feb  3  2020 /var/lib/snapd/seccomp/bpf/snap.postgresql10.pgbasebackup.bin
-rw-r--r-- 1 root root 9217 Feb  3  2020 /var/lib/snapd/seccomp/bpf/snap.postgresql10.pgbasebackup.src
-rw-r--r-- 1 root root 2533 Feb  3  2020 /home/ftpuser/ftp/backup.zip
-rw-r--r-- 1 root root 0 Jan 17  2020 /usr/src/linux-headers-5.3.0-29-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Jan 17  2020 /usr/src/linux-headers-5.3.0-29-generic/include/config/net/team/mode/activebackup.h                                                                                                               
-rw-r--r-- 1 root root 235815 Jan 17  2020 /usr/src/linux-headers-5.3.0-29-generic/.config.old
-rwxr-xr-x 1 root root 1086 Sep 15  2019 /usr/src/linux-headers-5.3.0-29/tools/testing/selftests/net/tcp_fastopen_backup_key.sh                                                                                                         
-rw-r--r-- 1 root root 2754 Sep  6  2019 /usr/share/man/man8/vgcfgbackup.8.gz
-rw-r--r-- 1 root root 6717 Aug  7  2019 /usr/share/postgresql/11/man/man1/pg_basebackup.1.gz
-rw-r--r-- 1 root root 10940 Feb  3  2020 /usr/share/info/dir.old
-rw-r--r-- 1 root root 384509 Aug  2  2019 /usr/share/doc/manpages/Changes.old.gz
-rw-r--r-- 1 root root 7867 Jul 16  1996 /usr/share/doc/telnet/README.old.gz
-rwxr-xr-x 1 root root 226 Jun 12  2019 /usr/share/byobu/desktop/byobu.desktop.old
-rw-r--r-- 1 root root 41564 Aug  7  2019 /usr/lib/postgresql/11/lib/bitcode/postgres/replication/basebackup.bc
-rwxr-xr-x 1 root root 126168 Aug  7  2019 /usr/lib/postgresql/11/bin/pg_basebackup
-rw-r--r-- 1 root root 43888 Oct  9  2019 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so
-rw-r--r-- 1 root root 8233 Jan 17  2020 /usr/lib/modules/5.3.0-29-generic/kernel/drivers/net/team/team_mode_activebackup.ko                                                                                                            
-rw-r--r-- 1 root root 8745 Jan 17  2020 /usr/lib/modules/5.3.0-29-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rwxr-xr-x 1 root root 339 May 11  2018 /snap/postgresql10/47/command-pgbasebackup.wrapper
-rwxr-xr-x 1 root root 232856 May 11  2018 /snap/postgresql10/47/usr/bin/pg_basebackup
-rw-r--r-- 1 root root 837 May 11  2018 /snap/postgresql10/47/usr/include/postgresql/server/replication/basebackup.h
-rw-r--r-- 1 root root 31634 May 11  2018 /snap/postgresql10/47/usr/share/doc/postgresql/html/app-pgbasebackup.html
-rw-r--r-- 1 root root 18440 May 11  2018 /snap/postgresql10/47/usr/share/doc/postgresql/html/backup-dump.html
-rw-r--r-- 1 root root 8268 May 11  2018 /snap/postgresql10/47/usr/share/doc/postgresql/html/backup-file.html
-rw-r--r-- 1 root root 4822 May 11  2018 /snap/postgresql10/47/usr/share/doc/postgresql/html/backup.html
-rw-r--r-- 1 root root 33195 May 11  2018 /snap/postgresql10/47/usr/share/locale/de/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 33485 May 11  2018 /snap/postgresql10/47/usr/share/locale/es/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 35633 May 11  2018 /snap/postgresql10/47/usr/share/locale/fr/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 36209 May 11  2018 /snap/postgresql10/47/usr/share/locale/he/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 33530 May 11  2018 /snap/postgresql10/47/usr/share/locale/it/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 37834 May 11  2018 /snap/postgresql10/47/usr/share/locale/ja/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 33581 May 11  2018 /snap/postgresql10/47/usr/share/locale/ko/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 32495 May 11  2018 /snap/postgresql10/47/usr/share/locale/pl/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 42513 May 11  2018 /snap/postgresql10/47/usr/share/locale/ru/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 31997 May 11  2018 /snap/postgresql10/47/usr/share/locale/sv/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 31142 May 11  2018 /snap/postgresql10/47/usr/share/locale/tr/LC_MESSAGES/pg_basebackup-10.mo
-rw-r--r-- 1 root root 19735 May 11  2018 /snap/postgresql10/47/usr/share/man/man1/pg_basebackup.1

╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found: /snap/core/7917/lib/firmware/regulatory.db: CRDA wireless regulatory database file                           
Found: /var/lib/command-not-found/commands.db: SQLite 3.x database, last written using SQLite version 3029000
Found: /var/lib/PackageKit/transactions.db: SQLite 3.x database, last written using SQLite version 3029000
 -> Extracting tables from /var/lib/command-not-found/commands.db (limit 20)
                                                                                                                    
 -> Extracting tables from /var/lib/PackageKit/transactions.db (limit 20)
                                                                                                                    

╔══════════╣ Web files?(output limit)
/var/www/:                                                                                                          
total 12K
drwxr-xr-x  3 root root 4.0K Feb  3  2020 .
drwxr-xr-x 14 root root 4.0K Feb  3  2020 ..
drwxr-xr-x  2 root root 4.0K Feb  4  2020 html

/var/www/html:
total 392K
drwxr-xr-x 2 root root 4.0K Feb  4  2020 .
drwxr-xr-x 3 root root 4.0K Feb  3  2020 ..

╔══════════╣ All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw------- 1 root root 0 Oct 17  2019 /etc/.pwd.lock                                                                
-rw-r--r-- 1 root root 220 May  5  2019 /etc/skel/.bash_logout
-rw-r--r-- 1 landscape landscape 0 Oct 17  2019 /var/lib/landscape/.cleanup.user
-rw-r--r-- 1 ftpuser ftpuser 220 Feb  3  2020 /home/ftpuser/.bash_logout
-rw-r--r-- 1 simon simon 220 May  5  2019 /home/simon/.bash_logout
-rw------- 1 root root 0 Oct  1  2019 /snap/core/7917/etc/.pwd.lock
-rw-r--r-- 1 root root 220 Aug 31  2015 /snap/core/7917/etc/skel/.bash_logout
-rw------- 1 root root 0 Jul  9 22:55 /run/snapd/lock/.lock
-rw------- 1 postgres postgres 69 Jul  9 23:30 /run/postgresql/.s.PGSQL.5432.lock
-rw-r--r-- 1 root root 37 Jul  9 22:55 /run/cloud-init/.instance-id
-rw-r--r-- 1 root root 2 Jul  9 22:54 /run/cloud-init/.ds-identify.result
-rw-r--r-- 1 root root 0 Jul  9 22:54 /run/network/.ifstate.lock

╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)                                                                                                   
-rw-r--r-- 1 root root 32000 Feb  3  2020 /var/backups/apt.extended_states.0                                        

╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                        
/dev/mqueue                                                                                                         
/dev/shm
/dev/shm/PostgreSQL.979073273
/etc/postgresql
/etc/postgresql/11
/etc/postgresql/11/main
/etc/postgresql/11/main/conf.d
/etc/postgresql/11/main/environment
/etc/postgresql/11/main/pg_ctl.conf
/etc/postgresql/11/main/pg_hba.conf
/etc/postgresql/11/main/pg_ident.conf
#)You_can_write_even_more_files_inside_last_directory

/run/lock
/run/postgresql
/run/postgresql/11-main.pg_stat_tmp
/run/postgresql/11-main.pg_stat_tmp/db_0.stat
/run/postgresql/11-main.pg_stat_tmp/db_13100.stat
/run/postgresql/11-main.pg_stat_tmp/db_13101.stat
/run/postgresql/11-main.pg_stat_tmp/db_16384.stat
/run/postgresql/11-main.pg_stat_tmp/db_1.stat
#)You_can_write_even_more_files_inside_last_directory

/run/postgresql/11-main.pid
/run/postgresql/.s.PGSQL.5432.lock
/run/screen
/run/screen/S-postgres
/run/user/111
/run/user/111/dbus-1
/run/user/111/dbus-1/services
/run/user/111/gnupg
/run/user/111/systemd
/snap/core/7917/run/lock
/snap/core/7917/tmp
/snap/core/7917/var/tmp
/tmp
/tmp/.font-unix
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/tmux-111
/tmp/.X11-unix
#)You_can_write_even_more_files_inside_last_directory

/var/crash
/var/lib/php/sessions
/var/lib/postgresql
/var/log/postgresql/postgresql-11-main.log
/var/log/postgresql/postgresql-11-main.log.1
/var/log/postgresql/postgresql-11-main.log.2.gz
/var/log/postgresql/postgresql-11-main.log.3.gz
/var/log/postgresql/postgresql-11-main.log.4.gz
#)You_can_write_even_more_files_inside_last_directory

/var/tmp

╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                        
  Group postgres:                                                                                                   
/var/log/postgresql                                                                                                 
/run/postgresql
  Group ssl-cert:
                                                                                                                    

╔══════════╣ Searching passwords in config PHP files
                                                                                                                    
╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs
                                                                                                                    
╔══════════╣ Finding IPs inside logs (limit 70)
     71 0.19.10.2                                                                                                   
     18 1.19.10.1
     17 10.10.14.29
     12 4.8.6.3
     12 0.5.10.2
     12 0.19.10.3
     12 018.09.18.1
      9 0.19.10.1
      8 10.10.10.46
      8 10.10.10.2
      7 0.19.8.1
      4 10.10.14.2
      2 19.12.1.5
      2 0.99.7.1
      1 91.189.89.198
      1 255.255.255.255
      1 127.255.255.255

╔══════════╣ Finding passwords inside logs (limit 70)
2019-10-17 13:08:22 configure base-passwd:amd64 3.5.46 3.5.46                                                       
2019-10-17 13:08:22 install base-passwd:amd64 <none> 3.5.46
2019-10-17 13:08:22 status half-configured base-passwd:amd64 3.5.46
2019-10-17 13:08:22 status half-installed base-passwd:amd64 3.5.46
2019-10-17 13:08:22 status installed base-passwd:amd64 3.5.46
2019-10-17 13:08:22 status unpacked base-passwd:amd64 3.5.46
2019-10-17 13:08:24 status half-configured base-passwd:amd64 3.5.46
2019-10-17 13:08:24 status half-installed base-passwd:amd64 3.5.46
2019-10-17 13:08:24 status unpacked base-passwd:amd64 3.5.46
2019-10-17 13:08:24 upgrade base-passwd:amd64 3.5.46 3.5.46
2019-10-17 13:08:26 install passwd:amd64 <none> 1:4.5-1.1ubuntu4
2019-10-17 13:08:26 status half-installed passwd:amd64 1:4.5-1.1ubuntu4
2019-10-17 13:08:26 status unpacked passwd:amd64 1:4.5-1.1ubuntu4
2019-10-17 13:08:27 configure base-passwd:amd64 3.5.46 <none>
2019-10-17 13:08:27 status half-configured base-passwd:amd64 3.5.46
2019-10-17 13:08:27 status installed base-passwd:amd64 3.5.46
2019-10-17 13:08:27 status unpacked base-passwd:amd64 3.5.46
2019-10-17 13:08:28 configure passwd:amd64 1:4.5-1.1ubuntu4 <none>
2019-10-17 13:08:28 status half-configured passwd:amd64 1:4.5-1.1ubuntu4
2019-10-17 13:08:28 status installed passwd:amd64 1:4.5-1.1ubuntu4
2019-10-17 13:08:28 status unpacked passwd:amd64 1:4.5-1.1ubuntu4
2020-02-03 10:41:20,450 - ssh_util.py[DEBUG]: line 122: option PasswordAuthentication added with yes
2020-02-03 10:41:20,479 - cc_set_passwords.py[DEBUG]: Restarted the ssh daemon.
2020-02-03 10:41:20,479 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords ran successfully
2020-02-03 11:50:46,767 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-02-03 11:50:46,767 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-02-04 11:40:54,061 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-02-04 11:40:54,061 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-02-04 12:18:46,059 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-02-04 12:18:46,059 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-02-04 13:17:11,479 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-02-04 13:17:11,479 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-02-25 13:42:31,267 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-02-25 13:42:31,267 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-12 07:27:36,531 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-12 07:27:36,531 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-29 08:54:39,378 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-29 08:54:39,378 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-29 09:55:28,451 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-29 09:55:28,451 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-06-29 10:18:53,507 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-06-29 10:18:53,507 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-07-02 09:07:28,516 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-07-02 09:07:28,516 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-07-03 05:04:15,240 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-07-03 05:04:15,240 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2021-03-30 09:16:51,994 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2021-03-30 09:16:51,994 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2021-07-09 22:55:10,612 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2021-07-09 22:55:10,612 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
[    6.605182] systemd[1]: Started Forward Password Requests to Wall Directory Watch.
 base-passwd depends on libc6 (>= 2.8); however:
 base-passwd depends on libdebconfclient0 (>= 0.145); however:
dpkg: base-passwd: dependency problems, but configuring anyway as you requested:
Feb 03 10:36:32 ubuntu-server chage[15450]: changed password expiry for sshd
Feb 03 10:36:32 ubuntu-server usermod[15445]: change user 'sshd' password
Feb 03 16:02:41 ubuntu-server systemd[1]: Started Forward Password Requests to Wall Directory Watch.
Preparing to unpack .../base-passwd_3.5.46_amd64.deb ...
Preparing to unpack .../passwd_1%3a4.5-1.1ubuntu4_amd64.deb ...
Selecting previously unselected package base-passwd.
Selecting previously unselected package passwd.
Setting up base-passwd (3.5.46) ...
Setting up passwd (1:4.5-1.1ubuntu4) ...
Shadow passwords are now on.
Unpacking base-passwd (3.5.46) ...
Unpacking base-passwd (3.5.46) over (3.5.46) ...
Unpacking passwd (1:4.5-1.1ubuntu4) ...

╔══════════╣ Finding emails inside logs (limit 70)
      4 ftpmaster@ubuntu.com                                                                                        
      3 giometti@linux.it
      3 dm-devel@redhat.com
      1 snaps@canonical.com

╔══════════╣ Finding *password* or *credential* files in home (limit 70)
/etc/pam.d/common-password                                                                                          
/snap/core/7917/bin/systemd-ask-password
/snap/core/7917/bin/systemd-tty-ask-password-agent
/snap/core/7917/etc/pam.d/common-password
/snap/core/7917/lib/systemd/systemd-reply-password
/snap/core/7917/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path
/snap/core/7917/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path
/snap/core/7917/lib/systemd/system/systemd-ask-password-console.path
/snap/core/7917/lib/systemd/system/systemd-ask-password-console.service
/snap/core/7917/lib/systemd/system/systemd-ask-password-wall.path
/snap/core/7917/lib/systemd/system/systemd-ask-password-wall.service
  #)There are more creds/passwds files in the previous parent folder

/snap/core/7917/usr/lib/pppd/2.4.7/passwordfd.so
/snap/core/7917/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/snap/core/7917/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-35.pyc
/snap/core/7917/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/snap/core/7917/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-35.pyc
/snap/core/7917/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-35.pyc                                                                                        
/snap/core/7917/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/snap/core/7917/usr/share/pam/common-password
/snap/core/7917/usr/share/pam/common-password.md5sums
/snap/core/7917/var/cache/debconf/passwords.dat
/snap/core/7917/var/lib/pam/password
/snap/postgresql10/47/usr/lib/postgresql/passwordcheck.so
/snap/postgresql10/47/usr/share/doc/postgresql/html/passwordcheck.html
/usr/bin/systemd-ask-password
/usr/bin/systemd-tty-ask-password-agent
/usr/lib/git-core/git-credential
/usr/lib/git-core/git-credential-cache
/usr/lib/git-core/git-credential-cache--daemon
/usr/lib/git-core/git-credential-store
  #)There are more creds/passwds files in the previous parent folder

/usr/lib/grub/i386-pc/password.mod
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/postgresql/11/lib/bitcode/passwordcheck
/usr/lib/postgresql/11/lib/bitcode/passwordcheck.index.bc
/usr/lib/postgresql/11/lib/bitcode/passwordcheck/passwordcheck.bc
/usr/lib/postgresql/11/lib/passwordcheck.so
/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-37.pyc
/usr/lib/python3/dist-packages/keyring/credentials.py
/usr/lib/python3/dist-packages/keyring/__pycache__/credentials.cpython-37.pyc
/usr/lib/python3/dist-packages/launchpadlib/credentials.py
/usr/lib/python3/dist-packages/launchpadlib/__pycache__/credentials.cpython-37.pyc
/usr/lib/python3/dist-packages/launchpadlib/tests/__pycache__/test_credential_store.cpython-37.pyc
/usr/lib/python3/dist-packages/launchpadlib/tests/test_credential_store.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-37.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-37.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/usr/lib/python3/dist-packages/twisted/cred/credentials.py
/usr/lib/python3/dist-packages/twisted/cred/__pycache__/credentials.cpython-37.pyc
/usr/lib/systemd/systemd-reply-password
/usr/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path
/usr/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path
/usr/lib/systemd/system/systemd-ask-password-console.path
/usr/lib/systemd/system/systemd-ask-password-console.service
/usr/lib/systemd/system/systemd-ask-password-plymouth.path
/usr/lib/systemd/system/systemd-ask-password-plymouth.service
  #)There are more creds/passwds files in the previous parent folder

/usr/share/doc/git/contrib/credential/gnome-keyring/git-credential-gnome-keyring.c
/usr/share/doc/git/contrib/credential/libsecret/git-credential-libsecret.c
/usr/share/doc/git/contrib/credential/netrc/git-credential-netrc
/usr/share/doc/git/contrib/credential/netrc/t-git-credential-netrc.sh
/usr/share/doc/git/contrib/credential/osxkeychain/git-credential-osxkeychain.c
/usr/share/doc/git/contrib/credential/wincred/git-credential-wincred.c
/usr/share/man/man1/git-credential.1.gz

╔══════════╣ Finding passwords inside key folders (limit 70) - only PHP files
/var/www/html/dashboard.php:      $conn = pg_connect("host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!");
/var/www/html/index.php:    if($_POST['username'] === 'admin' && md5($_POST['password']) === "2cb42f8734ea607eefed3b70af13bbd3") {
/var/www/html/index.php:        <input id="login__password" type="password" name="password" class="form__input" placeholder="Password" required>

╔══════════╣ Finding passwords inside key folders (limit 70) - no PHP files
/etc/apache2/sites-available/default-ssl.conf:          #        file needs this password: `xxj31ZMTZzkVA'.         
/etc/cloud/cloud.cfg:     lock_passwd: True
/etc/cloud/cloud.cfg:     sudo: ["ALL=(ALL) NOPASSWD:ALL"]
/etc/debconf.conf:#BindPasswd: secret
/etc/nsswitch.conf:passwd:         files systemd
/etc/overlayroot.conf:#      $ MAPNAME="secure"; DEV="/dev/vdg"; PASSWORD="foobar"
/etc/overlayroot.conf:#     crypt:dev=/dev/vdb,pass=somepassword,mkfs=0
/etc/pam.d/common-password:password     [success=1 default=ignore]      pam_unix.so obscure sha512
/etc/postgresql/11/main/postgresql.conf:#password_encryption = md5              # md5 or scram-sha-256
/etc/security/namespace.init:                gid=$(echo "$passwd" | cut -f4 -d":")
/etc/security/namespace.init:        homedir=$(echo "$passwd" | cut -f6 -d":")
/etc/security/namespace.init:        passwd=$(getent passwd "$user")
/etc/ssl/openssl.cnf:challengePassword          = A challenge password
/etc/ssl/openssl.cnf:challengePassword_max              = 20
/etc/ssl/openssl.cnf:challengePassword_min              = 4
/etc/ssl/openssl.cnf:# input_password = secret
/etc/ssl/openssl.cnf:# output_password = secret
/etc/vmware-tools/vm-support:         sed 's/password[[:space:]]\+\(.*\)[[:space:]]\+\(.*\)$/password \1 xxxxxx/g' > \
/var/www/html/style.css:.login input[type='password']:focus,
/var/www/html/style.css:.login input[type='password']:hover,

╔══════════╣ Finding possible password variables inside key folders (limit 140)
/etc/postgresql/11/main/postgresql.conf:cluster_name = '11/main'                        # added to process titles if nonempty
/etc/postgresql/11/main/postgresql.conf:#db_user_namespace = off
/etc/postgresql-common/createcluster.conf:cluster_name = '%v/%c'

╔══════════╣ Finding possible password in config files
 /etc/apache2/apache2.conf                                                                                          
passwd files from being
 /etc/adduser.conf
passwd
 /etc/sysctl.d/10-ptrace.conf
credentials that exist in memory (re-using existing SSH connections,
 /etc/overlayroot.conf
password is randomly generated
password will be stored for recovery in
passwd
password,mkfs=0
PASSWORD="foobar"
PASSWORD" |
PASSWORD" |
PASSWORD HERE IN THIS CLEARTEXT CONFIGURATION
passwords are more secure, but you won't be able to
passwords are generated by calculating the sha512sum
 /etc/debconf.conf
passwords.
password
passwords.
passwords
password
passwords.dat
passwords and one for everything else.
passwords
password is really
Passwd: secret
 /etc/nsswitch.conf
passwd:         files systemd

╔══════════╣ Finding 'username' string inside key folders (limit 70)
/var/www/html/index.php:    if($_POST['username'] === 'admin' && md5($_POST['password']) === "2cb42f8734ea607eefed3b70af13bbd3") {
/var/www/html/index.php:        <input id="login__username" type="text" name="username" class="form__input" placeholder="Username" required>

╔══════════╣ Searching specific hashes inside files - less false positives (limit 70)
